<!doctype html>
<html lang="en">
    <head>
        <title>Grammars</title>
        <meta charset="UTF-8" />
        <style>
        kbd { font-family: "Droid Sans Mono", "Luxi Mono", "Inconsolata", monospace }
        samp { font-family: "Terminus", "Courier", "Lucida Console", monospace }
        u { text-decoration: none }
        .nested {
            margin-left: 3em;
        }
        aside, u { opacity: 0.7 }
        a[id^="fn-"]:target { background: #ff0 }
        </style>
        
        
        <meta name=viewport content="width=device-width, initial-scale=1">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/css/app.css?v=7" media="screen" title="default" />
<noscript> <style> #search { visibility: hidden; } </style> </noscript>

    </head>
    <body class="pod">
    <div id="___top"></div>
    <div id="header" class="pretty-box green">
  <a href="/"
    ><img
      src="/images/Camelia.svg"
      alt="»ö«"
      id="logo"
      width="62"
      height="48"
    />&nbsp;Perl 6 Documentation</a
  >
  <div id="search" class="ui-widget">
    <div class="green">
      <input
        placeholder="Loading..."
        id="query"
        accesskey="f"
        title="Enter term to search for (hit Esc to focus)"
      />
    </div>
    <p id="not-found-message">
      Not in Index (<a href="" id="try-web-search">try site search</a>)
    </p>
  </div>
  <div class="menu">
    <div class="menu-items dark-green"><a class='menu-item darker-green' href='https://perl6.org'><strong>Perl&nbsp;6 homepage</strong></a>  <a class="menu-item selected darker-green" href="/language.html"> Language </a> <a class="menu-item " href="/type.html"> Types </a> <a class="menu-item " href="/routine.html"> Routines </a> <a class="menu-item " href="/programs.html"> Programs </a> <a class="menu-item " href="https://webchat.freenode.net/?channels=#perl6"> Chat with us </a></div>
  </div>
</div>
<!-- please make sure these two CAPITALIZED variables stay there -->

<div id="content" class="pretty-box yellow content__language_grammars">

    <h1 class='title'>Grammars</h1>
    <p class='subtitle'>Parsing and interpreting text</p>
    <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
        <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#Named_Regexes">Named Regexes</a></td></tr>
                                                    <tr class="toc-level-2"><td class="toc-number">1.1</td><td class="toc-text"><a href="#Rules">Rules</a></td></tr>
                      <tr class="toc-level-1"><td class="toc-number">2</td><td class="toc-text"><a href="#Creating_grammars">Creating grammars</a></td></tr>
                <tr class="toc-level-2"><td class="toc-number">2.1</td><td class="toc-text"><a href="#Proto_regexes">Proto regexes</a></td></tr>
                                                            <tr class="toc-level-2"><td class="toc-number">2.2</td><td class="toc-text"><a href="#Special_tokens">Special tokens</a></td></tr>
 <tr class="toc-level-3"><td class="toc-number">2.2.1</td><td class="toc-text"><a href="#TOP"><code class="pod-code-inline">TOP</code></a></td></tr>
                            <tr class="toc-level-3"><td class="toc-number">2.2.2</td><td class="toc-text"><a href="#ws"><code class="pod-code-inline">ws</code></a></td></tr>
                                     <tr class="toc-level-3"><td class="toc-number">2.2.3</td><td class="toc-text"><a href="#sym"><code class="pod-code-inline">sym</code></a></td></tr>
           <tr class="toc-level-3"><td class="toc-number">2.2.4</td><td class="toc-text"><a href="#&quot;Always_succeed&quot;_assertion">&quot;Always succeed&quot; assertion</a></td></tr>
                      <tr class="toc-level-2"><td class="toc-number">2.3</td><td class="toc-text"><a href="#Methods_in_grammars">Methods in grammars</a></td></tr>
               <tr class="toc-level-2"><td class="toc-number">2.4</td><td class="toc-text"><a href="#Dynamic_variables_in_grammars">Dynamic variables in grammars</a></td></tr>
                                    <tr class="toc-level-2"><td class="toc-number">2.5</td><td class="toc-text"><a href="#Attributes_in_grammars">Attributes in grammars</a></td></tr>
                                                                                <tr class="toc-level-2"><td class="toc-number">2.6</td><td class="toc-text"><a href="#Passing_arguments_into_grammars">Passing arguments into grammars</a></td></tr>
                                                                                            <tr class="toc-level-1"><td class="toc-number">3</td><td class="toc-text"><a href="#Action_objects">Action objects</a></td></tr>
                                                                                                                                                                                                                                                                                               
</table>
</nav>

    <div class="pod-body">
    <p>Grammar is a powerful tool used to destructure text and often to return data structures that have been created by interpreting that text.</p>
<p>For example, Perl&nbsp;6 is parsed and executed using a Perl&nbsp;6-style grammar.</p>
<p>An example that&#39;s more practical to the common Perl&nbsp;6 user is the <a href="https://github.com/moritz/json">JSON::Tiny module</a>, which can deserialize any valid JSON file; however, the deserializing code is written in less than 100 lines of simple, extensible code.</p>
<p>If you didn&#39;t like grammar in school, don&#39;t let that scare you off grammars. Grammars allow you to group regexes, just as classes allow you to group methods of regular code.</p>
<h1 id="Named_Regexes"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-declarator_token-Named_Regexes"><span class="index-entry">Named Regexes</span></a></a></h1>
<p>The main ingredient of grammars is named <a href="/language/regexes">regexes</a>. While the syntax of <a href="/language/regexes">Perl&nbsp;6 Regexes</a> is outside the scope of this document, <em>named</em> regexes have a special syntax, similar to subroutine definitions: <a href="#fn-1" id="fn-ref-1">[1]</a></p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>regex</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>number</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;[&nbsp;\</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;]</span><span class="keyword operator quantifiers regexp perl6fe"><span>?</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div></pre><p>In this case, we have to specify that the regex is lexically scoped using the <code>my</code> keyword, because named regexes are normally used within grammars.</p>
<p>Being named gives us the advantage of being able to easily reuse the regex elsewhere:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>32.51</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>number</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>15&nbsp;+&nbsp;4.5</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>number</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="constant character escape class regexp perl6fe"><span>\s</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>+</span><span>&#39;</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\s</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>number</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div></pre><p><strong><code>regex</code></strong> isn&#39;t the only declarator for named regexes. In fact, it&#39;s the least common. Most of the time, the <strong><code>token</code></strong> or <strong><code>rule</code></strong> declarators are used. These are both <em>ratcheting</em>, which means that the match engine won&#39;t back up and try again if it fails to match something. This will usually do what you want, but isn&#39;t appropriate for all cases:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>regex</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>works-but-slow</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>+</span></span><span>&nbsp;q&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>fails-but-fast</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>+</span></span><span>&nbsp;q&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>s</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>Tokens&nbsp;won</span><span class="constant character escape perl6fe"><span>\&#39;</span></span><span>t&nbsp;backtrack,&nbsp;which&nbsp;makes&nbsp;them&nbsp;fail&nbsp;quicker!</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>s</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>works-but-slow</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>s</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>fails-but-fast</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="punctuation whitespace comment leading perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;the&nbsp;entire&nbsp;string&nbsp;get&nbsp;taken&nbsp;by&nbsp;the&nbsp;.+</span><span>&nbsp;</span></span></span></div></pre><p>Note that non-backtracking works on terms, that is, as the example below, if you have matched something, then you will never backtrack. But when you fail to match, if there is another candidate introduced by <code>|</code> or <code>||</code>, you will retry to match again.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>tok-a</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>*</span></span><span>&nbsp;d&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>tok-b</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>*</span></span><span>&nbsp;d&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;bd&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>bd</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>tok-a</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>bd</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>tok-b</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Rules"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-declarator_rule-Rules"><span class="index-entry">Rules</span></a></a></h2>
<p>The only difference between the <code>token</code> and <code>rule</code> declarators is that the <code>rule</code> declarator causes <a href="/language/regexes#Sigspace"><code>:sigspace</code></a> to go into effect for the Regex:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>non-space-y</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>once</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>upon</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>a</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>time</span><span>&#39;</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>space-y</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>once</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>upon</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>a</span><span>&#39;</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>time</span><span>&#39;</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>onceuponatime</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>non-space-y</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>once&nbsp;upon&nbsp;a&nbsp;time</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>non-space-y</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>onceuponatime</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>space-y</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>once&nbsp;upon&nbsp;a&nbsp;time</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>space-y</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div></pre><h1 id="Creating_grammars"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Creating_grammars"><span class="index-entry">Creating grammars</span></a></a></h1>
<p><a href="/type/Grammar">Grammar</a> is the superclass that classes automatically get when they are declared with the <code>grammar</code> keyword instead of <code>class</code>. Grammars should only be used to parse text; if you wish to extract complex data, you can add actions within the grammar, or an <a href="/language/grammars#Action_objects">action object</a> is recommended to be used in conjunction with the grammar. If action objects are not used, <code>.parse</code> returns a <a href="/type/Match">Match</a> object and sets, by default, the <a href="/syntax/$$SOLIDUS">default match object <code>$/</code></a>, to the same value.</p>
<h2 id="Proto_regexes"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-:sym<>-_proto_regex-_declarator_grammar-Proto_regexes"><span class="index-entry">Proto regexes</span></a></a></h2>
<p><a href="/type/Grammar">Grammar</a>s are composed of rules, tokens and regexes; these are actually methods, since grammars are classes.</p>
<p><a href="#fn-2" id="fn-ref-2">[2]</a></p>
<p>These methods can share a name and functionality in common, and thus can use <a href="/syntax/proto">proto</a>.</p>
<p>For instance, if you have a lot of alternations, it may become difficult to produce readable code or subclass your grammar. In the <code>Actions</code> class below, the ternary in <code>method TOP</code> is less than ideal and it becomes even worse the more operations we add:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Calculator</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;[&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>add</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>sub</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;]&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;&nbsp;</span><span class="entity name function regexp named perl6fe"><span>add</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>+</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;&nbsp;</span><span class="entity name function regexp named perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>-</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>num</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Calculations</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>add</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>??</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>add</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>!!</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>sub</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>add</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;[</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>]&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>num</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>sub</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;[-]&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>num</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculator</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>2&nbsp;+&nbsp;3</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculations</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«5␤»</span></span></span></div></pre><p>To make things better, we can use proto regexes that look like <code>:sym&lt;...&gt;</code> adverbs on tokens:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Calculator</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>calc</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>op</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>proto</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>calc-op</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>calc-op</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>add</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>+</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>calc-op</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>sub</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>-</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>num</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Calculations</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>calc-op</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>calc-op</span></span><span class="punctuation definition function adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>add</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;[</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>]&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>num</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>calc-op</span></span><span class="punctuation definition function adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>sub</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;[-]&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>num</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculator</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>2&nbsp;+&nbsp;3</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculations</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«5␤»</span></span></span></div></pre><p>In this grammar the alternation has now been replaced with <code>&lt;calc-op&gt;</code>, which is essentially the name of a group of values we&#39;ll create. We do so by defining a rule prototype with <code>proto rule calc-op</code>. Each of our previous alternations have been replaced by a new <code>rule calc-op</code> definition and the name of the alternation is attached with <code>:sym&lt;&gt;</code> adverb.</p>
<p>In the class that declares actions, we now got rid of the ternary operator and simply take the <code>.made</code> value from the <code>$&lt;calc-op&gt;</code> match object. And the actions for individual alternations now follow the same naming pattern as in the grammar: <code>method calc-op:sym&lt;add&gt;</code> and <code>method calc-op:sym&lt;sub&gt;</code>.</p>
<p>The real beauty of this method can be seen when you subclass the grammar and action classes. Let&#39;s say we want to add a multiplication feature to the calculator:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>BetterCalculator</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculator</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>calc-op</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>mult</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>*</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>num</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>BetterCalculations</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Calculations</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>calc-op</span></span><span class="punctuation definition function adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>mult</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;[</span><span class="constant language whatever hack perl6fe"><span>*</span></span><span>]&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>num</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>BetterCalculator</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>2&nbsp;*&nbsp;3</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>BetterCalculations</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«6␤»</span><span>&nbsp;</span></span></span></div></pre><p>All we had to add are an additional rule and action to the <code>calc-op</code> group and the thing works—all thanks to proto regexes.</p>
<h2 id="Special_tokens"><a class="u" href="#___top" title="go to top of document">Special tokens</a></h2>
<h3 id="TOP"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-TOP-TOP"><span class="index-entry"><code>TOP</code></span></a></a></h3>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>The <code>TOP</code> token is the default first token attempted to match when parsing with a grammar. Note that if you&#39;re parsing with the <a href="/type/Grammar#method_parse"><code>.parse</code></a> method, <code>token TOP</code> is automatically anchored to the start and end of the string. If you don&#39;t want to parse the whole string, look up <a href="/type/Grammar#method_subparse"><code>.subparse</code></a>.</p>
<p>Using <code>rule TOP</code> or <code>regex TOP</code> is also acceptable.</p>
<p>A different token can be chosen to be matched first using the <code>:rule</code> named argument to <code>.parse</code>, <code>.subparse</code>, or <code>.parsefile</code>. These are all <code>Grammar</code> methods.</p>
<p><a name="index-entry-ws"></a></p>
<h3 id="ws"><a class="u" href="#___top" title="go to top of document"><code>ws</code></a></h3>
<p>The default <code>ws</code> matches zero or more whitespace characters, as long as that point is not within a word (in code form, that&#39;s <code>regex ws { &lt;!ww&gt; \s* }</code>):</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;First&nbsp;&lt;.ws&gt;&nbsp;matches&nbsp;word&nbsp;boundary&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;the&nbsp;line</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;and&nbsp;second&nbsp;&lt;.ws&gt;&nbsp;matches&nbsp;the&nbsp;whitespace&nbsp;between&nbsp;&#39;b&#39;&nbsp;and&nbsp;&#39;c&#39;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ab&nbsp;&nbsp;&nbsp;c</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;ab&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;c&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢ab&nbsp;&nbsp;&nbsp;c｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Failed&nbsp;match:&nbsp;there&nbsp;is&nbsp;neither&nbsp;any&nbsp;whitespace&nbsp;nor&nbsp;a&nbsp;word</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;boundary&nbsp;between&nbsp;&#39;a&#39;&nbsp;and&nbsp;&#39;b&#39;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ab</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;b</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Nil␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Successful&nbsp;match:&nbsp;there&nbsp;is&nbsp;a&nbsp;word&nbsp;boundary&nbsp;between&nbsp;&#39;)&#39;&nbsp;and&nbsp;&#39;b&#39;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>)b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;b</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢)b｣␤»</span></span></span></div></pre><p>Please bear in mind that we&#39;re preceding <code>ws</code> with a dot to avoid capturing, which we are not interested in. Since in general whitespace is a separator, this is how it&#39;s mostly found.</p>
<p>When <code>rule</code> is used instead of <code>token</code>, <code>:sigspace</code> is enabled by default and any whitespace after terms and closing parenthesis/brackets are turned into a non-capturing call to <code>ws</code>, written as <code>&lt;.ws&gt;</code> where <code>.</code> means non-capturing. That is to say:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>entry</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>key</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>=</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>value</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div></pre><p>Is the same as:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>entry</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>key</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>=</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>value</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div></pre><p>You can also redefine the default <code>ws</code> token:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>4&nbsp;&nbsp;&nbsp;</span><span class="constant character escape perl6fe"><span>\n</span><span>\n</span></span><span>&nbsp;5</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Succeeds</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Bar</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>ws</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\h</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span><span>&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>4&nbsp;&nbsp;&nbsp;</span><span class="constant character escape perl6fe"><span>\n</span><span>\n</span></span><span>&nbsp;5</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Fails</span></span></span></div></pre><p>And even capture it, but you need to use it explicitly:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>ws</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>parsed</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Foo</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>3&nbsp;3</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>parsed</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>ws</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢｣␤»</span><span>&nbsp;</span></span></span></div></pre><h3 id="sym"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-<sym>-sym"><span class="index-entry"><code>sym</code></span></a></a></h3>
<p>The <code>&lt;sym&gt;</code> token can be used inside proto regexes to match the string value of the <code>:sym</code> adverb for that particular regex:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>letter</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>proto</span></span><span>&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>P</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>sym</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>e</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>sym</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>r</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>sym</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>l</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>sym</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>letter</span></span><span class="meta regexp named adverb perl6fe"><span class="punctuation definition regexp adverb perl6fe"><span>:</span></span><span class="support type class adverb perl6fe"><span>sym</span></span></span><span>&lt;</span><span class="string array words perl6fe"><span>*</span></span><span>&gt;</span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>I&nbsp;♥&nbsp;Perl</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>class</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>letter</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>grep</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>sym</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Perl␤»</span></span></span></div></pre><p>This comes in handy when you&#39;re already differentiating the proto regexes with the strings you&#39;re going to match, as using <code>&lt;sym&gt;</code> token prevents repetition of those strings.</p>
<p><a name="index-entry-<?>"></a></p>
<h3 id="&quot;Always_succeed&quot;_assertion"><a class="u" href="#___top" title="go to top of document">&quot;Always succeed&quot; assertion</a></h3>
<p>The <code>&lt;?&gt;</code> is the <em>always succeed</em> assertion. When used as a grammar token, it can be used to trigger an Action class method. In the following grammar we look for Arabic digits and define a <code>succ</code> token with the always succeed assertion.</p>
<p>In the action class, we use calls to the <code>succ</code> method to do set up (in this case, we prepare a new element in <code>@!numbers</code>). In the <code>digit</code> method, we use the Arabic digit as an index into a list of Devanagari digits and add it to the last element of <code>@!numbers</code>. Thanks to <code>succ</code>, the last element will always be the number for the currently parsed <code>digit</code> digits.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Digifier</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.succ</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>digit</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;]</span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>succ</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>?</span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>digit</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="keyword operator charclass open regexp perl6fe"><span>[</span></span><span class="constant character custom property regexp perl6fe"><span>0..9</span></span><span class="keyword operator charclass close regexp perl6fe"><span>]</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Devanagari</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>numbers</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>digit</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>numbers</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>tail</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>०&nbsp;&nbsp;१&nbsp;&nbsp;२&nbsp;&nbsp;३&nbsp;&nbsp;४&nbsp;&nbsp;५&nbsp;&nbsp;६&nbsp;&nbsp;७&nbsp;&nbsp;८&nbsp;&nbsp;९</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>[</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>]&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>succ</span></span><span>&nbsp;&nbsp;($)&nbsp;&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>numbers</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>push</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;&nbsp;&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>numbers</span></span></span><span>[</span><span class="keyword operator generic perl6fe"><span>^</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>*</span></span><span class="constant numeric perl6fe"><span>-1</span></span><span>)]&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Digifier</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>255&nbsp;435&nbsp;777</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Devanagari</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(२५५&nbsp;४३५&nbsp;७७७)␤»</span></span></span></div></pre><h2 id="Methods_in_grammars"><a class="u" href="#___top" title="go to top of document">Methods in grammars</a></h2>
<p>It&#39;s fine to use methods instead of rules or tokens in a grammar, as long as they return a <a href="/type/Match">Match</a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>DigitMatcher</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>full-unicode</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>full-unicode</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>??</span></span><span>&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>num</span></span><span>-</span><span class="routine name perl6fe"><span>full</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>!!</span></span><span>&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>num</span></span><span>-</span><span class="routine name perl6fe"><span>basic</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>num-full</span></span><span>&nbsp;&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>num-basic</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="keyword operator charclass open regexp perl6fe"><span>[</span></span><span class="constant character custom property regexp perl6fe"><span>0..9</span></span><span class="keyword operator charclass close regexp perl6fe"><span>]</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>The grammar above will attempt different matches depending on the argument provided to the subparse methods:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span class="routine name perl6fe"><span>DigitMatcher</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>12७१७९०९</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>args&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;\(</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>full-unicode</span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«12717909␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span class="routine name perl6fe"><span>DigitMatcher</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>12७१७९०९</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>args&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;\(</span><span class="keyword operator generic perl6fe"><span>:</span><span>!</span></span><span class="routine name perl6fe"><span>full-unicode</span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«12␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Dynamic_variables_in_grammars"><a class="u" href="#___top" title="go to top of document">Dynamic variables in grammars</a></h2>
<p>Variables can be defined in tokens by prefixing the lines of code defining them with <code>:</code>. Arbitrary code can be embedded anywhere in a token by surrounding it with curly braces. This is useful for keeping state between tokens, which can be used to alter how the grammar will parse text. Using dynamic variables (variables with <code>$*</code>, <code>@*</code>, <code>&amp;*</code>, <code>%*</code> twigils) in tokens cascades down through <em>all</em> tokens defined thereafter within the one where it&#39;s defined, avoiding having to pass them from token to token as arguments.</p>
<p>One use for dynamic variables is guards for matches. This example uses guards to explain which regex classes parse whitespace literally:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>GrammarAdvice</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="entity name section adverb perl6fe"><span>:my</span></span><span>&nbsp;Int&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>*</span></span><span>USE-WS</span></span><span>;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>use</span><span>&quot;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>type</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>for</span><span>&quot;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>significance</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>whitespace&nbsp;by&nbsp;default</span><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>type</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>rules</span><span>&quot;</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>USE-WS</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>tokens</span><span>&quot;</span></span><span>&nbsp;&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>USE-WS</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>regexes</span><span>&quot;</span></span><span>&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>USE-WS</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>significance</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>&lt;?{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>USE-WS</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>==</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>significant</span><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>&lt;?{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>USE-WS</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>==</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>insignificant</span><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>Here, text such as &quot;use rules for significant whitespace by default&quot; will only match if the state assigned by whether rules, tokens, or regexes are mentioned matches with the correct guard:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>GrammarAdvice</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>use&nbsp;rules&nbsp;for&nbsp;significant&nbsp;whitespace&nbsp;by&nbsp;default</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«use&nbsp;rules&nbsp;for&nbsp;significant&nbsp;whitespace&nbsp;by&nbsp;default»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>GrammarAdvice</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>use&nbsp;tokens&nbsp;for&nbsp;insignificant&nbsp;whitespace&nbsp;by&nbsp;default</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«use&nbsp;tokens&nbsp;for&nbsp;insignificant&nbsp;whitespace&nbsp;by&nbsp;default»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>GrammarAdvice</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>use&nbsp;regexes&nbsp;for&nbsp;insignificant&nbsp;whitespace&nbsp;by&nbsp;default</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«use&nbsp;regexes&nbsp;for&nbsp;insignificant&nbsp;whitespace&nbsp;by&nbsp;default»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>GrammarAdvice</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>subparse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>use&nbsp;regexes&nbsp;for&nbsp;significant&nbsp;whitespace&nbsp;by&nbsp;default</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>)</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;#&lt;failed&nbsp;match&gt;</span><span>&nbsp;</span></span></span></div></pre><h2 id="Attributes_in_grammars"><a class="u" href="#___top" title="go to top of document">Attributes in grammars</a></h2>
<p>Attributes may be defined in grammars. However, they can only be accessed by methods. Attempting to use them from within a token will throw an exception because tokens are methods of <a href="/type/Match">Match</a>, not of the grammar itself. Note that mutating an attribute from within a method called in a token will <em>only modify the attribute for that token&#39;s own match object</em>! Grammar attributes can be accessed in the match returned after parsing if made public:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>HTTPRequest</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Bool</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>invalid</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>type</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>path</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>HTTP/1.1</span><span>&#39;</span></span><span>&nbsp;\r</span><span class="constant character escape class regexp perl6fe"><span>\n</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>field</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;\r</span><span class="constant character escape class regexp perl6fe"><span>\n</span></span><span>]</span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r</span><span class="constant character escape class regexp perl6fe"><span>\n</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>body</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>=</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>*</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>type</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;GET&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;POST&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;OPTIONS&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;HEAD&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;PUT&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;DELETE&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;TRACE&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;CONNECT</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\S</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.error</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>path</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>/</span><span>&#39;</span></span><span>&nbsp;[[</span><span class="constant character escape class regexp perl6fe"><span>\w</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>]</span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>%</span></span><span>&nbsp;\/]&nbsp;[\</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span class="constant character escape class regexp perl6fe"><span>\w</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>]</span><span class="keyword operator quantifiers regexp perl6fe"><span>?</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>*</span><span>&#39;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\S</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.error</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>field</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>name</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>=</span><span class="constant character escape class regexp perl6fe"><span>\w</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;:&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>value</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>=</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="keyword operator charclass open regexp perl6fe"><span>[</span></span><span class="constant character custom property regexp perl6fe"><span>\r\n</span></span><span class="keyword operator charclass close regexp perl6fe"><span>]</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="keyword operator charclass open regexp perl6fe"><span>[</span></span><span class="constant character custom property regexp perl6fe"><span>\r\n</span></span><span class="keyword operator charclass close regexp perl6fe"><span>]</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.error</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>error</span></span><span>(</span><span class="keyword operator multi-symbol perl6fe"><span>--&gt;</span></span><span>&nbsp;::</span><span class="keyword operator generic perl6fe"><span>?</span></span><span class="routine name perl6fe"><span>CLASS</span></span><span class="meta adverb definedness perl6fe"><span class="keyword operator adverb perl6fe"><span>:</span></span><span class="keyword other special-method definedness perl6fe"><span>D</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>invalid</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>True</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>header</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>MEOWS&nbsp;/&nbsp;HTTP/1.1</span><span class="constant character escape perl6fe"><span>\r</span><span>\n</span></span><span>Host:&nbsp;docs.perl6.org</span><span class="constant character escape perl6fe"><span>\r</span><span>\n</span></span><span>sup&nbsp;lol</span><span class="constant character escape perl6fe"><span>\r</span><span>\n</span><span>\r</span><span>\n</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>HTTPRequest</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>header</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>type</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>invalid</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>path</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>invalid</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;(Bool)</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>field</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span>»</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>invalid</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;[(Bool)&nbsp;True]</span><span>&nbsp;</span></span></span></div></pre><h2 id="Passing_arguments_into_grammars"><a class="u" href="#___top" title="go to top of document">Passing arguments into grammars</a></h2>
<p>To pass arguments into a grammar, you can use the named argument of <code>:args</code> on any of the parsing methods of grammar. The arguments passed should be in a <code>list</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>demonstrate-arguments</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named signature perl6fe"><span class="punctuation definition regexp named signature perlfe"><span>(</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>word</span></span></span><span class="punctuation definition regexp named signature perlfe"><span>)</span></span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>I&nbsp;like</span><span>&quot;</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>word</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Notice&nbsp;the&nbsp;comma&nbsp;after&nbsp;&quot;sweets&quot;&nbsp;when&nbsp;passed&nbsp;to&nbsp;:args&nbsp;to&nbsp;coerce&nbsp;it&nbsp;to&nbsp;a&nbsp;list</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>demonstrate-arguments</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>I&nbsp;like&nbsp;sweets</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>args</span></span><span>((</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>sweets</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,)));</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢I&nbsp;like&nbsp;sweets｣␤»</span><span>&nbsp;</span></span></span></div></pre><p>Once the arguments are passed in, they can be used in a call to a named regex inside the grammar.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>demonstrate-arguments-again</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named signature perl6fe"><span class="punctuation definition regexp named signature perlfe"><span>(</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>word</span></span></span><span class="punctuation definition regexp named signature perlfe"><span>)</span></span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>phrase</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>stem</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>added</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>word</span></span><span class="meta rule signature perl6fe"><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>word</span></span></span><span>)</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>phrase-stem</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>I&nbsp;like</span><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>added-word</span></span><span class="meta regexp named signature perl6fe"><span class="punctuation definition regexp named signature perlfe"><span>(</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>passed-word</span></span></span><span class="punctuation definition regexp named signature perlfe"><span>)</span></span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>passed-word</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>demonstrate-arguments-again</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>I&nbsp;like&nbsp;vegetables</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>args</span></span><span>((</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>vegetables</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,)));</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢I&nbsp;like&nbsp;vegetables｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;&nbsp;«phrase-stem&nbsp;=&gt;&nbsp;｢I&nbsp;like&nbsp;｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;&nbsp;«added-word&nbsp;=&gt;&nbsp;｢vegetables｣␤»</span><span>&nbsp;</span></span></span></div></pre><p>Alternatively, you can initialize dynamic variables and use any arguments that way within the grammar.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>demonstrate-arguments-dynamic</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named signature perl6fe"><span class="punctuation definition regexp named signature perlfe"><span>(</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>word</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>extra</span></span></span><span class="punctuation definition regexp named signature perlfe"><span>)</span></span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>phrase</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>stem</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>added</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>words</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>phrase-stem</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string literal perl6fe"><span>&quot;</span><span>I&nbsp;like</span><span>&quot;</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>rule</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>added-words</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>*</span></span><span>word</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>*</span></span><span>extra</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>demonstrate-arguments-dynamic</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>I&nbsp;like&nbsp;everything&nbsp;else</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>args</span></span><span>((</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>everything</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>else</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>)));</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢I&nbsp;like&nbsp;everything&nbsp;else｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;&nbsp;«phrase-stem&nbsp;=&gt;&nbsp;｢I&nbsp;like&nbsp;｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;&nbsp;«added-words&nbsp;=&gt;&nbsp;｢everything&nbsp;else｣␤»</span><span>&nbsp;</span></span></span></div></pre><p><a name="index-entry-Actions"></a></p>
<h1 id="Action_objects"><a class="u" href="#___top" title="go to top of document">Action objects</a></h1>
<p>A successful grammar match gives you a parse tree of <a href="/type/Match">Match</a> objects, and the deeper that match tree gets, and the more branches in the grammar are, the harder it becomes to navigate the match tree to get the information you are actually interested in.</p>
<p>To avoid the need for diving deep into a match tree, you can supply an <em>actions</em> object. After each successful parse of a named rule in your grammar, it tries to call a method of the same name as the grammar rule, giving it the newly created <a href="/type/Match">Match</a> object as a positional argument. If no such method exists, it is skipped.</p>
<p>Here is a contrived example of a grammar and actions in action:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>TestGrammar</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\d</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>TestActions</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>(</span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>&nbsp;</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>);</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>TestGrammar</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>40</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>actions&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>TestActions</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢40｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«42␤»</span><span>&nbsp;</span></span></span></div></pre><p>An instance of <code>TestActions</code> is passed as named argument <code>actions</code> to the <a href="/routine/parse">parse</a> call, and when token <code>TOP</code> has matched successfully, it automatically calls method <code>TOP</code>, passing the match object as an argument.</p>
<p>To make it clear that the argument is a match object, the example uses <code>$/</code> as a parameter name to the action method, though that&#39;s just a handy convention, nothing intrinsic; <code>$match</code> would have worked too, though using <code>$/</code> does give the advantage of providing <code>$&lt;capture&gt;</code> as a shortcut for <code>$/&lt;capture&gt;</code>; we use another argument, anyway, in the action for <code>TOP</code>.</p>
<p>A slightly more involved example follows:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>KeyValuePairs</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>pair</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\v</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>]</span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>pair</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="meta capture assignment perl6fe"><span class="entity name function capturename perl6fe"><span>key</span></span><span class="storage modifier capture assignment perl6fe"><span>=</span></span></span><span class="comment suppressed capture property regexp perl6fe"><span>.identifier</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>=</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="meta capture assignment perl6fe"><span class="entity name function capturename perl6fe"><span>value</span></span><span class="storage modifier capture assignment perl6fe"><span>=</span></span></span><span class="comment suppressed capture property regexp perl6fe"><span>.identifier</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>identifier</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\w</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>KeyValuePairsActions</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>pair</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>key</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="meta match variable perl6fe"><span class="variable other identifier sigil regexp perl6"><span>$</span></span><span class="support class match name delimiter regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexp perl6"><span>value</span></span><span class="support class match name delimiter regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>identifier</span></span><span>(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span class="punctuation whitespace comment leading perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;subroutine&nbsp;`make`&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;calling&nbsp;.make&nbsp;on&nbsp;$/</span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span class="keyword other special-method perl6fe"><span>$/</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span class="punctuation whitespace comment leading perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;can&nbsp;use&nbsp;any&nbsp;variable&nbsp;name&nbsp;for&nbsp;parameter,&nbsp;not&nbsp;just&nbsp;$/</span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>pair</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>»</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>actions</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairsActions</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>res</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairs</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="meta heredoc perl6fe"><span class="string quoted construct perl6fe"><span>q</span></span><span class="support function adverb perl6fe"><span>:to</span></span><span>/</span><span class="entity other attribute-name heredoc delimiter perl6fe"><span>EOI</span></span><span>/</span><span class="meta heredoc continuation perl6fe"><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>actions</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>second=b</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>hits=42</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>perl=6</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="entity other attribute-name heredoc delimiter perl6fe"><span>EOI</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>res</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>p</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Key:&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>p</span><span class="keyword operator dot perl6fe"><span>.</span></span><span class="support function perl6fe"><span>key</span></span><span>()</span></span><span class="constant character escape perl6fe"><span>\t</span></span><span>Value:&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>p</span><span class="keyword operator dot perl6fe"><span>.</span></span><span class="support function perl6fe"><span>value</span></span><span>()</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>This produces the following output:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Key</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>second</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>Value</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>b</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Key</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>hits</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>Value</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Key</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>perl</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>Value</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>6</span></span></span></div></pre><p>Rule <code>pair</code>, which parsed a pair separated by an equals sign, aliases the two calls to token <code>identifier</code> to separate capture names so that they are available more easily and intuitively, as they will be in the corresponding Action. The corresponding action method constructs a <a href="/type/Pair">Pair</a> object, and uses the <code>.made</code> property of the sub match objects. So it (like the action method <code>TOP</code> too) exploits the fact that action methods for submatches are called before those of the calling/outer regex. So action methods are called in <a href="https://en.wikipedia.org/wiki/Tree_traversal#Post-order">post-order</a>.</p>
<p>The action method <code>TOP</code> simply collects all the objects that were <code>.made</code> by the multiple matches of the <code>pair</code> rule, and returns them in a list.</p>
<p>Also note that <code>KeyValuePairsActions</code> was passed as a type object to method <code>parse</code>, which was possible because none of the action methods use attributes (which would only be available in an instance).</p>
<p>We can extend above example by using inheritance.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword other include perl6fe"><span>use</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairs</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>unit</span></span><span>&nbsp;</span><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>ConfigurationSets</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairs</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>configuration</span></span><span class="keyword operator property regexp perl6fe"><span>-</span></span><span class="variable other identifier regexname perl6fe"><span>element</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>%</span><span>%</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\v</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>configuration-element</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>pair</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>%</span><span>%</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\v</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>comment</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\s</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>*</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>#</span><span>&#39;</span></span><span>&nbsp;</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span><span>+</span><span>?</span></span><span>&nbsp;</span><span class="entity name section boundary regexp perl6fe"><span>$$</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>pair</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="meta regexp named block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="meta capture assignment perl6fe"><span class="entity name function capturename perl6fe"><span>key</span></span><span class="storage modifier capture assignment perl6fe"><span>=</span></span></span><span class="comment suppressed capture property regexp perl6fe"><span>.identifier</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>=</span><span>&#39;</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="meta capture assignment perl6fe"><span class="entity name function capturename perl6fe"><span>value</span></span><span class="storage modifier capture assignment perl6fe"><span>=</span></span></span><span class="comment suppressed capture property regexp perl6fe"><span>.identifier</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>comment</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span class="keyword operator quantifiers regexp perl6fe"><span>?</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta regexp named perl6fe"><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></div></pre><p>We are sub-classing (actually, sub-grammaring) the previous example; we have overriden the definition of <code>pair</code> by adding a <code>comment</code>; the previous <code>TOP</code> rule has been demoted to <code>configuration-element</code>, and there&#39;s a new <code>TOP</code> which now considers sets of configuration elements separated by vertical space. We can also reuse actions by subclassing the action class:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword other include perl6fe"><span>use</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairs</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>unit</span></span><span>&nbsp;</span><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>ConfigurationSetsActions</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>KeyValuePairsActions</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>configuration-element</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>pair</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>»</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>made-elements</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>gather</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>configuration-element</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>take</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>match</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>make</span></span><span>(&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>made-elements</span></span></span><span>&nbsp;);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>All existing actions are reused, although obviously new ones have to be written for the new elements in the grammar, including <code>TOP</code>. These can be used together from this script:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword other include perl6fe"><span>use</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>ConfigurationSets</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword other include perl6fe"><span>use</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>ConfigurationSetsActions</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>actions</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>ConfigurationSetsActions</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>sets</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>ConfigurationSets</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="meta heredoc perl6fe"><span class="string quoted construct perl6fe"><span>q</span></span><span class="support function adverb perl6fe"><span>:to</span></span><span>/</span><span class="entity other attribute-name heredoc delimiter perl6fe"><span>EOI</span></span><span>/</span><span class="meta heredoc continuation perl6fe"><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>actions</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword control flowcontrol regex perl6fe"><span>made</span></span><span>;</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>second=b&nbsp;#&nbsp;Just&nbsp;a&nbsp;thing</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>hits=42</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>perl=6</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>third=c&nbsp;#&nbsp;New&nbsp;one</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="string quoted q heredoc perl6fe"><span>hits=33</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta heredoc perl6fe"><span class="entity other attribute-name heredoc delimiter perl6fe"><span>EOI</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;@</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>sets</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>set</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Element→&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>set</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>Which will print</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Element</span></span><span>→&nbsp;</span><span class="routine name perl6fe"><span>second</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>b</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>hits</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>perl</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>6</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Element</span></span><span>→&nbsp;</span><span class="routine name perl6fe"><span>third</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>c</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>hits</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>33</span></span></span></div></pre><p>In other cases, action methods might want to keep state in attributes. Then of course you must pass an instance to method parse.</p>
<p>Note that <code>token</code> <code>ws</code> is special: when <code>:sigspace</code> is enabled (and it is when we are using <code>rule</code>), it replaces certain whitespace sequences. This is why the spaces around the equals sign in <code>rule pair</code> work just fine and why the whitespace before closing <code>}</code> does not gobble up the newlines looked for in <code>token TOP</code>.</p>

    </div>
    <aside><ol start="1">
<li><a href="#fn-ref-1" id="fn-1">[↑]</a> In fact, named regexes can even take extra arguments, using the same syntax as subroutine parameter lists </li>
<li><a href="#fn-ref-2" id="fn-2">[↑]</a> They are actually a special kind of class, but for the rest of the section, they behave in the same way as a <em>normal</em> class would </li>
</ol></aside>

    </div>
<footer class="pretty-box yellow">

  <p>This is the deprecated documentation of the Perl 6 language, currently
      known as Raku. Please use
      <a href="https://docs.raku.org"><code>docs.raku.org</code></a> from now on.</p>

  <p>This page has been superseded by <a href="https://docs.raku.org//language/grammars">/language/grammars</a>.</p>

  <p> This documentation is provided under the terms of the
      <a href="https://raw.githubusercontent.com/perl6/doc/master/LICENSE">Artistic License 2.0</a>.
      The Camelia image is <a href="https://raw.githubusercontent.com/perl6/mu/master/misc/camelia.txt"
        >copyright © 2009 by Larry Wall.</a>
      <!-- CREDITS -->
      <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->

  </p>
</footer>

<script type="text/javascript" src="/js/app.js?v=1"></script>
<script type="text/javascript" src="/js/search.js?v=3"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if (!location.hash || location.hash === "#___top") {
      $('query').focus();
    }
  });
</script>

    </body>
</html>
