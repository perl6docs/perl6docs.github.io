<!doctype html>
<html lang="en">
    <head>
        <title>Traps to avoid</title>
        <meta charset="UTF-8" />
        <style>
        kbd { font-family: "Droid Sans Mono", "Luxi Mono", "Inconsolata", monospace }
        samp { font-family: "Terminus", "Courier", "Lucida Console", monospace }
        u { text-decoration: none }
        .nested {
            margin-left: 3em;
        }
        aside, u { opacity: 0.7 }
        a[id^="fn-"]:target { background: #ff0 }
        </style>
        
        
        <meta name=viewport content="width=device-width, initial-scale=1">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/css/app.css?v=7" media="screen" title="default" />
<noscript> <style> #search { visibility: hidden; } </style> </noscript>

    </head>
    <body class="pod">
    <div id="___top"></div>
    <div id="header" class="pretty-box green">
  <a href="/"
    ><img
      src="/images/Camelia.svg"
      alt="»ö«"
      id="logo"
      width="62"
      height="48"
    />&nbsp;Perl 6 Documentation</a
  >
  <div id="search" class="ui-widget">
    <div class="green">
      <input
        placeholder="Loading..."
        id="query"
        accesskey="f"
        title="Enter term to search for (hit Esc to focus)"
      />
    </div>
    <p id="not-found-message">
      Not in Index (<a href="" id="try-web-search">try site search</a>)
    </p>
  </div>
  <div class="menu">
    <div class="menu-items dark-green"><a class='menu-item darker-green' href='https://perl6.org'><strong>Perl&nbsp;6 homepage</strong></a>  <a class="menu-item selected darker-green" href="/language.html"> Language </a> <a class="menu-item " href="/type.html"> Types </a> <a class="menu-item " href="/routine.html"> Routines </a> <a class="menu-item " href="/programs.html"> Programs </a> <a class="menu-item " href="https://webchat.freenode.net/?channels=#perl6"> Chat with us </a></div>
  </div>
</div>
<!-- please make sure these two CAPITALIZED variables stay there -->

<div id="content" class="pretty-box yellow content__language_traps">

    <h1 class='title'>Traps to avoid</h1>
    <p class='subtitle'>Traps to avoid when getting started with Perl&nbsp;6</p>
    <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
     <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#Variables_and_constants">Variables and constants</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">1.1</td><td class="toc-text"><a href="#Constants_are_computed_at_compile_time">Constants are computed at compile time</a></td></tr>
                        <tr class="toc-level-2"><td class="toc-number">1.2</td><td class="toc-text"><a href="#Assigning_to_Nil_produces_a_different_value,_usually_Any">Assigning to <code class="pod-code-inline">Nil</code> produces a different value, usually <code class="pod-code-inline">Any</code></a></td></tr>
                                               <tr class="toc-level-2"><td class="toc-number">1.3</td><td class="toc-text"><a href="#Using_a_block_to_interpolate_anon_state_vars">Using a block to interpolate anon state vars</a></td></tr>
                                                                            <tr class="toc-level-2"><td class="toc-number">1.4</td><td class="toc-text"><a href="#Using_set_subroutines_on_Associative_when_the_value_is_falsy">Using set subroutines on <code class="pod-code-inline">Associative</code> when the value is falsy</a></td></tr>
                                       <tr class="toc-level-1"><td class="toc-number">2</td><td class="toc-text"><a href="#Blocks">Blocks</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">2.1</td><td class="toc-text"><a href="#Beware_of_empty_&quot;blocks&quot;">Beware of empty &quot;blocks&quot;</a></td></tr>
            <tr class="toc-level-1"><td class="toc-number">3</td><td class="toc-text"><a href="#Objects">Objects</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">3.1</td><td class="toc-text"><a href="#Assigning_to_attributes">Assigning to attributes</a></td></tr>
                                                            <tr class="toc-level-2"><td class="toc-number">3.2</td><td class="toc-text"><a href="#BUILD_prevents_automatic_attribute_initialization_from_constructor_arguments"><code class="pod-code-inline">BUILD</code> prevents automatic attribute initialization from constructor arguments</a></td></tr>
                                                    <tr class="toc-level-1"><td class="toc-number">4</td><td class="toc-text"><a href="#Whitespace">Whitespace</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">4.1</td><td class="toc-text"><a href="#Whitespace_in_regexes_does_not_match_literally">Whitespace in regexes does not match literally</a></td></tr>
                          <tr class="toc-level-2"><td class="toc-number">4.2</td><td class="toc-text"><a href="#Ambiguities_in_parsing">Ambiguities in parsing</a></td></tr>
     <tr class="toc-level-3"><td class="toc-number">4.2.1</td><td class="toc-text"><a href="#Block_vs._Hash_slice_ambiguity">Block vs. Hash slice ambiguity</a></td></tr>
              <tr class="toc-level-3"><td class="toc-number">4.2.2</td><td class="toc-text"><a href="#Reduction_vs._Array_constructor_ambiguity">Reduction vs. Array constructor ambiguity</a></td></tr>
              <tr class="toc-level-3"><td class="toc-number">4.2.3</td><td class="toc-text"><a href="#Less_than_vs._Word_quoting/Associative_indexing">Less than vs. Word quoting/Associative indexing</a></td></tr>
         <tr class="toc-level-3"><td class="toc-number">4.2.4</td><td class="toc-text"><a href="#Exclusive_sequences_vs._sequences_with_Ranges">Exclusive sequences vs. sequences with Ranges</a></td></tr>
          <tr class="toc-level-1"><td class="toc-number">5</td><td class="toc-text"><a href="#Captures">Captures</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">5.1</td><td class="toc-text"><a href="#Containers_versus_values_in_a_capture">Containers versus values in a capture</a></td></tr>
                                                                              <tr class="toc-level-1"><td class="toc-number">6</td><td class="toc-text"><a href="#Cool_tricks"><code class="pod-code-inline">Cool</code> tricks</a></td></tr>
              <tr class="toc-level-2"><td class="toc-number">6.1</td><td class="toc-text"><a href="#Strings_are_not_Lists,_so_beware_indexing">Strings are not <code class="pod-code-inline">List</code> s, so beware indexing</a></td></tr>
          <tr class="toc-level-2"><td class="toc-number">6.2</td><td class="toc-text"><a href="#Lists_become_strings,_so_beware_.index()ing"><code class="pod-code-inline">List</code> s become strings, so beware <code class="pod-code-inline">.index()</code> ing</a></td></tr>
                            <tr class="toc-level-2"><td class="toc-number">6.3</td><td class="toc-text"><a href="#Lists_become_strings,_so_beware_.contains()"><code class="pod-code-inline">List</code> s become strings, so beware <code class="pod-code-inline">.contains()</code></a></td></tr>
                                    <tr class="toc-level-2"><td class="toc-number">6.4</td><td class="toc-text"><a href="#Numeric_literals_are_parsed_before_coercion"><code class="pod-code-inline">Numeric</code> literals are parsed before coercion</a></td></tr>
          <tr class="toc-level-2"><td class="toc-number">6.5</td><td class="toc-text"><a href="#Getting_a_random_item_from_a_List">Getting a random item from a <code class="pod-code-inline">List</code></a></td></tr>
                          <tr class="toc-level-2"><td class="toc-number">6.6</td><td class="toc-text"><a href="#Lists_numify_to_their_number_of_elements_in_numeric_context"><code class="pod-code-inline">List</code> s numify to their number of elements in numeric context</a></td></tr>
             <tr class="toc-level-1"><td class="toc-number">7</td><td class="toc-text"><a href="#Arrays">Arrays</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">7.1</td><td class="toc-text"><a href="#Referencing_the_last_element_of_an_array">Referencing the last element of an array</a></td></tr>
                    <tr class="toc-level-2"><td class="toc-number">7.2</td><td class="toc-text"><a href="#Typed_array_parameters">Typed array parameters</a></td></tr>
                            <tr class="toc-level-2"><td class="toc-number">7.3</td><td class="toc-text"><a href="#Using_«»_quoting_when_you_don't_need_it">Using <code class="pod-code-inline">«»</code> quoting when you don&#39;t need it</a></td></tr>
                                     <tr class="toc-level-1"><td class="toc-number">8</td><td class="toc-text"><a href="#Strings">Strings</a></td></tr>
    <tr class="toc-level-2"><td class="toc-number">8.1</td><td class="toc-text"><a href="#Quotes_and_interpolation">Quotes and interpolation</a></td></tr>
                                  <tr class="toc-level-2"><td class="toc-number">8.2</td><td class="toc-text"><a href="#Strings_are_not_iterable">Strings are not iterable</a></td></tr>
              <tr class="toc-level-2"><td class="toc-number">8.3</td><td class="toc-text"><a href="#.chars_gets_the_number_of_graphemes,_not_Codepoints"><code class="pod-code-inline">.chars</code> gets the number of graphemes, not Codepoints</a></td></tr>
            <tr class="toc-level-2"><td class="toc-number">8.4</td><td class="toc-text"><a href="#All_text_is_normalized_by_default">All text is normalized by default</a></td></tr>
    <tr class="toc-level-2"><td class="toc-number">8.5</td><td class="toc-text"><a href="#Allomorphs_generally_follow_numeric_semantics">Allomorphs generally follow numeric semantics</a></td></tr>
                                       <tr class="toc-level-2"><td class="toc-number">8.6</td><td class="toc-text"><a href="#Case-insensitive_comparison_of_strings">Case-insensitive comparison of strings</a></td></tr>
                     <tr class="toc-level-1"><td class="toc-number">9</td><td class="toc-text"><a href="#Pairs">Pairs</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">9.1</td><td class="toc-text"><a href="#Constants_on_the_left-hand_side_of_pair_notation">Constants on the left-hand side of pair notation</a></td></tr>
                         <tr class="toc-level-2"><td class="toc-number">9.2</td><td class="toc-text"><a href="#Scalar_values_within_Pair">Scalar values within <code class="pod-code-inline">Pair</code></a></td></tr>
                              <tr class="toc-level-1"><td class="toc-number">10</td><td class="toc-text"><a href="#Sets,_bags_and_mixes">Sets, bags and mixes</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">10.1</td><td class="toc-text"><a href="#Sets,_bags_and_mixes_do_not_have_a_fixed_order">Sets, bags and mixes do not have a fixed order</a></td></tr>
              <tr class="toc-level-1"><td class="toc-number">11</td><td class="toc-text"><a href="#Operators">Operators</a></td></tr>
  <tr class="toc-level-2"><td class="toc-number">11.1</td><td class="toc-text"><a href="#Junctions">Junctions</a></td></tr>
                        <tr class="toc-level-2"><td class="toc-number">11.2</td><td class="toc-text"><a href="#Exclusive_sequence_operator">Exclusive sequence operator</a></td></tr>
                      <tr class="toc-level-2"><td class="toc-number">11.3</td><td class="toc-text"><a href="#String_ranges/Sequences">String ranges/Sequences</a></td></tr>
                                <tr class="toc-level-2"><td class="toc-number">11.4</td><td class="toc-text"><a href="#Topicalizing_operators">Topicalizing operators</a></td></tr>
                                 <tr class="toc-level-2"><td class="toc-number">11.5</td><td class="toc-text"><a href="#Fat_arrow_and_constants">Fat arrow and constants</a></td></tr>
                <tr class="toc-level-2"><td class="toc-number">11.6</td><td class="toc-text"><a href="#Infix_operator_assignment">Infix operator assignment</a></td></tr>
                                    <tr class="toc-level-1"><td class="toc-number">12</td><td class="toc-text"><a href="#Regexes">Regexes</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">12.1</td><td class="toc-text"><a href="#$x_vs_&lt;$x&gt;,_and_$(code)_vs_&lt;{code}&gt;"><code class="pod-code-inline">$x</code> vs <code class="pod-code-inline">&lt;$x&gt;</code> , and <code class="pod-code-inline">$(code)</code> vs <code class="pod-code-inline">&lt;{code}&gt;</code></a></td></tr>
                                        <tr class="toc-level-2"><td class="toc-number">12.2</td><td class="toc-text"><a href="#|_vs_||:_which_branch_will_win"><code class="pod-code-inline">|</code> vs <code class="pod-code-inline">||</code> : which branch will win</a></td></tr>
                                  <tr class="toc-level-2"><td class="toc-number">12.3</td><td class="toc-text"><a href="#$/_changes_each_time_a_regular_expression_is_matched"><code class="pod-code-inline">$/</code> changes each time a regular expression is matched</a></td></tr>
              <tr class="toc-level-2"><td class="toc-number">12.4</td><td class="toc-text"><a href="#&lt;foo&gt;_vs._&lt;_foo&gt;:_named_rules_vs._quoted_lists"><code class="pod-code-inline">&lt;foo&gt;</code> vs. <code class="pod-code-inline">&lt; foo&gt;</code> : named rules vs. quoted lists</a></td></tr>
                    <tr class="toc-level-2"><td class="toc-number">12.5</td><td class="toc-text"><a href="#Non-capturing,_non-global_matching_in_list_context">Non-capturing, non-global matching in list context</a></td></tr>
       <tr class="toc-level-1"><td class="toc-number">13</td><td class="toc-text"><a href="#Common_precedence_mistakes">Common precedence mistakes</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">13.1</td><td class="toc-text"><a href="#Adverbs_and_precedence">Adverbs and precedence</a></td></tr>
              <tr class="toc-level-2"><td class="toc-number">13.2</td><td class="toc-text"><a href="#Ranges_and_precedence">Ranges and precedence</a></td></tr>
        <tr class="toc-level-2"><td class="toc-number">13.3</td><td class="toc-text"><a href="#Loose_boolean_operators">Loose boolean operators</a></td></tr>
                      <tr class="toc-level-2"><td class="toc-number">13.4</td><td class="toc-text"><a href="#Exponentiation_operator_and_prefix_minus">Exponentiation operator and prefix minus</a></td></tr>
                    <tr class="toc-level-2"><td class="toc-number">13.5</td><td class="toc-text"><a href="#Method_operator_calls_and_prefix_minus">Method operator calls and prefix minus</a></td></tr>
      <tr class="toc-level-1"><td class="toc-number">14</td><td class="toc-text"><a href="#Subroutine_and_method_calls">Subroutine and method calls</a></td></tr>
                                  <tr class="toc-level-2"><td class="toc-number">14.1</td><td class="toc-text"><a href="#Named_parameters">Named parameters</a></td></tr>
                                                         <tr class="toc-level-2"><td class="toc-number">14.2</td><td class="toc-text"><a href="#Argument_count_limit">Argument count limit</a></td></tr>
                             <tr class="toc-level-2"><td class="toc-number">14.3</td><td class="toc-text"><a href="#Phasers_and_implicit_return">Phasers and implicit return</a></td></tr>
                                                            <tr class="toc-level-1"><td class="toc-number">15</td><td class="toc-text"><a href="#Input_and_output">Input and output</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">15.1</td><td class="toc-text"><a href="#Closing_open_filehandles_and_pipes">Closing open filehandles and pipes</a></td></tr>
                            <tr class="toc-level-2"><td class="toc-number">15.2</td><td class="toc-text"><a href="#IO::Path_stringification">IO::Path stringification</a></td></tr>
                                                          <tr class="toc-level-2"><td class="toc-number">15.3</td><td class="toc-text"><a href="#Splitting_the_input_data_into_lines">Splitting the input data into lines</a></td></tr>
                                                                    <tr class="toc-level-2"><td class="toc-number">15.4</td><td class="toc-text"><a href="#Proc::Async_and_print">Proc::Async and <code class="pod-code-inline">print</code></a></td></tr>
                                                           <tr class="toc-level-2"><td class="toc-number">15.5</td><td class="toc-text"><a href="#Using_.stdout_without_.lines">Using <code class="pod-code-inline">.stdout</code> without <code class="pod-code-inline">.lines</code></a></td></tr>
                                                              <tr class="toc-level-1"><td class="toc-number">16</td><td class="toc-text"><a href="#Exception_handling">Exception handling</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">16.1</td><td class="toc-text"><a href="#Sunk_Proc">Sunk <code class="pod-code-inline">Proc</code></a></td></tr>
                                          <tr class="toc-level-1"><td class="toc-number">17</td><td class="toc-text"><a href="#Using_shortcuts">Using shortcuts</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">17.1</td><td class="toc-text"><a href="#The_^_twigil">The ^ twigil</a></td></tr>
                                      <tr class="toc-level-2"><td class="toc-number">17.2</td><td class="toc-text"><a href="#Using_»_and_map_interchangeably">Using <code class="pod-code-inline">»</code> and <code class="pod-code-inline">map</code> interchangeably</a></td></tr>
                                    <tr class="toc-level-2"><td class="toc-number">17.3</td><td class="toc-text"><a href="#Word_splitting_in_«_»">Word splitting in <code class="pod-code-inline">« »</code></a></td></tr>
              <tr class="toc-level-1"><td class="toc-number">18</td><td class="toc-text"><a href="#Scope">Scope</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">18.1</td><td class="toc-text"><a href="#Using_a_once_block">Using a <code class="pod-code-inline">once</code> block</a></td></tr>
                                                                                                                              <tr class="toc-level-2"><td class="toc-number">18.2</td><td class="toc-text"><a href="#LEAVE_phaser_and_exit"><code class="pod-code-inline">LEAVE</code> phaser and <code class="pod-code-inline">exit</code></a></td></tr>
                                                <tr class="toc-level-2"><td class="toc-number">18.3</td><td class="toc-text"><a href="#LEAVE_phaser_may_run_sooner_than_you_think"><code class="pod-code-inline">LEAVE</code> phaser may run sooner than you think</a></td></tr>
                                                         <tr class="toc-level-1"><td class="toc-number">19</td><td class="toc-text"><a href="#Grammars">Grammars</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">19.1</td><td class="toc-text"><a href="#Using_regexes_within_grammar's_actions">Using regexes within grammar&#39;s actions</a></td></tr>
                             <tr class="toc-level-2"><td class="toc-number">19.2</td><td class="toc-text"><a href="#Using_certain_names_for_rules/token/regexes">Using certain names for rules/token/regexes</a></td></tr>
                                          <tr class="toc-level-1"><td class="toc-number">20</td><td class="toc-text"><a href="#Unfortunate_generalization">Unfortunate generalization</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">20.1</td><td class="toc-text"><a href="#:exists_with_more_than_one_key"><code class="pod-code-inline">:exists</code> with more than one key</a></td></tr>
                                          <tr class="toc-level-2"><td class="toc-number">20.2</td><td class="toc-text"><a href="#Using_[…]_metaoperator_with_a_list_of_lists">Using <code class="pod-code-inline">[…]</code> metaoperator with a list of lists</a></td></tr>
                      <tr class="toc-level-2"><td class="toc-number">20.3</td><td class="toc-text"><a href="#Using_[~]_for_concatenating_a_list_of_blobs">Using [~] for concatenating a list of blobs</a></td></tr>
                                                          <tr class="toc-level-1"><td class="toc-number">21</td><td class="toc-text"><a href="#Maps">Maps</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">21.1</td><td class="toc-text"><a href="#Beware_of_nesting_Maps_in_sink_context">Beware of nesting <code class="pod-code-inline">Map</code> s in sink context</a></td></tr>
                                            <tr class="toc-level-1"><td class="toc-number">22</td><td class="toc-text"><a href="#Smartmatching">Smartmatching</a></td></tr>
      <tr class="toc-level-2"><td class="toc-number">22.1</td><td class="toc-text"><a href="#Smartmatch_and_WhateverCode">Smartmatch and <code class="pod-code-inline">WhateverCode</code></a></td></tr>
                              
</table>
</nav>

    <div class="pod-body">
    <p>When learning a programming language, possibly with the background of being familiar with another programming language, there are always some things that can surprise you and might cost valuable time in debugging and discovery.</p>
<p>This document aims to show common misconceptions in order to avoid them.</p>
<p>During the making of Perl&nbsp;6 great pains were taken to get rid of warts in the syntax. When you whack one wart, though, sometimes another pops up. So a lot of time was spent finding the minimum number of warts or trying to put them where they would rarely be seen. Because of this, Perl&nbsp;6&#39;s warts are in different places than you may expect them to be when coming from another language.</p>
<h1 id="Variables_and_constants"><a class="u" href="#___top" title="go to top of document">Variables and constants</a></h1>
<h2 id="Constants_are_computed_at_compile_time"><a class="u" href="#___top" title="go to top of document">Constants are computed at compile time</a></h2>
<p>Constants are computed at compile time, so if you use them in modules keep in mind that their values will be frozen due to precompilation of the module itself:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG&nbsp;(most&nbsp;likely):</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>unit</span></span><span>&nbsp;</span><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>module</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Something::Or::Other</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>constant</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>config-file</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>config.txt</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>slurp</span></span><span>;</span></span></div></pre><p>The <code>$config-file</code> will be slurped during precompilation and changes to <code>config.txt</code> file won&#39;t be re-loaded when you start the script again; only when the module is re-compiled.</p>
<p>Avoid <a href="/language/containers">using a container</a> and prefer <a href="/language/containers#Binding">binding a value</a> to a variable that offers a behavior similar to a constant, but allowing the value to get updated:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Good;&nbsp;file&nbsp;gets&nbsp;updated&nbsp;from&nbsp;&#39;config.txt&#39;&nbsp;file&nbsp;on&nbsp;each&nbsp;script&nbsp;run:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>unit</span></span><span>&nbsp;</span><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>module</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Something::Or::Other</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>config-file</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>config.txt</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>slurp</span></span><span>;</span></span></div></pre><h2 id="Assigning_to_Nil_produces_a_different_value,_usually_Any"><a class="u" href="#___top" title="go to top of document">Assigning to <code>Nil</code> produces a different value, usually <code>Any</code></a></h2>
<p>Actually, assigning to <code>Nil</code> <a href="/type/Nil">reverts the variable to its default value</a>. So:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>8</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>15</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>16</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>2</span></span><span>]&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[4&nbsp;8&nbsp;(Any)&nbsp;16]␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this case, <code>Any</code> is the default value of an <code>Array</code> element.</p>
<p>You can purposefully assign <code>Nil</code> as a default value:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>default</span></span><span>(</span><span class="support type perl6fe"><span>Nil</span></span><span>)&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>a&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Hash&nbsp;%h&nbsp;=&nbsp;{:a(Nil)}␤»</span><span>&nbsp;</span></span></span></div></pre><p>Or bind a value to <code>Nil</code> if that is the result you want:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>3</span></span><span>]&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[4&nbsp;8&nbsp;(Any)&nbsp;Nil]␤»</span><span>&nbsp;</span></span></span></div></pre><p>This trap might be hidden in the result of functions, such as matches:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>result2</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>abcdef</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;dex&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Result2&nbsp;is&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>result2</span></span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>name</span></span><span>&nbsp;</span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Result2&nbsp;is&nbsp;Any␤»</span><span>&nbsp;</span></span></span></div></pre><p>A <a href="/language/regexes#Literals"><code>Match</code> will be <code>Nil</code></a> if it finds nothing; however it assigning <code>Nil</code> to <code>$result2</code> above will result in its default value, which is <code>Any</code> as shown.</p>
<h2 id="Using_a_block_to_interpolate_anon_state_vars"><a class="u" href="#___top" title="go to top of document">Using a block to interpolate anon state vars</a></h2>
<p>The programmer intended for the code to count the number of times the routine is called, but the counter is not increasing:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>count-it</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Count&nbsp;is&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span>$</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;0</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;0</span><span>&nbsp;</span></span></span></div></pre><p>When it comes to state variables, the block in which the vars are declared gets cloned —and vars get initialized anew— whenever that block&#39;s block is re-entered. This lets constructs like the one below behave appropriately; the state variable inside the loop gets initialized anew each time the sub is called:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>count-it</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>3</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>state</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>count</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Count&nbsp;is&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>count</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>count</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>…and&nbsp;again…</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;0</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;1</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;2</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;…and&nbsp;again…</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;0</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;1</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;2</span><span>&nbsp;</span></span></span></div></pre><p>The same layout exists in our buggy program. The <code>{ }</code> inside a double-quoted string isn&#39;t merely an interpolation to execute a piece of code. It&#39;s actually its own block, which is just as in the example above gets cloned each time the sub is entered, re-initializing our state variable. To get the right count, we need to get rid of that inner block, using a scalar contextualizer to interpolate our piece of code instead:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>count-it</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Count&nbsp;is&nbsp;$($++)</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>count-it</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;0</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Count&nbsp;is&nbsp;1</span><span>&nbsp;</span></span></span></div></pre><p>Alternatively, you can also use the <a href="/routine/~">concatenation operator</a> instead:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>count-it</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Count&nbsp;is&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>&nbsp;$</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h2 id="Using_set_subroutines_on_Associative_when_the_value_is_falsy"><a class="u" href="#___top" title="go to top of document">Using set subroutines on <code>Associative</code> when the value is falsy</a></h2>
<p>Using <a href="/routine/(cont) , infix  ∋">(cont)</a>, <a href="/routine/(cont), infix ∋">∋</a>, <a href="/routine/∌">∌</a>, <a href="/routine/(elem), infix ∈">(elem)</a>, <a href="/routine/(elem), infix ∈">∈</a>, or <a href="/routine/∉">∉</a> on classes implementing <a href="/type/Associative">Associative</a> will return <code>False</code> if the value of the key is falsy:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>enum</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>a</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>b</span></span><span>»;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Foo</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>enums</span></span><span>&nbsp;</span><span class="keyword operator setbagmix perl6fe"><span>∋</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>a</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;False</span><span>&nbsp;</span></span></span></div></pre><p>Instead, use <code>:exists</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>enum</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Foo</span></span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>a</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>b</span></span><span>»;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Foo</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>enums</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div></pre><h1 id="Blocks"><a class="u" href="#___top" title="go to top of document">Blocks</a></h1>
<h2 id="Beware_of_empty_&quot;blocks&quot;"><a class="u" href="#___top" title="go to top of document">Beware of empty &quot;blocks&quot;</a></h2>
<p>Curly braces are used to declare blocks. However, empty curly braces will declare a hash.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword other special-method perl6fe"><span>$</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Block</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword other special-method perl6fe"><span>$</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Block</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword other special-method perl6fe"><span>$</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>…</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Block</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword other special-method perl6fe"><span>$</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Hash</span><span>&nbsp;</span></span></span></div></pre><p>You can use the second form if you effectively want to declare an empty block:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>does-nothing</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>does-nothing</span></span><span>(</span><span class="constant numeric perl6fe"><span>33</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Nil␤»</span></span></span></div></pre><h1 id="Objects"><a class="u" href="#___top" title="go to top of document">Objects</a></h1>
<h2 id="Assigning_to_attributes"><a class="u" href="#___top" title="go to top of document">Assigning to attributes</a></h2>
<p>Newcomers often think that, because attributes with accessors are declared as <code>has $.x</code>, they can assign to <code>$.x</code> inside the class. That&#39;s not the case.</p>
<p>For example</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Point</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>double</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>*=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG</span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>*=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG</span><span>&nbsp;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Point</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(</span><span class="keyword operator word perl6fe"><span>x</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>y&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>-2</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>double</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword operator word perl6fe"><span>x</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Cannot&nbsp;assign&nbsp;to&nbsp;an&nbsp;immutable&nbsp;value␤»</span><span>&nbsp;</span></span></span></div></pre><p>the first line inside the method <code>double</code> is marked with <code># WRONG</code> because <code>$.x</code>, short for <code>$( self.x )</code>, is a call to a read-only accessor.</p>
<p>The syntax <code>has $.x</code> is short for something like <code>has $!x; method x() { $!x }</code>, so the actual attribute is called <code>$!x</code>, and a read-only accessor method is automatically generated.</p>
<p>Thus the correct way to write the method <code>double</code> is</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>double</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>*=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>*=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>which operates on the attributes directly.</p>
<h2 id="BUILD_prevents_automatic_attribute_initialization_from_constructor_arguments"><a class="u" href="#___top" title="go to top of document"><code>BUILD</code> prevents automatic attribute initialization from constructor arguments</a></h2>
<p>When you define your own <code>BUILD</code> submethod, you must take care of initializing all attributes by yourself. For example</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>A</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>has</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>.</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>submethod</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>BUILD</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>18</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>A</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(</span><span class="keyword operator word perl6fe"><span>x</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="keyword operator word perl6fe"><span>x</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Any␤»</span><span>&nbsp;</span></span></span></div></pre><p>leaves <code>$!x</code> uninitialized, because the custom <code>BUILD</code> doesn&#39;t initialize it.</p>
<p><strong>Note:</strong> Consider using <a href="/language/objects#index-entry-TWEAK">TWEAK</a> instead. <a href="/language/glossary#Rakudo">Rakudo</a> supports <a href="/language/objects#index-entry-TWEAK">TWEAK</a> method since release 2016.11.</p>
<p>One possible remedy is to explicitly initialize the attribute in <code>BUILD</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>submethod</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>BUILD</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>18</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>which can be shortened to:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>submethod</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>BUILD</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>!</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>18</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h1 id="Whitespace"><a class="u" href="#___top" title="go to top of document">Whitespace</a></h1>
<h2 id="Whitespace_in_regexes_does_not_match_literally"><a class="u" href="#___top" title="go to top of document">Whitespace in regexes does not match literally</a></h2>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>a&nbsp;b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>a&nbsp;b</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div></pre><p>Whitespace in regexes is, by default, considered an optional filler without semantics, just like in the rest of the Perl&nbsp;6 language.</p>
<p>Ways to match whitespace:</p>
<ul><li><p><code>\s</code> to match any one whitespace, <code>\s+</code> to match at least one</p>
</li>
<li><p><code>&#39; &#39;</code> (a blank in quotes) to match a single blank</p>
</li>
<li><p><code>\t</code>, <code>\n</code> for specific whitespace (tab, newline)</p>
</li>
<li><p><code>\h</code>, <code>\v</code> for horizontal, vertical whitespace</p>
</li>
<li><p><code>.ws</code>, a built-in rule for whitespace that oftentimes does what you actually want it to do</p>
</li>
<li><p>with <code>m:s/a b/</code> or <code>m:sigspace/a b/</code>, the blank in the regexes matches arbitrary whitespace</p>
</li>
</ul>
<h2 id="Ambiguities_in_parsing"><a class="u" href="#___top" title="go to top of document">Ambiguities in parsing</a></h2>
<p>While some languages will let you get away with removing as much whitespace between tokens as possible, Perl&nbsp;6 is less forgiving. The overarching mantra is we discourage code golf, so don&#39;t scrimp on whitespace (the more serious underlying reason behind these restrictions is single-pass parsing and ability to parse Perl&nbsp;6 programs with virtually no <a href="https://en.wikipedia.org/wiki/Backtracking">backtracking</a>).</p>
<p>The common areas you should watch out for are:</p>
<h3 id="Block_vs._Hash_slice_ambiguity"><a class="u" href="#___top" title="go to top of document">Block vs. Hash slice ambiguity</a></h3>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;trying&nbsp;to&nbsp;hash-slice&nbsp;a&nbsp;Bool:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>while</span></span><span>&nbsp;($</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span><span>)</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>while</span></span><span>&nbsp;($</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;EVEN&nbsp;BETTER;&nbsp;Perl 6&nbsp;does&nbsp;not&nbsp;require&nbsp;parentheses&nbsp;there:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>while</span></span><span>&nbsp;$</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h3 id="Reduction_vs._Array_constructor_ambiguity"><a class="u" href="#___top" title="go to top of document">Reduction vs. Array constructor ambiguity</a></h3>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;ambiguity&nbsp;with&nbsp;`[&lt;]`&nbsp;metaop:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;[[</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>],];</span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT;&nbsp;reductions&nbsp;cannot&nbsp;have&nbsp;spaces&nbsp;in&nbsp;them,&nbsp;so&nbsp;put&nbsp;one&nbsp;in:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;[[</span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>],];</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;No&nbsp;ambiguity&nbsp;here,&nbsp;natural&nbsp;spaces&nbsp;between&nbsp;items&nbsp;suffice&nbsp;to&nbsp;resolve&nbsp;it:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;[[</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo&nbsp;bar&nbsp;ber</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>],];</span></span></div></pre><h3 id="Less_than_vs._Word_quoting/Associative_indexing"><a class="u" href="#___top" title="go to top of document">Less than vs. Word quoting/Associative indexing</a></h3>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;trying&nbsp;to&nbsp;index&nbsp;3&nbsp;associatively:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>5</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>4</span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT;&nbsp;prefer&nbsp;some&nbsp;extra&nbsp;whitespace&nbsp;around&nbsp;infix&nbsp;operators:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>&nbsp;5&nbsp;</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span></span></div></pre><h3 id="Exclusive_sequences_vs._sequences_with_Ranges"><a class="u" href="#___top" title="go to top of document">Exclusive sequences vs. sequences with Ranges</a></h3>
<p>See the section on <a href="#Exclusive_sequence_operator">operator traps</a> for more information about how the <code>...^</code> operator can be mistaken for the <code>...</code> operator with a <code>^</code> operator immediately following it. You must use whitespace correctly to indicate which interpretation will be followed.</p>
<h1 id="Captures"><a class="u" href="#___top" title="go to top of document">Captures</a></h1>
<h2 id="Containers_versus_values_in_a_capture"><a class="u" href="#___top" title="go to top of document">Containers versus values in a capture</a></h2>
<p>Beginners might expect a variable in a <code>Capture</code> to supply its current value when that <code>Capture</code> is later used. For example:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«3,3␤»</span><span>&nbsp;</span></span></span></div></pre><p>Here the <code>Capture</code> contained the <strong>container</strong> pointed to by <code>$a</code> and the <strong>value</strong> of the result of the expression <code>++$a</code>. Since the <code>Capture</code> must be reified before <code>&amp;say</code> can use it, the <code>++$a</code> may happen before <code>&amp;say</code> looks inside the container in <code>$a</code> (and before the <code>List</code> is created with the two terms) and so it may already be incremented.</p>
<p>Instead, use an expression that produces a value when you want a value.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;(</span><span class="keyword operator generic perl6fe"><span>+</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«2,3␤»</span><span>&nbsp;</span></span></span></div></pre><p>Or even simpler</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>a</span></span><span>,&nbsp;</span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«2,&nbsp;3␤»</span><span>&nbsp;</span></span></span></div></pre><p>The same happens in this case:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,</span><span class="constant numeric perl6fe"><span>1</span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>5</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>+</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>push</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div></pre><p>Outputs <code>«[(1 2)]␤[(2 3) (2 3)]␤[(3 5) (3 5) (3 5)]␤...</code>. <code>$a</code> and <code>$b</code> are not reified until <code>say</code> is called, the value that they have in that precise moment is the one printed. To avoid that, decontainerize values or take them out of the variable in some way before using them.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,</span><span class="constant numeric perl6fe"><span>1</span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>5</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>+</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>push</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>item</span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>item</span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>arr</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div></pre><p>With <a href="/routine/item">item</a>, the container will be evaluated in item context, its value extracted, and the desired outcome achieved.</p>
<h1 id="Cool_tricks"><a class="u" href="#___top" title="go to top of document"><code>Cool</code> tricks</a></h1>
<p>Perl&nbsp;6 includes a <a href="/type/Cool">Cool</a> class, which provides some of the DWIM behaviors we got used to by coercing arguments when necessary. However, DWIM is never perfect. Especially with <a href="/type/List">List</a>s, which are <code>Cool</code>, there are many methods that will not do what you probably think they do, including <code>contains</code>, <code>starts-with</code> or <code>index</code>. Please see some examples in the section below.</p>
<h2 id="Strings_are_not_Lists,_so_beware_indexing"><a class="u" href="#___top" title="go to top of document">Strings are not <code>List</code>s, so beware indexing</a></h2>
<p>In Perl&nbsp;6, <a href="/type/Str">strings</a> are not lists of characters. One <a href="#Strings_are_not_iterable">cannot iterate</a> over them or index into them as you can with <a href="/type/List">lists</a>, despite the name of the <a href="/type/Str#routine_index">.index routine</a>.</p>
<h2 id="Lists_become_strings,_so_beware_.index()ing"><a class="u" href="#___top" title="go to top of document"><code>List</code>s become strings, so beware <code>.index()</code>ing</a></h2>
<p><a href="/type/List">List</a> inherits from <a href="/type/Cool">Cool</a>, which provides access to <a href="/type/Str#routine_index">.index</a>. Because of the way <code>.index</code> <a href="/type/List#method_Str">coerces</a> a <code>List</code> into a <a href="/type/Str">Str</a>, this can sometimes appear to be returning the index of an element in the list, but that is not how the behavior is defined.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c&nbsp;d</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>index</span></span><span>(</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>a</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;0</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>index</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>c</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;4&nbsp;--&nbsp;not&nbsp;2!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>index</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>b&nbsp;c</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;2&nbsp;--&nbsp;not&nbsp;undefined!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>index</span></span><span>(</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;0&nbsp;--&nbsp;not&nbsp;undefined!</span><span>&nbsp;</span></span></span></div></pre><p>These same caveats apply to <a href="/type/Str#routine_rindex">.rindex</a>.</p>
<h2 id="Lists_become_strings,_so_beware_.contains()"><a class="u" href="#___top" title="go to top of document"><code>List</code>s become strings, so beware <code>.contains()</code></a></h2>
<p>Similarly, <a href="/type/List#(Cool)_method_contains">.contains</a> does not look for elements in the list.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>hamburger&nbsp;fries&nbsp;milkshake</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>hamburger</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>hot&nbsp;dog</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>milk</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>er&nbsp;fr</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>es&nbsp;mi</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True!</span><span>&nbsp;</span></span></span></div></pre><p>If you actually want to check for the presence of an element, use the <a href="/routine/(elem), infix ∈">(cont)</a> operator for single elements, and the <a href="/language/operators#infix_(<=), _infix_⊆">superset</a> and <a href="/language/operators#infix_(">strict superset</a>), _infix_⊃&gt; operators for multiple elements.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>hamburger&nbsp;fries&nbsp;milkshake</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="keyword operator setbagmix perl6fe"><span>(cont)</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>fries</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="keyword operator setbagmix perl6fe"><span>(cont)</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>milk</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="keyword operator setbagmix perl6fe"><span>(&gt;)</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>hamburger&nbsp;fries</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>menu</span></span></span><span>&nbsp;</span><span class="keyword operator setbagmix perl6fe"><span>(&gt;)</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>milkshake&nbsp;fries</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True&nbsp;(!&nbsp;NB:&nbsp;order&nbsp;doesn&#39;t&nbsp;matter)</span><span>&nbsp;</span></span></span></div></pre><p>If you are doing a lot of element testing, you may be better off using a <a href="/type/Set">Set</a>.</p>
<h2 id="Numeric_literals_are_parsed_before_coercion"><a class="u" href="#___top" title="go to top of document"><code>Numeric</code> literals are parsed before coercion</a></h2>
<p>Experienced programmers will probably not be surprised by this, but Numeric literals will be parsed into their numeric value before being coerced into a string, which may create nonintuitive results.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric radix perl6fe"><span>0xff</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="constant numeric perl6fe"><span>55</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric radix perl6fe"><span>0xff</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="constant numeric radix perl6fe"><span>0xf</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>12_345</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>23</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>12_345</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>contains</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2_</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;False</span><span>&nbsp;</span></span></span></div></pre><h2 id="Getting_a_random_item_from_a_List"><a class="u" href="#___top" title="go to top of document">Getting a random item from a <code>List</code></a></h2>
<p>A common task is to retrieve one or more random elements from a collection, but <code>List.rand</code> isn&#39;t the way to do that. <a href="/type/Cool">Cool</a> provides <a href="/routine/rand#class_Cool">rand</a>, but that first coerces the <code>List</code> into the number of items in the list, and returns a random real number between 0 and that value. To get random elements, see <a href="/routine/pick">pick</a> and <a href="/routine/roll">roll</a>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>red&nbsp;orange&nbsp;yellow&nbsp;green&nbsp;blue&nbsp;indigo&nbsp;violet</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;2.21921955680514</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>pick</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;orange</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>roll</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;blue</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>pick</span></span><span>(</span><span class="constant numeric perl6fe"><span>2</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;yellow&nbsp;violet&nbsp;&nbsp;(cannot&nbsp;repeat)</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>colors</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>roll</span></span><span>(</span><span class="constant numeric perl6fe"><span>3</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;red&nbsp;green&nbsp;red&nbsp;&nbsp;(can&nbsp;repeat)</span><span>&nbsp;</span></span></span></div></pre><h2 id="Lists_numify_to_their_number_of_elements_in_numeric_context"><a class="u" href="#___top" title="go to top of document"><code>List</code>s numify to their number of elements in numeric context</a></h2>
<p>You want to check whether a number is divisible by any of a set of numbers:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>%%</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>11&nbsp;33&nbsp;88&nbsp;55&nbsp;111&nbsp;20325</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span></span></span></div></pre><p>What? There&#39;s no single number 42 should be divisible by. However, that list has 6 elements, and 42 is divisible by 6. That&#39;s why the output is true. In this case, you should turn the <code>List</code> into a <a href="/type/Junction">Junction</a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>%%</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>11&nbsp;33&nbsp;88&nbsp;55&nbsp;111&nbsp;20325</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>any</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«any(False,&nbsp;False,&nbsp;False,&nbsp;False,&nbsp;False,&nbsp;False)␤»</span><span>&nbsp;</span></span></span></div></pre><p>which will clearly reveal the falsehood of the divisiveness of all the numbers in the list, which will be numified separately.</p>
<h1 id="Arrays"><a class="u" href="#___top" title="go to top of document">Arrays</a></h1>
<h2 id="Referencing_the_last_element_of_an_array"><a class="u" href="#___top" title="go to top of document">Referencing the last element of an array</a></h2>
<p>In some languages one could reference the last element of an array by asking for the &quot;-1th&quot; element of the array, e.g.:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted q operator perl6fe"><span>qw</span></span><span class="punctuation definition string perl6fe"><span>{</span></span><span class="string quoted q brace quote perl6fe"><span>victor&nbsp;alice&nbsp;bob&nbsp;charlie&nbsp;eve</span></span><span class="punctuation definition string perl6fe"><span>}</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>-1</span></span><span>];&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«eve␤»</span><span>&nbsp;</span></span></span></div></pre><p>In Perl&nbsp;6 it is not possible to use negative subscripts, however the same is achieved by actually using a function, namely <code>*-1</code>. Thus, accessing the last element of an array becomes:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted q operator perl6fe"><span>qw</span></span><span class="punctuation definition string perl6fe"><span>{</span></span><span class="string quoted q brace quote perl6fe"><span>victor&nbsp;alice&nbsp;bob&nbsp;charlie&nbsp;eve</span></span><span class="punctuation definition string perl6fe"><span>}</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>[</span><span class="meta subscript whatever perl6fe"><span class="constant language whatever perl6fe"><span>*</span></span><span class="keyword operator minus back-from perl6fe"><span>-</span></span><span class="constant numeric back-from perl6fe"><span>1</span></span></span><span>];&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«eve␤»</span><span>&nbsp;</span></span></span></div></pre><p>Yet another way is to utilize the array&#39;s tail method:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted q operator perl6fe"><span>qw</span></span><span class="punctuation definition string perl6fe"><span>{</span></span><span class="string quoted q brace quote perl6fe"><span>victor&nbsp;alice&nbsp;bob&nbsp;charlie&nbsp;eve</span></span><span class="punctuation definition string perl6fe"><span>}</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>tail</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«eve␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>tail</span></span><span>(</span><span class="constant numeric perl6fe"><span>2</span></span><span>);&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(charlie&nbsp;eve)␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Typed_array_parameters"><a class="u" href="#___top" title="go to top of document">Typed array parameters</a></h2>
<p>Quite often new users will happen to write something like:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="support type perl6fe"><span>Array</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>...before they have gotten far enough in the documentation to realize that this is asking for an Array of Arrays. To say that <code>@a</code> should only accept Arrays, use instead:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>where</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Array</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>It is also common to expect this to work, when it does not:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>bar</span></span><span>(</span><span class="support type perl6fe"><span>Int</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>bar</span></span><span>([</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>]);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;expected&nbsp;Positional[Int]&nbsp;but&nbsp;got&nbsp;Array</span><span>&nbsp;</span></span></span></div></pre><p>The problem here is that [1, 2, 3] is not an <code>Array[Int]</code>, it is a plain old Array that just happens to have Ints in it. To get it to work, the argument must also be an <code>Array[Int]</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Int</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>bar</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«42␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>bar</span></span><span>(</span><span class="support type perl6fe"><span>Array</span></span><span>[</span><span class="support type perl6fe"><span>Int</span></span><span>]</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>));</span></span></div></pre><p>This may seem inconvenient, but on the upside it moves the type-check on what is assigned to <code>@b</code> to where the assignment happens, rather than requiring every element to be checked on every call.</p>
<h2 id="Using_«»_quoting_when_you_don't_need_it"><a class="u" href="#___top" title="go to top of document">Using <code>«»</code> quoting when you don&#39;t need it</a></h2>
<p>This trap can be seen in different varieties. Here are some of them:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>hello</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>foo&nbsp;bar</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>99</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>«</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>»;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;assumption&nbsp;that&nbsp;$x&nbsp;has&nbsp;no&nbsp;whitespace</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>«</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>»;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;splits&nbsp;‘foo&nbsp;bar’&nbsp;by&nbsp;whitespace</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>«</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>y</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>»;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;KINDA&nbsp;OK;&nbsp;it&nbsp;works&nbsp;but&nbsp;there&nbsp;is&nbsp;no&nbsp;good&nbsp;reason&nbsp;to&nbsp;do&nbsp;that</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT;&nbsp;this&nbsp;is&nbsp;what&nbsp;should&nbsp;be&nbsp;used</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;assumption&nbsp;that&nbsp;only&nbsp;one&nbsp;file&nbsp;will&nbsp;be&nbsp;created</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;will&nbsp;touch&nbsp;file&nbsp;‘foo’&nbsp;and&nbsp;‘bar’</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>y</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;better,&nbsp;but&nbsp;has&nbsp;a&nbsp;different&nbsp;issue&nbsp;if&nbsp;$y&nbsp;starts&nbsp;with&nbsp;-</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>--</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>y</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>»;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;KINDA&nbsp;OK;&nbsp;it&nbsp;works&nbsp;but&nbsp;there&nbsp;is&nbsp;no&nbsp;good&nbsp;enough&nbsp;reason&nbsp;to&nbsp;do&nbsp;that</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>touch</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>--</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT;&nbsp;explicit&nbsp;and&nbsp;*always*&nbsp;correct</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>touch&nbsp;--</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>y</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT;&nbsp;&lt;&nbsp;&gt;&nbsp;are&nbsp;OK,&nbsp;this&nbsp;is&nbsp;short&nbsp;and&nbsp;correct</span><span>&nbsp;</span></span></span></div></pre><p>Basically, <code>«»</code> quoting is only safe to use if you remember to <em>always</em> quote your variables. The problem is that it inverts the default behavior to unsafe variant, so just by forgetting some quotes you are risking to introduce either a bug or maybe even a security hole. To stay on the safe side, refrain from using <code>«»</code>.</p>
<h1 id="Strings"><a class="u" href="#___top" title="go to top of document">Strings</a></h1>
<p>Some problems that might arise when dealing with <a href="/type/Str">strings</a>.</p>
<h2 id="Quotes_and_interpolation"><a class="u" href="#___top" title="go to top of document">Quotes and interpolation</a></h2>
<p>Interpolation in string literals can be too clever for your own good.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;HTML&nbsp;tags&quot;&nbsp;interpreted&nbsp;as&nbsp;associative&nbsp;indexing:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>foo</span></span><span>&lt;html&gt;&lt;/html&gt;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>eq</span></span></span></div><div class="line"><span class="source perl6fe"><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>foo</span></span><span class="meta interpolation perl6fe"><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>html</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="punctuation section embedded end perl6fe"><span>}</span></span><span class="punctuation section embedded begin perl6fe"><span>{</span></span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>/html</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="punctuation section embedded end perl6fe"><span>}</span></span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Parentheses&nbsp;interpreted&nbsp;as&nbsp;call&nbsp;with&nbsp;argument:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>foo</span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>&nbsp;~&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span>args</span></span><span>&nbsp;~&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>)</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>eq</span></span></span></div><div class="line"><span class="source perl6fe"><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>foo</span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>&nbsp;~&nbsp;@args&nbsp;~&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>)</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span></span></div></pre><p>You can avoid those problems using non-interpolating single quotes and switching to more liberal interpolation with <code>\qq[]</code> escape sequence:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>\qq[$a]()$b()</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1()$b()␤»</span><span>&nbsp;</span></span></span></div></pre><p>Another alternative is to use <code>Q:c</code> quoter, and use code blocks <code>{}</code> for all interpolation:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted q operator perl6fe"><span>Q</span></span><span class="support function quote adverb perl6fe"><span>:c</span></span><span class="punctuation definition string perl6fe"><span>«</span></span><span class="string quoted q chevron quote perl6fe"><span>{$a}()$b()</span></span><span class="punctuation definition string perl6fe"><span>»</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1()$b()␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Strings_are_not_iterable"><a class="u" href="#___top" title="go to top of document">Strings are not iterable</a></h2>
<p>There are methods that <a href="/type/Str">Str</a> inherits from <a href="/type/Any">Any</a> that work on iterables like lists. Iterators on strings contain one element that is the whole string. To use list-based methods like <code>sort</code>, <code>reverse</code>, you need to convert the string into a list first.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>cba</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(cba)␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>cba</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>comb</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>join</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«abc␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id=".chars_gets_the_number_of_graphemes,_not_Codepoints"><a class="u" href="#___top" title="go to top of document"><code>.chars</code> gets the number of graphemes, not Codepoints</a></h2>
<p>In Perl&nbsp;6, <a href="/routine/chars"><code>.chars</code></a> returns the number of graphemes, or user visible characters. These graphemes could be made up of a letter plus an accent for example. If you need the number of codepoints, you should use <a href="/routine/codes"><code>.codes</code></a>. If you need the number of bytes when encoded as UTF8, you should use <code>.encode.bytes</code> to encode the string as UTF8 and then get the number of bytes.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>\c[LATIN&nbsp;SMALL&nbsp;LETTER&nbsp;J&nbsp;WITH&nbsp;CARON,&nbsp;COMBINING&nbsp;DOT&nbsp;BELOW]</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«ǰ̣»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ǰ̣</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>codes</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«2»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ǰ̣</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>chars</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ǰ̣</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>encode</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>bytes</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«4»</span></span></span></div></pre><p>For more information on how strings work in Perl&nbsp;6, see the <a href="/language/unicode">Unicode page</a>.</p>
<h2 id="All_text_is_normalized_by_default"><a class="u" href="#___top" title="go to top of document">All text is normalized by default</a></h2>
<p>Perl&nbsp;6 normalizes all text into Unicode NFC form (Normalization Form Canonical). Filenames are the only text not normalized by default. If you are expecting your strings to maintain a byte for byte representation as the original, you need to use <a href="/language/unicode#UTF8-C8"><code>UTF8-C8</code></a> when reading or writing to any filehandles.</p>
<h2 id="Allomorphs_generally_follow_numeric_semantics"><a class="u" href="#___top" title="go to top of document">Allomorphs generally follow numeric semantics</a></h2>
<p><a href="/type/Str">Str</a> <code>&quot;0&quot;</code> is <code>True</code>, while <a href="/type/Numeric">Numeric</a> is <code>False</code>. So what&#39;s the <a href="/type/Bool">Bool</a> value of <a href="/language/glossary#index-entry-Allomorph">allomorph</a> <code>&lt;0&gt;</code>?</p>
<p>In general, allomorphs follow <a href="/type/Numeric">Numeric</a> semantics, so the ones that <em>numerically</em> evaluate to zero are <code>False</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0e0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0.0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«False␤»</span></span></span></div></pre><p>To force comparison being done for the <a href="/type/Stringy">Stringy</a> part of the allomorph, use <a href="/routine/~">prefix <code>~</code> operator</a> or the <a href="/type/Str">Str</a> method to coerce the allomorph to <a href="/type/Str">Str</a>, or use the <a href="/routine/chars">chars</a> routine to test whether the allomorph has any length:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Str</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>so</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>chars</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>0</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span></span></span></div></pre><h2 id="Case-insensitive_comparison_of_strings"><a class="u" href="#___top" title="go to top of document">Case-insensitive comparison of strings</a></h2>
<p>In order to do case-insensitive comparison, you can use <code>.fc</code> (fold-case). The problem is that people tend to use <code>.lc</code> or <code>.uc</code>, and it does seem to work within the ASCII range, but fails on other characters. This is not just a Perl&nbsp;6 trap, the same applies to other languages.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>groß</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lc</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>eq</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>GROSS</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lc</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>groß</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>uc</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>eq</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>GROSS</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>uc</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;True,&nbsp;but&nbsp;that&#39;s&nbsp;just&nbsp;luck</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>groß</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>fc</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>eq</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>GROSS</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>fc</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT;&nbsp;True</span><span>&nbsp;</span></span></span></div></pre><p>If you are working with regexes, then there is no need to use <code>.fc</code> and you can use <code>:i</code> (<code>:ignorecase</code>) adverb instead.</p>
<h1 id="Pairs"><a class="u" href="#___top" title="go to top of document">Pairs</a></h1>
<h2 id="Constants_on_the_left-hand_side_of_pair_notation"><a class="u" href="#___top" title="go to top of document">Constants on the left-hand side of pair notation</a></h2>
<p>Consider this code:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>enum</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Animals</span></span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>Dog&nbsp;Cat</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>Dog&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="routine name perl6fe"><span>Dog</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(Any)␤»</span><span>&nbsp;</span></span></span></div></pre><p>The <code>:{ … }</code> syntax is used to create <a href="/type/Hash#Non-string_keys_(object_hash)">object hashes</a>. The intentions of someone who wrote that code were to create a hash with Enum objects as keys (and <code>say %h{Dog}</code> attempts to get a value using the Enum object to perform the lookup). However, that&#39;s not how pair notation works.</p>
<p>For example, in <code>Dog =&gt; 42</code> the key will be a <code>Str</code>. That is, it doesn&#39;t matter if there is a constant, or an enumeration with the same name. The pair notation will always use the left-hand side as a string literal, as long as it looks like an identifier.</p>
<p>To avoid this, use <code>(Dog) =&gt; 42</code> or <code>::Dog =&gt; 42</code>.</p>
<h2 id="Scalar_values_within_Pair"><a class="u" href="#___top" title="go to top of document">Scalar values within <code>Pair</code></a></h2>
<p>When dealing with <a href="/type/Scalar">Scalar</a> values, the <code>Pair</code> holds the container to the value. This means that it is possible to reflect changes to the <code>Scalar</code> value from outside the <code>Pair</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>v</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>value&nbsp;A</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>pair</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Pair</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>a</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>v</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>pair</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;a&nbsp;=&gt;&nbsp;value&nbsp;A</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>v</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>value&nbsp;B</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>pair</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;a&nbsp;=&gt;&nbsp;value&nbsp;B</span><span>&nbsp;</span></span></span></div></pre><p>Use the method <a href="/type/Pair#method_freeze">freeze</a> to force the removal of the <code>Scalar</code> container from the <code>Pair</code>. For more details see the documentation about <a href="/type/Pair">Pair</a>.</p>
<h1 id="Sets,_bags_and_mixes"><a class="u" href="#___top" title="go to top of document">Sets, bags and mixes</a></h1>
<h2 id="Sets,_bags_and_mixes_do_not_have_a_fixed_order"><a class="u" href="#___top" title="go to top of document">Sets, bags and mixes do not have a fixed order</a></h2>
<p>When iterating over this kind of objects, an order is not defined.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>set</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Set</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>set</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>list</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«a&nbsp;=&gt;&nbsp;True␤c&nbsp;=&gt;&nbsp;True␤b&nbsp;=&gt;&nbsp;True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«a&nbsp;=&gt;&nbsp;True␤c&nbsp;=&gt;&nbsp;True␤b&nbsp;=&gt;&nbsp;True␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«c&nbsp;=&gt;&nbsp;True␤b&nbsp;=&gt;&nbsp;True␤a&nbsp;=&gt;&nbsp;True␤»</span><span>&nbsp;</span></span></span></div></pre><p>Every iteration might (and will) yield a different order, so you cannot trust a particular sequence of the elements of a set. If order does not matter, just use them that way. If it does, use <code>sort</code></p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>set</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Set</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>set</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>list</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«a&nbsp;=&gt;&nbsp;True␤b&nbsp;=&gt;&nbsp;True␤c&nbsp;=&gt;&nbsp;True␤»</span></span></span></div></pre><p>In general, sets, bags and mixes are unordered, so you should not depend on them having a particular order.</p>
<h1 id="Operators"><a class="u" href="#___top" title="go to top of document">Operators</a></h1>
<p>Some operators commonly shared among other languages were repurposed in Perl&nbsp;6 for other, more common, things:</p>
<h2 id="Junctions"><a class="u" href="#___top" title="go to top of document">Junctions</a></h2>
<p>The <code>^</code>, <code>|</code>, and <code>&amp;</code> are <em>not</em> bitwise operators, they create <a href="/type/Junction">Junctions</a>. The corresponding bitwise operators in Perl&nbsp;6 are: <code>+^</code>, <code>+|</code>, <code>+&amp;</code> for integers and <code>?^</code>, <code>?|</code>, <code>?&amp;</code> for booleans.</p>
<h2 id="Exclusive_sequence_operator"><a class="u" href="#___top" title="go to top of document">Exclusive sequence operator</a></h2>
<p>Lavish use of whitespace helps readability, but keep in mind infix operators cannot have any whitespace in them. One such operator is the sequence operator that excludes right point: <code>...^</code> (or its <a href="/language/unicode_ascii">Unicode equivalent</a> <code>…^</code>).</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>5</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(1&nbsp;0&nbsp;1&nbsp;2&nbsp;3&nbsp;4)␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>5</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(1&nbsp;2&nbsp;3&nbsp;4)␤»</span></span></span></div></pre><p>If you place whitespace between the ellipsis (<code>…</code>) and the caret (<code>^</code>), it&#39;s no longer a single infix operator, but an infix inclusive sequence operator (<code>…</code>) and a prefix <a href="/type/Range">Range</a> operator (<code>^</code>). <a href="/type/Iterable">Iterables</a> are valid endpoints for the sequence operator, so the result you&#39;ll get might not be what you expected.</p>
<h2 id="String_ranges/Sequences"><a class="u" href="#___top" title="go to top of document">String ranges/Sequences</a></h2>
<p>In some languages, using strings as range end points, considers the entire string when figuring out what the next string should be; loosely treating the strings as numbers in a large base. Here&#39;s Perl&nbsp;5 version:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>az</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>bc</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«az,&nbsp;ba,&nbsp;bb,&nbsp;bc␤»</span><span>&nbsp;</span></span></span></div></pre><p>Such a range in Perl&nbsp;6 will produce a different result, where <em>each letter</em> will be ranged to a corresponding letter in the end point, producing more complex sequences:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>az</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>bc</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment multiline hash-tick brace perl6fe"><span>#`{</span><span>&nbsp;OUTPUT:&nbsp;«</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment multiline hash-tick brace perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;az,&nbsp;ay,&nbsp;ax,&nbsp;aw,&nbsp;av,&nbsp;au,&nbsp;at,&nbsp;as,&nbsp;ar,&nbsp;aq,&nbsp;ap,&nbsp;ao,&nbsp;an,&nbsp;am,&nbsp;al,&nbsp;ak,&nbsp;aj,&nbsp;ai,&nbsp;ah,</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment multiline hash-tick brace perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;ag,&nbsp;af,&nbsp;ae,&nbsp;ad,&nbsp;ac,&nbsp;bz,&nbsp;by,&nbsp;bx,&nbsp;bw,&nbsp;bv,&nbsp;bu,&nbsp;bt,&nbsp;bs,&nbsp;br,&nbsp;bq,&nbsp;bp,&nbsp;bo,&nbsp;bn,&nbsp;bm,</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment multiline hash-tick brace perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;bl,&nbsp;bk,&nbsp;bj,&nbsp;bi,&nbsp;bh,&nbsp;bg,&nbsp;bf,&nbsp;be,&nbsp;bd,&nbsp;bc</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment multiline hash-tick brace perl6fe"><span>␤»</span><span>}</span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>r2</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>t3</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«r2,&nbsp;r3,&nbsp;s2,&nbsp;s3,&nbsp;t2,&nbsp;t3␤»</span><span>&nbsp;</span></span></span></div></pre><p>To achieve simpler behavior, similar to the Perl&nbsp;5 example above, use a sequence operator that calls <code>.succ</code> method on the starting string:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>join</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>,&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>az</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>succ</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>bc</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«az,&nbsp;ba,&nbsp;bb,&nbsp;bc␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Topicalizing_operators"><a class="u" href="#___top" title="go to top of document">Topicalizing operators</a></h2>
<p>The smartmatch operator <code>~~</code> and <code>andthen</code> set the topic <code>$_</code> to their left-hand-side. In conjunction with implicit method calls on the topic this can lead to surprising results.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>note</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>object</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«object␤object␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>topic</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«topic␤True␤»</span><span>&nbsp;</span></span></span></div></pre><p>In many cases flipping the method call to the LHS will work.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>note</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>object</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«object␤object␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>method</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>topic</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«object␤False␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Fat_arrow_and_constants"><a class="u" href="#___top" title="go to top of document">Fat arrow and constants</a></h2>
<p>The fat arrow operator <code>=&gt;</code> will turn words on its left-hand side to <code>Str</code> without checking the scope for constants or <code>\</code>-sigiled variables. Use explicit scoping to get what you mean.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>constant</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>V</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>V&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>oi‽</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;::</span><span class="string pair key perl6fe"><span>V&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>perl</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«{:V(&quot;oi‽&quot;),&nbsp;:x(42)}␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Infix_operator_assignment"><a class="u" href="#___top" title="go to top of document">Infix operator assignment</a></h2>
<p>Infix operators, both built in and user defined, can be combined with the assignment operator as this addition example demonstrates:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>10</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>+=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>20</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«30␤»</span></span></span></div></pre><p>For any given infix operator <code>op</code>, <code>L op= R</code> is equivalent to <code>L = L op R</code> (where <code>L</code> and <code>R</code> are the left and right arguments, respectively). This means that the following code may not behave as expected:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>+=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>10</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[13]␤»</span></span></span></div></pre><p>Coming from a language like C++, this might seem odd. It is important to bear in mind that <code>+=</code> isn&#39;t defined as method on the left hand argument (here the <code>@a</code> array) but is simply shorthand for:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>10</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[13]␤»</span></span></span></div></pre><p>Here <code>@a</code> is assigned the result of adding <code>@a</code> (which has three elements) and <code>10</code>; <code>13</code> is therefore placed in <code>@a</code>.</p>
<p>Use the <a href="/language/operators#Hyper_operators">hyper form</a> of the assignment operators instead:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;»</span><span class="storage modifier assignment perl6fe"><span>+=</span></span><span>»&nbsp;</span><span class="constant numeric perl6fe"><span>10</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[11&nbsp;12&nbsp;13]␤»</span></span></span></div></pre><h1 id="Regexes"><a class="u" href="#___top" title="go to top of document">Regexes</a></h1>
<h2 id="$x_vs_<$x>,_and_$(code)_vs_<{code}>"><a class="u" href="#___top" title="go to top of document"><code>$x</code> vs <code>&lt;$x&gt;</code>, and <code>$(code)</code> vs <code>&lt;{code}&gt;</code></a></h2>
<p>Perl&nbsp;6 offers several constructs to generate regexes at runtime through interpolation (see their detailed description <a href="/language/regexes#Regex_interpolation">here</a>). When a regex generated this way contains only literals, the above constructs behave (pairwise) identically, as if they are equivalent alternatives. As soon as the generated regex contains metacharacters, however, they behave differently, which may come as a confusing surprise.</p>
<p>The first two constructs that may easily be confused with each other are <code>$variable</code> and <code>&lt;$variable&gt;</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>variable</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>camelia</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>variable</span></span><span>&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢camelia｣</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>$</span><span class="variable other identifier regexname perl6fe"><span>variable</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢camelia｣</span></span></span></div></pre><p>Here they act the same because the value of <code>$variable</code> consists of literals. But when the variable is changed to comprise regex metacharacters the outputs become different:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>variable</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>#camelia</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;#camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>variable</span></span><span>&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢#camelia｣</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;#camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>$</span><span class="variable other identifier regexname perl6fe"><span>variable</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;!!&nbsp;Error:&nbsp;malformed&nbsp;regex</span></span></span></div></pre><p>What happens here is that the string <code>#camelia</code> contains the metacharacter <code>#</code>. In the context of a regex, this character should be quoted to match literally; without quoting, the <code>#</code> is parsed as the start of a comment that runs until the end of the line, which in turn causes the regex not to be terminated, and thus to be malformed.</p>
<p>Two other constructs that must similarly be distinguished from one another are <code>$(code)</code> and <code>&lt;{code}&gt;</code>. Like before, as long as the (stringified) return value of <code>code</code> comprises only literals, there is no distinction between the two:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>variable</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ailemac</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="entity name section boundary regexp perl6fe"><span>$</span></span><span>(</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>variable</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>flip)&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢camelia｣</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>{$</span><span class="variable other identifier regexname perl6fe"><span>variable</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.flip</span></span><span>}</span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢camelia｣</span></span></span></div></pre><p>But when the return value is changed to comprise regex metacharacters, the outputs diverge:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>variable</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ailema.</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="entity name section boundary regexp perl6fe"><span>$</span></span><span>(</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>variable</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>flip)&nbsp;&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;Nil</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>I&nbsp;♥&nbsp;camelia</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>{$</span><span class="variable other identifier regexname perl6fe"><span>variable</span></span><span class="comment suppressed capture property regexp perl6fe"><span>.flip</span></span><span>}</span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;&nbsp;</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;｢camelia｣</span></span></span></div></pre><p>In this case the return value of the code is the string <code>.amelia</code>, which contains the metacharacter <code>.</code>. The above attempt by <code>$(code)</code> to match the dot literally fails; the attempt by <code>&lt;{code}&gt;</code> to match the dot as a regex wildcard succeeds. Hence the different outputs.</p>
<h2 id="|_vs_||:_which_branch_will_win"><a class="u" href="#___top" title="go to top of document"><code>|</code> vs <code>||</code>: which branch will win</a></h2>
<p>To match one of several possible alternatives, <code>||</code> or <code>|</code> will be used. But they are so different.</p>
<p>When there are multiple matching alternations, for those separated by <code>||</code>, the first matching alternation wins; for those separated by <code>|</code>, which to win is decided by LTM strategy. See also: <a href="/language/regexes#Alternation:_||">documentation on <code>||</code></a> and <a href="/language/regexes#Longest_alternation:_|">documentation on <code>|</code></a>.</p>
<p>For simple regexes just using <code>||</code> instead of <code>|</code> will get you familiar semantics, but if writing grammars then it&#39;s useful to learn about LTM and declarative prefixes and prefer <code>|</code>. And keep yourself away from using them in one regex. When you have to do that, add parentheses and ensure that you know how LTM strategy works to make the code do what you want.</p>
<p>The trap typically arises when you try to mix both <code>|</code> and <code>||</code> in the same regex:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;[&nbsp;&nbsp;0&nbsp;</span><span class="support function alternation regexp perl6fe"><span>||</span></span><span>&nbsp;42&nbsp;]&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;4</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢4｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>&nbsp;[&nbsp;42&nbsp;</span><span class="support function alternation regexp perl6fe"><span>||</span></span><span>&nbsp;&nbsp;0&nbsp;]&nbsp;</span><span class="support function alternation regexp perl6fe"><span>|</span></span><span>&nbsp;4</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢42｣␤»</span><span>&nbsp;</span></span></span></div></pre><p>The code above may seem like it is producing a wrong result, but the implementation is actually right.</p>
<h2 id="$/_changes_each_time_a_regular_expression_is_matched"><a class="u" href="#___top" title="go to top of document"><code>$/</code> changes each time a regular expression is matched</a></h2>
<p>Each time a regular expression is matched against something, the special variable <code>$/</code> holding the result <a href="/type/Match">Match object</a> is changed accordingly to the result of the match (that could also be <code>Nil</code>).</p>
<p>The <code>$/</code> is changed without any regard to the scope the regular expression is matched within.</p>
<p>For further information and examples please see the <a href="/language/regexes.html#$/_changes_each_time_a_regular_expression_is_matched">related section in the Regular Expressions documentation</a>.</p>
<h2 id="<foo>_vs._<_foo>:_named_rules_vs._quoted_lists"><a class="u" href="#___top" title="go to top of document"><code>&lt;foo&gt;</code> vs. <code>&lt; foo&gt;</code>: named rules vs. quoted lists</a></h2>
<p>Regexes can contain quoted lists; longest token matching is performed on the list&#39;s elements as if a <code>|</code> alternation had been specified (see <a href="/language/regexes#Quoted_lists_are_LTM_matches">here</a> for further information).</p>
<p>Within a regex, the following are lists with a single item, <code>&#39;foo&#39;</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>foo</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>&nbsp;</span><span class="variable other identifier regexname perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢foo｣␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>foo</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span>&nbsp;</span><span class="variable other identifier regexname perl6fe"><span>foo</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«｢foo｣␤»</span></span></span></div></pre><p>but this is a call to the named rule <code>foo</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>foo</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>foo</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«No&nbsp;such&nbsp;method&nbsp;&#39;foo&#39;&nbsp;for&nbsp;invocant&nbsp;of&nbsp;type&nbsp;&#39;Match&#39;␤&nbsp;in&nbsp;block&nbsp;&lt;unit&gt;&nbsp;at&nbsp;&lt;unknown&nbsp;file&gt;&nbsp;line&nbsp;1␤»</span><span>&nbsp;</span></span></span></div></pre><p>Be wary of the difference; if you intend to use a quoted list, ensure that whitespace follows the initial <code>&lt;</code>.</p>
<h2 id="Non-capturing,_non-global_matching_in_list_context"><a class="u" href="#___top" title="go to top of document">Non-capturing, non-global matching in list context</a></h2>
<p>Unlike Perl&nbsp;5, non-capturing and non-global matching in list context doesn&#39;t produce any values:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>yes</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«yes␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>yes</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;NO&nbsp;OUTPUT</span></span></span></div></pre><p>This is because its &#39;list&#39; slot (inherited from Capture class) doesn&#39;t get populated with the original Match object:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>list</span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«()␤»</span></span></span></div></pre><p>To achieve the desired result, use global matching, capturing parentheses or a list with a trailing comma:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="string regexp construct perl6fe"><span>m</span></span><span class="entity name section adverb regexp perl6fe"><span>:g</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>yes</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«yes␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>(</span><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span><span>)</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>yes</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«yes␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>x</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="keyword operator quantifiers regexp perl6fe"><span>.</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>,)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>yes</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«yes␤»</span></span></span></div></pre><h1 id="Common_precedence_mistakes"><a class="u" href="#___top" title="go to top of document">Common precedence mistakes</a></h1>
<h2 id="Adverbs_and_precedence"><a class="u" href="#___top" title="go to top of document">Adverbs and precedence</a></h2>
<p>Adverbs do have a precedence that may not follow the order of operators that is displayed on your screen. If two operators of equal precedence are followed by an adverb it will pick the first operator it finds in the abstract syntax tree. Use parentheses to help Perl&nbsp;6 understand what you mean or use operators with looser precedence.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>a&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>!</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;dies&nbsp;with&nbsp;X::AdHoc</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span><span>!</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;this&nbsp;works</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>!</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;works&nbsp;too</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>not</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;works&nbsp;as&nbsp;well</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>True</span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>unless</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;avoid&nbsp;negation&nbsp;altogether</span><span>&nbsp;</span></span></span></div></pre><h2 id="Ranges_and_precedence"><a class="u" href="#___top" title="go to top of document">Ranges and precedence</a></h2>
<p>The loose precedence of <code>..</code> can lead to some errors. It is usually best to parenthesize ranges when you want to operate on the entire range.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>3</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;says&nbsp;&quot;3&quot;&nbsp;(and&nbsp;warns&nbsp;about&nbsp;useless&nbsp;&quot;..&quot;)</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>3</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;says&nbsp;&quot;1..3&quot;</span><span>&nbsp;</span></span></span></div></pre><h2 id="Loose_boolean_operators"><a class="u" href="#___top" title="go to top of document">Loose boolean operators</a></h2>
<p>The precedence of <code>and</code>, <code>or</code>, etc. is looser than routine calls. This can have surprising results for calls to routines that would be operators or statements in other languages like <code>return</code>, <code>last</code> and many others.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>f</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>return</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>True</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>and</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>False</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation whitespace comment leading perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;this&nbsp;is&nbsp;actually</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation whitespace comment leading perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span></span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;(return&nbsp;True)&nbsp;and&nbsp;False;</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>f</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Exponentiation_operator_and_prefix_minus"><a class="u" href="#___top" title="go to top of document">Exponentiation operator and prefix minus</a></h2>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>-1</span></span><span>²;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«-1␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>-1</span></span><span class="keyword operator multi-symbol perl6fe"><span>**</span></span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«-1␤»</span><span>&nbsp;</span></span></span></div></pre><p>When performing a <a href="https://www.wolframalpha.com/input/?i=-1%C2%B2">regular mathematical calculation</a>, the power takes precedence over the minus; so <code>-1²</code> can be written as <code>-(1²)</code>. Perl&nbsp;6 matches these rules of mathematics and the precedence of <code>**</code> operator is tighter than that of the prefix <code>-</code>. If you wish to raise a negative number to a power, use parentheses:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>-1</span></span><span>)²;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>-1</span></span><span>)</span><span class="keyword operator multi-symbol perl6fe"><span>**</span></span><span class="constant numeric perl6fe"><span>2</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Method_operator_calls_and_prefix_minus"><a class="u" href="#___top" title="go to top of document">Method operator calls and prefix minus</a></h2>
<p>Prefix minus binds looser than dotty method op calls. The prefix minus will be applied to the return value from the method. To ensure the minus gets passed as part of the argument, enclose in parenthesis.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;&nbsp;</span><span class="constant numeric perl6fe"><span>-1</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>abs</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«-1␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>-1</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>abs</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1␤»</span><span>&nbsp;</span></span></span></div></pre><h1 id="Subroutine_and_method_calls"><a class="u" href="#___top" title="go to top of document">Subroutine and method calls</a></h1>
<p>Subroutine and method calls can be made using one of two forms:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;function&nbsp;call&nbsp;form,&nbsp;where&nbsp;...&nbsp;represent&nbsp;the&nbsp;required&nbsp;arguments</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;list&nbsp;op&nbsp;form,&nbsp;where&nbsp;...&nbsp;represent&nbsp;the&nbsp;required&nbsp;arguments</span><span>&nbsp;</span></span></span></div></pre><p>The function call form can cause problems for the unwary when whitespace is added after the function or method name and before the opening parenthesis.</p>
<p>First we consider functions with zero or one parameter:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>no&nbsp;arg</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>bar</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>one&nbsp;arg:&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>a</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>Then execute each with and without a space after the name:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>();&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;no&nbsp;arg</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;();&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;FAIL:&nbsp;Too&nbsp;many&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;0&nbsp;arguments&nbsp;but&nbsp;got&nbsp;1</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>bar</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;one&nbsp;arg:&nbsp;1</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>bar</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;one&nbsp;arg:&nbsp;1</span><span>&nbsp;</span></span></span></div></pre><p>Now declare a function of two parameters:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>two&nbsp;args:&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>a</span></span><span>,&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>b</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>Execute it with and without the space after the name:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;two&nbsp;args:&nbsp;1,&nbsp;2</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;FAIL:&nbsp;Too&nbsp;few&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;2&nbsp;arguments&nbsp;but&nbsp;got&nbsp;1</span><span>&nbsp;</span></span></span></div></pre><p>The lesson is: &quot;be careful with spaces following sub and method names when using the function call format.&quot; As a general rule, good practice might be to avoid the space after a function name when using the function call format.</p>
<p>Note that there are clever ways to eliminate the error with the function call format and the space, but that is bordering on hackery and will not be mentioned here. For more information, consult <a href="/language/functions#Functions">Functions</a>.</p>
<p>Finally, note that, currently, when declaring the functions whitespace may be used between a function or method name and the parentheses surrounding the parameter list without problems.</p>
<h2 id="Named_parameters"><a class="u" href="#___top" title="go to top of document">Named parameters</a></h2>
<p>Many built-in subroutines and method calls accept named parameters and your own code may accept them as well, but be sure the arguments you pass when calling your routines are actually named parameters:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;FAIL:&nbsp;Too&nbsp;many&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;1&nbsp;argument&nbsp;but&nbsp;got&nbsp;2</span><span>&nbsp;</span></span></span></div></pre><p>What happened? That second argument is not a named parameter argument, but a <a href="/type/Pair">Pair</a> passed as a positional argument. If you want a named parameter it has to look like a name to Perl:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>b&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>b</span></span><span>(</span><span class="constant numeric perl6fe"><span>2</span></span><span>));&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>b</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>it</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>b</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>));&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay,&nbsp;but&nbsp;redundant</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Or&nbsp;even...</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>arg</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>arg</span></span></span><span>);&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay&nbsp;too</span><span>&nbsp;</span></span></span></div></pre><p>That last one may be confusing, but since it uses the <code>|</code> prefix on a <a href="/type/Hash">Hash</a>, which is a special compiler construct indicating you want to use <em>the contents</em> of the variable as arguments, which for hashes means to treat them as named arguments.</p>
<p>If you really do want to pass them as pairs you should use a <a href="/type/List">List</a> or <a href="/type/Capture">Capture</a> instead:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>),;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;this&nbsp;is&nbsp;a&nbsp;List&nbsp;containing&nbsp;a&nbsp;single&nbsp;Pair</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;we&nbsp;passed&nbsp;the&nbsp;pair&nbsp;&#39;b&#39;&nbsp;=&gt;&nbsp;2&nbsp;to&nbsp;the&nbsp;first&nbsp;argument</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;FAIL:&nbsp;Too&nbsp;many&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;1&nbsp;argument&nbsp;but&nbsp;got&nbsp;2</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Capture</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OK:&nbsp;.Capture&nbsp;call&nbsp;converts&nbsp;all&nbsp;Pair&nbsp;objects&nbsp;to&nbsp;named&nbsp;args&nbsp;in&nbsp;a&nbsp;Capture</span><span>&nbsp;</span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>cap</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;\(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>b</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;a&nbsp;Capture&nbsp;with&nbsp;a&nbsp;single&nbsp;positional&nbsp;value</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>cap</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;okay:&nbsp;we&nbsp;passed&nbsp;the&nbsp;pair&nbsp;&#39;b&#39;&nbsp;=&gt;&nbsp;2&nbsp;to&nbsp;the&nbsp;first&nbsp;argument</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>foo</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>cap</span></span></span><span>);&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;FAIL:&nbsp;Too&nbsp;many&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;1&nbsp;argument&nbsp;but&nbsp;got&nbsp;2</span><span>&nbsp;</span></span></span></div></pre><p>A Capture is usually the best option for this as it works exactly like the usual capturing of routine arguments during a regular call.</p>
<p>The nice thing about the distinction here is that it gives the developer the option of passing pairs as either named or positional arguments, which can be handy in various instances.</p>
<h2 id="Argument_count_limit"><a class="u" href="#___top" title="go to top of document">Argument count limit</a></h2>
<p>While it is typically unnoticeable, there is a backend-dependent argument count limit. Any code that does flattening of arbitrarily sized arrays into arguments won&#39;t work if there are too many elements.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>xx</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>9999</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>push</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«9999␤»</span><span>&nbsp;</span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>xx</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>999999</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>push</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Too&nbsp;many&nbsp;arguments&nbsp;in&nbsp;flattening&nbsp;array.␤&nbsp;&nbsp;in&nbsp;block&nbsp;&lt;unit&gt;&nbsp;at&nbsp;&lt;tmp&gt;&nbsp;line&nbsp;1␤␤»</span><span>&nbsp;</span></span></span></div></pre><p>Avoid this trap by rewriting the code so that there is no flattening. In the example above, you can replace <code>push</code> with <code>append</code>. This way, no flattening is required because the array can be passed as is.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>xx</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>999999</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>append</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«999999␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Phasers_and_implicit_return"><a class="u" href="#___top" title="go to top of document">Phasers and implicit return</a></h2>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>returns-ret</span></span><span>&nbsp;()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CATCH</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>default</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>ret</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>doesn&#39;t-return-ret</span></span><span>&nbsp;()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>ret</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CATCH</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>default</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>returns-ret</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«ret»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>doesn</span></span><span>&#39;</span><span class="routine name perl6fe"><span>t-return-ret</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;BAD:&nbsp;outputs&nbsp;«Nil»&nbsp;and&nbsp;a&nbsp;warning&nbsp;«Useless&nbsp;use&nbsp;of&nbsp;constant&nbsp;string&nbsp;&quot;ret&quot;&nbsp;in&nbsp;sink&nbsp;context&nbsp;(line&nbsp;13)»</span><span>&nbsp;</span></span></span></div></pre><p>Code for <code>returns-ret</code> and <code>doesn&#39;t-return-ret</code> might look exactly the same, since in principle it does not matter where the <a href="/language/phasers#index-entry-Phasers__CATCH-CATCH"><code>CATCH</code></a> block goes. However, a block is an object and the last object in a <code>sub</code> will be returned, so the <code>doesn&#39;t-return-ret</code> will return <code>Nil</code>, and, besides, since &quot;ret&quot; will be now in sink context, it will issue a warning. In case you want to place phasers last for conventional reasons, use the explicit form of <code>return</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>explicitly-return-ret</span></span><span>&nbsp;()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>return</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>ret</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CATCH</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>default</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h1 id="Input_and_output"><a class="u" href="#___top" title="go to top of document">Input and output</a></h1>
<h2 id="Closing_open_filehandles_and_pipes"><a class="u" href="#___top" title="go to top of document">Closing open filehandles and pipes</a></h2>
<p>Unlike some other languages, Perl&nbsp;6 does not use reference counting, and so <strong>the filehandles are NOT closed when they go out of scope</strong>. You have to explicitly close them either by using <a href="/routine/close">close</a> routine or using the <code>:close</code> argument several of <a href="/type/IO::Handle">IO::Handle&#39;s</a> methods accept. See <a href="/type/IO::Handle#routine_close"><code>IO::Handle.close</code></a> for details.</p>
<p>The same rules apply to <a href="/type/IO::Handle">IO::Handle&#39;s</a> subclass <a href="/type/IO::Pipe">IO::Pipe</a>, which is what you operate on when reading from a <a href="/type/Proc">Proc</a> you get with routines <a href="/routine/run">run</a> and <a href="/routine/shell">shell</a>.</p>
<p>The caveat applies to <a href="/type/IO::CatHandle">IO::CatHandle</a> type as well, though not as severely. See <a href="/type/IO::CatHandle#method_close"><code>IO::CatHandle.close</code></a> for details.</p>
<h2 id="IO::Path_stringification"><a class="u" href="#___top" title="go to top of document">IO::Path stringification</a></h2>
<p>Partly for historical reasons and partly by design, an <a href="/type/IO::Path">IO::Path</a> object <a href="/type/IO::Path#method_Str">stringifies</a> without considering its <a href="/type/IO::Path#attribute_CWD"><code>CWD</code> attribute</a>, which means if you <a href="/routine/chdir">chdir</a> and then stringify an <a href="/type/IO::Path">IO::Path</a>, or stringify an <a href="/type/IO::Path">IO::Path</a> with custom <code>$!CWD</code> attribute, the resultant string won&#39;t reference the original filesystem object:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control conditional perl6fe"><span>with</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>foo</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Str</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«foo␤»</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>relative</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«foo␤»</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>chdir</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>/tmp</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Str</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«foo␤»</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>relative</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«../home/camelia/foo␤»</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Deletes&nbsp;./foo,&nbsp;not&nbsp;/bar/foo</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>unlink</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>IO</span></span><span>::</span><span class="routine name perl6fe"><span>Path</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>foo</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>CWD</span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>/bar</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Str</span></span></span></div></pre><p>The easy way to avoid this issue is to not stringify an <a href="/type/IO::Path">IO::Path</a> object at all. Core routines that work with paths can take an <a href="/type/IO::Path">IO::Path</a> object, so you don&#39;t need to stringify the paths.</p>
<p>If you do have a case where you need a stringified version of an <a href="/type/IO::Path">IO::Path</a>, use <a href="/routine/absolute">absolute</a> or <a href="/routine/relative">relative</a> methods to stringify it into an absolute or relative path, respectively.</p>
<p>If you are facing this issue because you use <a href="/routine/chdir">chdir</a> in your code, consider rewriting it in a way that does not involve changing the current directory. For example, you can pass <code>cwd</code> named argument to <a href="/routine/run">run</a> without having to use <code>chdir</code> around it.</p>
<h2 id="Splitting_the_input_data_into_lines"><a class="u" href="#___top" title="go to top of document">Splitting the input data into lines</a></h2>
<p>There is a difference between using <code>.lines</code> on <a href="/type/IO::Handle#routine_lines"><code>IO::Handle</code></a> and on a <a href="/type/Str#routine_lines"><code>Str</code></a>. The trap arises if you start assuming that both split data the same way.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>perl</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>IN</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;.lines&nbsp;called&nbsp;on&nbsp;IO::Handle</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;foox&quot;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;fooy\rbar&quot;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;fooz&quot;</span><span>&nbsp;</span></span></span></div></pre><p>As you can see in the example above, there was a line which contained <code>\r</code> (“carriage return” control character). However, the input is split strictly by <code>\n</code>, so <code>\r</code> was kept as part of the string.</p>
<p>On the other hand, <a href="/type/Str#routine_lines"><code>Str.lines</code></a> attempts to be “smart” about processing data from different operating systems. Therefore, it will split by all possible variations of a newline.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>perl</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>*</span></span><span class="variable other identifier perl6fe"><span>IN</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>slurp</span></span><span>(</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>bin</span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>decode</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;.lines&nbsp;called&nbsp;on&nbsp;a&nbsp;Str</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;foox&quot;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;fooy&quot;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;bar&quot;</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&quot;fooz&quot;</span><span>&nbsp;</span></span></span></div></pre><p>The rule is quite simple: use <a href="/type/IO::Handle#routine_lines"><code>IO::Handle.lines</code></a> when working with programmatically generated output, and <a href="/type/Str#routine_lines"><code>Str.lines</code></a> when working with user-written texts.</p>
<p>Use <code>$data.split(“\n”)</code> in cases where you need the behavior of <a href="/type/IO::Handle#routine_lines"><code>IO::Handle.lines</code></a> but the original <a href="/type/IO::Handle">IO::Handle</a> is not available.</p>
<p>Note that if you really want to slurp the data first, then you will have to use <code>.IO.slurp(:bin).decode.split(“\n”)</code>. Notice how we use <code>:bin</code> to prevent it from doing the decoding, only to call <code>.decode</code> later anyway. All that is needed because <code>.slurp</code> is assuming that you are working with text and therefore it attempts to be smart about newlines.</p>
<p>If you are using <a href="/type/Proc::Async">Proc::Async</a>, then there is currently no easy way to make it split data the right way. You can try reading the whole output and then using <a href="/type/Str#routine_split"><code>Str.split</code></a> (not viable if you are dealing with large data) or writing your own logic to split the incoming data the way you need. Same applies if your data is null-separated.</p>
<h2 id="Proc::Async_and_print"><a class="u" href="#___top" title="go to top of document">Proc::Async and <code>print</code></a></h2>
<p>When using Proc::Async you should not assume that <code>.print</code> (or any other similar method) is synchronous. The biggest issue of this trap is that you will likely not notice the problem by running the code once, so it may cause a hard-to-detect intermittent fail.</p>
<p>Here is an example that demonstrates the issue:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>loop</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Proc</span></span><span>::</span><span class="routine name perl6fe"><span>Async</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="routine name perl6fe"><span>w</span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>head</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>-n</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>1</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>got-something</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>react</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>whenever</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>stdout</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>got-something</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>True</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>whenever</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>start</span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control control-handlers perl6fe"><span>die</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>FAIL!</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>unless</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>got-something</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>print</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted left_double_right_double perl6fe"><span class="punctuation definition string begin perl6fe"><span>“</span></span><span>one</span><span class="constant character escape perl6fe"><span>\n</span></span><span>two</span><span class="constant character escape perl6fe"><span>\n</span></span><span>three</span><span class="constant character escape perl6fe"><span>\n</span></span><span>four</span><span class="punctuation definition string end perl6fe"><span>”</span></span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>close-stdin</span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;$</span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>And the output it may produce:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="constant numeric perl6fe"><span>0</span></span></span></div><div class="line"><span class="source perl6fe"><span class="constant numeric perl6fe"><span>1</span></span></span></div><div class="line"><span class="source perl6fe"><span class="constant numeric perl6fe"><span>2</span></span></span></div><div class="line"><span class="source perl6fe"><span class="constant numeric perl6fe"><span>3</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>An</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>operation</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>first</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>awaited</span></span><span class="keyword operator generic perl6fe"><span>:</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>in</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>block</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>unit</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>at</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>print</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>p6</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>line</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Died</span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>with</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>the</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>exception</span></span><span class="keyword operator generic perl6fe"><span>:</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>FAIL</span></span><span class="keyword operator generic perl6fe"><span>!</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>in</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>block</span></span><span>&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>at</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>print</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>p6</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>line</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>6</span></span></span></div></pre><p>Resolving this is easy because <code>.print</code> returns a promise that you can await on. The solution is even more beautiful if you are working in a <a href="/language/concurrency#index-entry-react">react</a> block:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control flowcontrol perl6fe"><span>whenever</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>print</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted left_double_right_double perl6fe"><span class="punctuation definition string begin perl6fe"><span>“</span></span><span>one</span><span class="constant character escape perl6fe"><span>\n</span></span><span>two</span><span class="constant character escape perl6fe"><span>\n</span></span><span>three</span><span class="constant character escape perl6fe"><span>\n</span></span><span>four</span><span class="punctuation definition string end perl6fe"><span>”</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>close-stdin</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h2 id="Using_.stdout_without_.lines"><a class="u" href="#___top" title="go to top of document">Using <code>.stdout</code> without <code>.lines</code></a></h2>
<p>Method <code>.stdout</code> of <a href="/type/Proc::Async">Proc::Async</a> returns a supply that emits <em>chunks</em> of data, not lines. The trap is that sometimes people assume it to give lines right away.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Proc</span></span><span>::</span><span class="routine name perl6fe"><span>Async</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>cat</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>/usr/share/dict/words</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control flowcontrol perl6fe"><span>react</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>whenever</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>stdout</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>head</span></span><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG&nbsp;(most&nbsp;likely)</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>whenever</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>proc</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>start</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>The output is clearly not just 1 line:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>A</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>A</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>AMD</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>AMD</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>AOL</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>AOL</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aachen</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aachen</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aaliyah</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aaliyah</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aaron</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Aaron</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbas</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbas</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbasid</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbasid</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbott</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abbott</span></span><span>&#39;</span><span class="routine name perl6fe"><span>s</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Abby</span></span></span></div></pre><p>If you want to work with lines, then use <code>$proc.stdout.lines</code>. If you&#39;re after the whole output, then something like this should do the trick: <code>whenever $proc.stdout { $out ~= $_ }</code>.</p>
<h1 id="Exception_handling"><a class="u" href="#___top" title="go to top of document">Exception handling</a></h1>
<h2 id="Sunk_Proc"><a class="u" href="#___top" title="go to top of document">Sunk <code>Proc</code></a></h2>
<p>Some methods return a <a href="/type/Proc">Proc</a> object. If it represents a failed process, <code>Proc</code> itself won&#39;t be exception-like, but <strong>sinking it</strong> will cause an <a href="/type/X::Proc::Unsuccessful">X::Proc::Unsuccessful</a> exception to be thrown. That means this construct will throw, despite the <code>try</code> in place:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control control-handlers perl6fe"><span>try</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>run</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>perl6</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>-e</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>exit&nbsp;42</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>still&nbsp;alive</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«The&nbsp;spawned&nbsp;process&nbsp;exited&nbsp;unsuccessfully&nbsp;(exit&nbsp;code:&nbsp;42)␤»</span><span>&nbsp;</span></span></span></div></pre><p>This is because <code>try</code> receives a <code>Proc</code> and returns it, at which point it sinks and throws. Explicitly sinking it inside the <code>try</code> avoids the issue and ensures the exception is thrown inside the <code>try</code>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control control-handlers perl6fe"><span>try</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>sink</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>run</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>perl6</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>-e</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>exit&nbsp;42</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>still&nbsp;alive</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«still&nbsp;alive␤»</span><span>&nbsp;</span></span></span></div></pre><p>If you&#39;re not interested in catching any exceptions, then use an anonymous variable to keep the returned <code>Proc</code> in; this way it&#39;ll never sink:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword other special-method perl6fe"><span>$</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>run</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>perl6</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>-e</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>exit&nbsp;42</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>still&nbsp;alive</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«still&nbsp;alive␤»</span><span>&nbsp;</span></span></span></div></pre><h1 id="Using_shortcuts"><a class="u" href="#___top" title="go to top of document">Using shortcuts</a></h1>
<h2 id="The_^_twigil"><a class="u" href="#___top" title="go to top of document">The ^ twigil</a></h2>
<p>Using the <code>^</code> twigil can save a fair amount of time and space when writing out small blocks of code. As an example:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>8</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>can be shortened to just</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>8</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>The trouble arises when a person wants to use more complex names for the variables, instead of just one letter. The <code>^</code> twigil is able to have the positional variables be out of order and named whatever you want, but assigns values based on the variable&#39;s Unicode ordering. In the above example, we can have <code>$^a</code> and <code>$^b</code> switch places, and those variables will keep their positional values. This is because the Unicode character &#39;a&#39; comes before the character &#39;b&#39;. For example:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;In&nbsp;order</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>f1</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>first</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>second</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>f1</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Hello</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>there</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Hello&nbsp;there␤»</span><span>&nbsp;</span></span></span></div></pre><pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Out&nbsp;of&nbsp;order</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>f2</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>second</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>first</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>f2</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Hello</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>there</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«there&nbsp;Hello␤»</span><span>&nbsp;</span></span></span></div></pre><p>Due to the variables allowed to be called anything, this can cause some problems if you are not accustomed to how Perl&nbsp;6 handles these variables.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;BAD&nbsp;NAMING:&nbsp;alphabetically&nbsp;`four`&nbsp;comes&nbsp;first&nbsp;and&nbsp;gets&nbsp;value&nbsp;`1`&nbsp;in&nbsp;it:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>4</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>one</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>two</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>three</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>four</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«2&nbsp;4&nbsp;3&nbsp;1␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;GOOD&nbsp;NAMING:&nbsp;variables&#39;&nbsp;naming&nbsp;makes&nbsp;it&nbsp;clear&nbsp;how&nbsp;they&nbsp;sort&nbsp;alphabetically:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>4</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>a</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>b</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>c</span></span><span>&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil interpolated perl6fe"><span>^</span></span><span>d</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1&nbsp;2&nbsp;3&nbsp;4␤»</span><span>&nbsp;</span></span></span></div></pre><h2 id="Using_»_and_map_interchangeably"><a class="u" href="#___top" title="go to top of document">Using <code>»</code> and <code>map</code> interchangeably</a></h2>
<p>While <a href="/language/operators#index-entry-hyper_%3C%3C-hyper_%3E%3E-hyper_%C2%AB-hyper_%C2%BB-Hyper_Operators"><code>»</code></a> may look like a shorter way to write <code>map</code>, they differ in some key aspects.</p>
<p>First, the <code>»</code> includes a <em>hint</em> to the compiler that it may autothread the execution, thus if you&#39;re using it to call a routine that produces side effects, those side effects may be produced out of order (the result of the operator <em>is</em> kept in order, however). Also if the routine being invoked accesses a resource, there&#39;s the possibility of a race condition, as multiple invocations may happen simultaneously, from different threads.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c&nbsp;d</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>»</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«d␤b␤c␤a␤»</span><span>&nbsp;</span></span></span></div></pre><p>Second, <code>»</code> checks the <a href="/routine/is%20nodal">nodality</a> of the routine being invoked and based on that will use either <a href="/routine/deepmap">deepmap</a> or <a href="/routine/nodemap">nodemap</a> to map over the list, which can be different from how a <a href="/routine/map">map</a> call would map over it:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;((</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>),&nbsp;[</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>4</span></span><span>],&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>5</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>)»</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Numeric</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«((1&nbsp;2&nbsp;3)&nbsp;[0&nbsp;1&nbsp;2&nbsp;3]&nbsp;5)␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;((</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>),&nbsp;[</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>4</span></span><span>],&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>5</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support type perl6fe"><span>Numeric</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(3&nbsp;4&nbsp;5)␤»</span><span>&nbsp;</span></span></span></div></pre><p>The bottom line is that <code>map</code> and <code>»</code> are not interchangeable, but using one instead of the other is OK as long as you understand the differences.</p>
<h2 id="Word_splitting_in_«_»"><a class="u" href="#___top" title="go to top of document">Word splitting in <code>« »</code></a></h2>
<p>Keep in mind that <code>« »</code> performs word splitting similarly to how shells do it, so <a href="https://mywiki.wooledge.org/BashPitfalls">many shell pitfalls</a> apply here as well (especially when using in combination with <code>run</code>):</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>file</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>--my&nbsp;arbitrary&nbsp;filename</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>touch</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>--</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>file</span></span></span><span>;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>touch&nbsp;--</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>file</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>--</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>file</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;RIGHT&nbsp;but&nbsp;WRONG&nbsp;if&nbsp;you&nbsp;forget&nbsp;quotes</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>--</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>file</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;touches&nbsp;‘--my’,&nbsp;‘arbitrary’&nbsp;and&nbsp;‘filename’</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>touch</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>file</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;error&nbsp;from&nbsp;`touch`</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>run</span></span><span>&nbsp;«</span><span class="routine name perl6fe"><span>touch</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>file</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>»;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WRONG;&nbsp;error&nbsp;from&nbsp;`touch`</span></span></span></div></pre><p>Note that <code>--</code> is required for many programs to disambiguate between command-line arguments and <a href="https://mywiki.wooledge.org/BashPitfalls#Filenames_with_leading_dashes">filenames that begin with hyphens</a>.</p>
<h1 id="Scope"><a class="u" href="#___top" title="go to top of document">Scope</a></h1>
<h2 id="Using_a_once_block"><a class="u" href="#___top" title="go to top of document">Using a <code>once</code> block</a></h2>
<p>The <code>once</code> block is a block of code that will only run once when its parent block is run. As an example:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>once</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Variable&nbsp;=&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>var</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Variable&nbsp;=&nbsp;1␤»</span><span>&nbsp;</span></span></span></div></pre><p>This functionality also applies to other code blocks like <code>sub</code> and <code>while</code>, not just <code>for</code> loops. Problems arise though, when trying to nest <code>once</code> blocks inside of other code blocks:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>do</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>once</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Variable&nbsp;=&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>var</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Variable&nbsp;=&nbsp;10␤»</span><span>&nbsp;</span></span></span></div></pre><p>In the above example, the <code>once</code> block was nested inside of a code block which was inside of a <code>for</code> loop code block. This causes the <code>once</code> block to run multiple times, because the <code>once</code> block uses state variables to determine whether it has run previously. This means that if the parent code block goes out of scope, then the state variable the <code>once</code> block uses to keep track of if it has run previously, goes out of scope as well. This is why <code>once</code> blocks and <code>state</code> variables can cause some unwanted behavior when buried within more than one code block.</p>
<p>If you want to have something that will emulate the functionality of a once block, but still work when buried a few code blocks deep, we can manually build the functionality of a <code>once</code> block. Using the above example, we can change it so that it will only run once, even when inside the <code>do</code> block by changing the scope of the <code>state</code> variable.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>state</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>run-code</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>True</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>do</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>run-code</span></span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>run-code</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant language boolean perl6fe"><span>False</span></span><span>;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>var</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>++</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Variable&nbsp;=&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>var</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Variable&nbsp;=&nbsp;1␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this example, we essentially manually build a <code>once</code> block by making a <code>state</code> variable called <code>$run-code</code> at the highest level that will be run more than once, then checking to see if <code>$run-code</code> is <code>True</code> using a regular <code>if</code>. If the variable <code>$run-code</code> is <code>True</code>, then make the variable <code>False</code> and continue with the code that should only be completed once.</p>
<p>The main difference between using a <code>state</code> variable like the above example and using a regular <code>once</code> block is what scope the <code>state</code> variable is in. The scope for the <code>state</code> variable created by the <code>once</code> block, is the same as where you put the block (imagine that the word &#39;<code>once</code>&#39; is replaced with a state variable and an <code>if</code> to look at the variable). The example above using <code>state</code> variables works because the variable is at the highest scope that will be repeated; whereas the example that has a <code>once</code> block inside of a <code>do</code>, made the variable within the <code>do</code> block which is not the highest scope that is repeated.</p>
<p>Using a <code>once</code> block inside a class method will cause the once state to carry across all instances of that class. For example:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>A</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>sayit</span></span><span>()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>once</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>hi</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>A</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>sayit</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«hi␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>A</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>sayit</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;nothing</span><span>&nbsp;</span></span></span></div></pre><h2 id="LEAVE_phaser_and_exit"><a class="u" href="#___top" title="go to top of document"><code>LEAVE</code> phaser and <code>exit</code></a></h2>
<p>Using <a href="/language/phasers#LEAVE"><code>LEAVE</code></a> phaser to perform graceful resource termination is a common pattern, but it does not cover the case when the program is stopped with <a href="/routine/exit"><code>exit</code></a>.</p>
<p>The following nondeterministic example should demonstrate the complications of this trap:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>Opened&nbsp;some&nbsp;resource</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>Closing&nbsp;the&nbsp;resource&nbsp;gracefully</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>with</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control flowcontrol perl6fe"><span>exit</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>&lt;</span></span><span>&nbsp;⅓;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;①&nbsp;｢exit｣&nbsp;is&nbsp;bad</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control control-handlers perl6fe"><span>die</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>Dying&nbsp;because&nbsp;of&nbsp;unhandled&nbsp;exception</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>&lt;</span></span><span>&nbsp;½;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;②&nbsp;｢die｣&nbsp;is&nbsp;ok</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;fallthru&nbsp;③</span><span>&nbsp;</span></span></span></div></pre><p>There are three possible results:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>①</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Opened</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>some</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>resource</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>②</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Opened</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>some</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>resource</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Closing</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>the</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>resource</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>gracefully</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Dying</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>because</span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>of</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>unhandled</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>exception</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>in</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>block</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>unit</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>at</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>print</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>p6</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>line</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>③</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Opened</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>some</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>resource</span></span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>Closing</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>the</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>resource</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>gracefully</span></span></span></div></pre><p>A call to <code>exit</code> is part of normal operation for many programs, so beware unintentional combination of <code>LEAVE</code> phasers and <code>exit</code> calls.</p>
<h2 id="LEAVE_phaser_may_run_sooner_than_you_think"><a class="u" href="#___top" title="go to top of document"><code>LEAVE</code> phaser may run sooner than you think</a></h2>
<p>Parameter binding is executed when we&#39;re &quot;inside&quot; the routine&#39;s block, which means <code>LEAVE</code> phaser would run when we leave that block if parameter binding fails when wrong arguments are given:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="support type perl6fe"><span>Int</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;assumes&nbsp;that&nbsp;$x&nbsp;is&nbsp;set</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«No&nbsp;such&nbsp;method&nbsp;&#39;Int&#39;&nbsp;for&nbsp;invocant&nbsp;of&nbsp;type&nbsp;&#39;Any&#39;␤»</span><span>&nbsp;</span></span></span></div></pre><p>A simple way to avoid this issue is to declare your sub or method a multi, so the candidate is eliminated during dispatch and the code never gets to binding anything inside the sub, thus never entering the routine&#39;s body:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>multi</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="support type perl6fe"><span>Int</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Cannot&nbsp;resolve&nbsp;caller&nbsp;foo(Num);&nbsp;none&nbsp;of&nbsp;these&nbsp;signatures&nbsp;match:&nbsp;(Int)␤»</span><span>&nbsp;</span></span></span></div></pre><p>Another alternative is placing the <code>LEAVE</code> into another block (assuming it&#39;s appropriate for it to be executed when <em>that</em> block is left, not the routine&#39;s body:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="support type perl6fe"><span>Int</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Type&nbsp;check&nbsp;failed&nbsp;in&nbsp;binding&nbsp;to&nbsp;parameter&nbsp;&#39;&lt;anon&gt;&#39;;&nbsp;expected&nbsp;Int&nbsp;but&nbsp;got&nbsp;Num&nbsp;(0.7289418947969465e0)␤»</span><span>&nbsp;</span></span></span></div></pre><p>You can also ensure <code>LEAVE</code> can be executed even if the routine is left due to failed argument binding. In our example, we check <code>$x</code> <a href="/routine/andthen">is defined</a> before doing anything with it.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>(</span><span class="support type perl6fe"><span>Int</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>x</span></span></span><span>&nbsp;</span><span class="keyword operator word perl6fe"><span>andthen</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Type&nbsp;check&nbsp;failed&nbsp;in&nbsp;binding&nbsp;to&nbsp;parameter&nbsp;&#39;&lt;anon&gt;&#39;;&nbsp;expected&nbsp;Int&nbsp;but&nbsp;got&nbsp;Num&nbsp;(0.8517160389079508e0)␤»</span><span>&nbsp;</span></span></span></div></pre><h1 id="Grammars"><a class="u" href="#___top" title="go to top of document">Grammars</a></h1>
<h2 id="Using_regexes_within_grammar's_actions"><a class="u" href="#___top" title="go to top of document">Using regexes within grammar&#39;s actions</a></h2>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>will-fail</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span class="entity name section boundary regexp perl6fe"><span>^</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>word</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span><span class="entity name section boundary regexp perl6fe"><span>$</span></span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>word</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="constant character escape class regexp perl6fe"><span>\w</span></span><span class="keyword operator quantifiers regexp perl6fe"><span>+</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>will-fail-actions</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>foo</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>foo</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>foo</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p>Will fail with <code>Cannot assign to a readonly variable ($/) or a value</code> on method <code>TOP</code>. The problem here is that regular expressions also affect <code>$/</code>. Since it is in <code>TOP</code>&#39;s signature, it is a read-only variable, which is what produces the error. You can safely either use another variable in the signature or add <code>is copy</code>, this way:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>TOP</span></span><span>&nbsp;(</span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="entity name type trait perl6fe"><span>copy</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>foo</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span class="keyword other special-method perl6fe"><span>$/</span></span><span>;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>v</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>foo</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span>foo</span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><h2 id="Using_certain_names_for_rules/token/regexes"><a class="u" href="#___top" title="go to top of document">Using certain names for rules/token/regexes</a></h2>
<p>Grammars are actually a type of classes.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>G</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>G</span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="routine name perl6fe"><span>mro</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«((G)&nbsp;(Grammar)&nbsp;(Match)&nbsp;(Capture)&nbsp;(Cool)&nbsp;(Any)&nbsp;(Mu))␤»</span></span></span></div></pre><p><code>^mro</code> prints the class hierarchy of this empty grammar, showing all the superclasses. And these superclasses have their very own methods. Defining a method in that grammar might clash with the ones inhabiting the class hierarchy:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>grammar</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>g</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named TOP perl6fe"><span>TOP</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>item</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta regexp named perl6fe"><span class="storage type declare regexp named perl6fe"><span>token</span></span><span>&nbsp;</span><span class="entity name function regexp named perl6fe"><span>item</span></span><span>&nbsp;</span><span class="meta regexp named block perl6fe"><span class="punctuation definition regex named perl6fe"><span>{</span></span><span>&nbsp;</span><span class="string literal perl6fe"><span>&#39;</span><span>defined</span><span>&#39;</span></span><span>&nbsp;</span></span><span class="punctuation definition regexp named perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>g</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>parse</span></span><span>(</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>defined</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Too&nbsp;many&nbsp;positionals&nbsp;passed;&nbsp;expected&nbsp;1&nbsp;argument&nbsp;but&nbsp;got&nbsp;2␤&nbsp;&nbsp;in&nbsp;regex&nbsp;item&nbsp;at&nbsp;/tmp/grammar-clash.p6&nbsp;line&nbsp;3␤&nbsp;&nbsp;in&nbsp;regex&nbsp;TOP&nbsp;at&nbsp;/tmp/grammar-clash.p6&nbsp;line&nbsp;2␤&nbsp;&nbsp;in&nbsp;block&nbsp;&lt;unit&gt;&nbsp;at&nbsp;/tmp/grammar-clash.p6&nbsp;line&nbsp;5»</span><span>&nbsp;</span></span></span></div></pre><p><code>item</code> seems innocuous enough, but it is a <a href="/routine/item"><code>sub</code> defined in class <code>Mu</code></a>. The message is a bit cryptic and totally unrelated to that fact, but that is why this is listed as a trap. In general, all subs defined in any part of the hierarchy are going to cause problems; some methods will too. For instance, <code>CREATE</code>, <code>take</code> and <code>defined</code> (which are defined in <a href="/type/Mu">Mu</a>). In general, multi methods and simple methods will not have any problem, but it might not be a good practice to use them as rule names.</p>
<p>Also avoid <a href="/language/objects#Object_construction">phasers</a> for rule/token/regex names: <code>TWEAK</code>, <code>BUILD</code>, <code>BUILD-ALL</code> will throw another kind of exception if you do that: <code>Cannot find method &#39;match&#39;: no method cache and no .^find_method</code>, once again only slightly related to what is actually going on.</p>
<h1 id="Unfortunate_generalization"><a class="u" href="#___top" title="go to top of document">Unfortunate generalization</a></h1>
<h2 id=":exists_with_more_than_one_key"><a class="u" href="#___top" title="go to top of document"><code>:exists</code> with more than one key</a></h2>
<p>Let&#39;s say you have a hash and you want to use <code>:exists</code> on more than one element:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>a&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>b&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>a&nbsp;exists</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;OK;&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>y&nbsp;exists</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;OK;&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>Huh‽</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>x&nbsp;y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;returns&nbsp;a&nbsp;2-item&nbsp;list</span><span>&nbsp;</span></span></span></div></pre><p>Did you mean “if <code>any</code> of them exists”, or did you mean that <code>all</code> of them should exist? Use <code>any</code> or <code>all</code> <a href="/type/Junction">Junction</a> to clarify:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string pair key perl6fe"><span>a&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="string pair key perl6fe"><span>b&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>x&nbsp;or&nbsp;y</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>any</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>x&nbsp;y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT&nbsp;(any);&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>a,&nbsp;x&nbsp;or&nbsp;y</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>any</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;x&nbsp;y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT&nbsp;(any);&nbsp;True</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>a,&nbsp;x&nbsp;and&nbsp;y</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>all</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;x&nbsp;y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT&nbsp;(all);&nbsp;False</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single left_single_right_single perl6fe"><span class="punctuation definition string begin perl6fe"><span>‘</span></span><span>a&nbsp;and&nbsp;b</span><span class="punctuation definition string end perl6fe"><span>’</span></span></span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>all</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span class="support function perl6fe"><span>exists</span></span><span>;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;RIGHT&nbsp;(all);&nbsp;True</span><span>&nbsp;</span></span></span></div></pre><p>The reason why it is always <code>True</code> (without using a junction) is that it returns a list with <a href="/type/Bool">Bool</a> values for each requested lookup. Non-empty lists always give <code>True</code> when you <a href="/type/Bool">Bool</a>ify them, so the check always succeeds no matter what keys you give it.</p>
<h2 id="Using_[…]_metaoperator_with_a_list_of_lists"><a class="u" href="#___top" title="go to top of document">Using <code>[…]</code> metaoperator with a list of lists</a></h2>
<p>Every now and then, someone gets the idea that they can use <code>[Z]</code> to create the transpose of a list-of-lists:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>matrix</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>X&nbsp;Y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>,</span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>,</span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>1&nbsp;2</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>transpose</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;[</span><span class="keyword operator word perl6fe"><span>Z</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>matrix</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;but&nbsp;so&nbsp;far&nbsp;so&nbsp;good&nbsp;↙</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>transpose</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;[(X&nbsp;a&nbsp;1)&nbsp;(Y&nbsp;b&nbsp;2)]</span><span>&nbsp;</span></span></span></div></pre><p>And everything works fine, until you get an input @matrix with <em>exactly one</em> row (child list):</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>matrix</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>X&nbsp;Y</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>,;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>transpose</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;[</span><span class="keyword operator word perl6fe"><span>Z</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>matrix</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;←&nbsp;WRONG;&nbsp;↙</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>transpose</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;[(X&nbsp;Y)]&nbsp;–&nbsp;not&nbsp;the&nbsp;expected&nbsp;transpose&nbsp;[(X)&nbsp;(Y)]</span><span>&nbsp;</span></span></span></div></pre><p>This happens partly because of the <a href="/language/functions#Slurpy_conventions">single argument rule</a>, and there are other cases when this kind of a generalization may not work.</p>
<h2 id="Using_[~]_for_concatenating_a_list_of_blobs"><a class="u" href="#___top" title="go to top of document">Using [~] for concatenating a list of blobs</a></h2>
<p>The <a href="/routine/~#(Operators)_infix_~"><code>~</code> infix operator</a> can be used to concatenate <a href="/type/Str">Str</a>s <em>or</em> <a href="/type/Blob">Blob</a>s. However, an empty list will <em>always</em> be reduced to an empty <code>Str</code>. This is due to the fact that, in the presence of a list with no elements, the <a href="/language/operators#Reduction_operators">reduction</a> metaoperator returns the <a href="/language/operators#Identity">identity element</a> for the given operator. Identity element for <code>~</code> is an empty string, regardless of the kind of elements the list could be populated with.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Blob</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;([</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>perl</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«&quot;&quot;␤»</span><span>&nbsp;</span></span></span></div></pre><p>This might cause a problem if you attempt to use the result while assuming that it is a Blob:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Blob</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;([</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>decode</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«No&nbsp;such&nbsp;method&nbsp;&#39;decode&#39;&nbsp;for&nbsp;invocant&nbsp;of&nbsp;type&nbsp;&#39;Str&#39;.&nbsp;Did&nbsp;you&nbsp;mean&nbsp;&#39;encode&#39;?␤…»</span><span>&nbsp;</span></span></span></div></pre><p>There are many ways to cover that case. You can avoid <code>[ ]</code> metaoperator altogether:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;…</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Blob</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>|</span></span><span>«</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Blob:0x&lt;&gt;␤»</span><span>&nbsp;</span></span></span></div></pre><p>Alternatively, you can initialize the array with an empty Blob:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Blob</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;…</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;[</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Blob:0x&lt;&gt;␤»</span><span>&nbsp;</span></span></span></div></pre><p>Or you can utilize <a href="/language/operators#infix || "><code>||</code></a> operator to make it use an empty Blob in case the list is empty:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;…</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;[</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>]&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>chunks</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>||</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Blob</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Blob:0x&lt;&gt;␤»</span><span>&nbsp;</span></span></span></div></pre><p>Please note that a similar issue may arise when reducing lists with other operators.</p>
<h1 id="Maps"><a class="u" href="#___top" title="go to top of document">Maps</a></h1>
<h2 id="Beware_of_nesting_Maps_in_sink_context"><a class="u" href="#___top" title="go to top of document">Beware of nesting <code>Map</code>s in sink context</a></h2>
<p>Maps apply an expression to every element of a <a href="/type/List">List</a> and return a <a href="/type/Seq">Seq</a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>þor&nbsp;oðin&nbsp;loki</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>codes</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(3&nbsp;4&nbsp;4)␤»</span></span></span></div></pre><p>Maps are often used as a compact substitute for a loop, performing some kind of action in the map code block:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>þor&nbsp;oðin&nbsp;loki</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>codes</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«3␤4␤4␤»</span></span></span></div></pre><p>The problem might arise when maps are nested and <a href="/language/contexts#index-entry-sink_context">in a sink context</a>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo&nbsp;bar&nbsp;ber</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>comb</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«»</span></span></span></div></pre><p>You might expect the innermost map to <em>bubble</em> the result up to the outermost map, but it simply does nothing. Maps return <code>Seq</code>s, and in sink context the innermost map will iterate and discard the produced values, which is why it yields nothing.</p>
<p>Simply using <code>say</code> at the beginning of the sentence will save the result from sink context:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo&nbsp;bar&nbsp;ber</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>comb</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«f␤o␤o␤b␤a␤r␤b␤e␤r␤((True&nbsp;True&nbsp;True)&nbsp;(True&nbsp;True&nbsp;True)&nbsp;(True&nbsp;True&nbsp;True))␤»</span></span></span></div></pre><p>However, it will not be working as intended; the first <code>f␤o␤o␤b␤a␤r␤b␤e␤r␤</code> is the result of the innermost <code>say</code>, but then <a href="/routine/say#(Mu)_method_say"><code>say</code> returns a <code>Bool</code></a>, <code>True</code> in this case. Those <code>True</code>s are what get printed by the outermost <code>say</code>, one for every letter. A much better option would be to <code>flat</code>ten the outermost sequence:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo&nbsp;bar&nbsp;ber</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span>(</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>comb</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>b</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>flat</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«f␤o␤o␤b␤a␤r␤b␤e␤r␤»</span></span></span></div></pre><p>Of course, saving <code>say</code> for the result will also produce the intended result, as it will be saving the two nested sequences from void context:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>foo&nbsp;bar&nbsp;ber</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>þ</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>comb</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«&nbsp;((f&nbsp;o&nbsp;o)&nbsp;(b&nbsp;a&nbsp;r)&nbsp;(b&nbsp;e&nbsp;r))»</span></span></span></div></pre><h1 id="Smartmatching"><a class="u" href="#___top" title="go to top of document">Smartmatching</a></h1>
<p>The <a href="/language/operators#index-entry-smartmatch_operator">smartmatch operator</a> shortcuts to the right hand side <em>accepting</em> the left hand side. This may cause some confusion.</p>
<h2 id="Smartmatch_and_WhateverCode"><a class="u" href="#___top" title="go to top of document">Smartmatch and <code>WhateverCode</code></a></h2>
<p>Using <code>WhateverCode</code> in the left hand side of a smartmatch does not work as expected, or at all:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>1&nbsp;2&nbsp;3</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>grep</span></span><span>(&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Cannot&nbsp;use&nbsp;Bool&nbsp;as&nbsp;Matcher&nbsp;with&nbsp;&#39;.grep&#39;.&nbsp;&nbsp;Did&nbsp;you&nbsp;mean&nbsp;to</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;use&nbsp;$_&nbsp;inside&nbsp;a&nbsp;block?␤␤␤»</span><span>&nbsp;</span></span></span></div></pre><p>The error message does not make a lot of sense. It does, however, if you put it in terms of the <code>ACCEPTS</code> method: that code is equivalent to <code>2.ACCEPTS( *.Int )</code>, but <code>*.Int</code> cannot be <a href="/routine/ACCEPTS#(Numeric)_method_ACCEPTS">coerced to <code>Numeric</code></a>, being as it is a <code>Block</code>.</p>
<p>Solution: don&#39;t use <code>WhateverCode</code> in the left hand side of a smartmatch:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>1&nbsp;2&nbsp;3</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>a</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>grep</span></span><span>(&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>&nbsp;);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(2)␤»</span><span>&nbsp;</span></span></span></div></pre>
    </div>
    
    </div>
<footer class="pretty-box yellow">

  <p>This is the deprecated documentation of the Perl 6 language, currently
      known as Raku. Please use
      <a href="https://docs.raku.org"><code>docs.raku.org</code></a> from now on.</p>

  <p>This page has been superseded by <a href="https://docs.raku.org//language/traps">/language/traps</a>.</p>

  <p> This documentation is provided under the terms of the
      <a href="https://raw.githubusercontent.com/perl6/doc/master/LICENSE">Artistic License 2.0</a>.
      The Camelia image is <a href="https://raw.githubusercontent.com/perl6/mu/master/misc/camelia.txt"
        >copyright © 2009 by Larry Wall.</a>
      <!-- CREDITS -->
      <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->

  </p>
</footer>

<script type="text/javascript" src="/js/app.js?v=1"></script>
<script type="text/javascript" src="/js/search.js?v=3"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if (!location.hash || location.hash === "#___top") {
      $('query').focus();
    }
  });
</script>

    </body>
</html>
