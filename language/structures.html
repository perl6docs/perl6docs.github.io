<!doctype html>
<html lang="en">
    <head>
        <title>Data structures</title>
        <meta charset="UTF-8" />
        <style>
        kbd { font-family: "Droid Sans Mono", "Luxi Mono", "Inconsolata", monospace }
        samp { font-family: "Terminus", "Courier", "Lucida Console", monospace }
        u { text-decoration: none }
        .nested {
            margin-left: 3em;
        }
        aside, u { opacity: 0.7 }
        a[id^="fn-"]:target { background: #ff0 }
        </style>
        
        
        <meta name=viewport content="width=device-width, initial-scale=1">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/css/app.css?v=7" media="screen" title="default" />
<noscript> <style> #search { visibility: hidden; } </style> </noscript>

    </head>
    <body class="pod">
    <div id="___top"></div>
    <div id="header" class="pretty-box green">
    <a href="/"
        ><img src="/images/Camelia.svg" alt="»ö«" id="logo" width=62 height=48
        >&nbsp;Perl 6 Documentation</a
    >
    <div id="search" class="ui-widget">
        <div class="green">
            <input placeholder="Loading..." id="query"
                accesskey="f" title="Enter term to search for (hit Esc to focus)" autofocus>
        </div>
        <p id="not-found-message">
            Not in Index (<a href="" id="try-web-search">try site search</a>)
        </p>
    </div>
    <div class="menu">
      <div class="menu-items dark-green"><a class='menu-item darker-green' href='https://perl6.org'><strong>Perl&nbsp;6 homepage</strong></a> 
            <a class="menu-item selected darker-green"
                href="/language.html">
                Language
            </a>
         
            <a class="menu-item "
                href="/type.html">
                Types
            </a>
         
            <a class="menu-item "
                href="/routine.html">
                Routines
            </a>
         
            <a class="menu-item "
                href="/programs.html">
                Programs
            </a>
         
            <a class="menu-item "
                href="https://webchat.freenode.net/?channels=#perl6">
                Chat with us
            </a>
        </div>
    </div>
</div>
<div id="content" class="pretty-box yellow content_Language_structures">

      <div align="right">
        <button title="Edit this page"  class="pencil" onclick="location='https://github.com/perl6/doc/edit/master/doc/Language/structures.pod6'">
        <svg width="14px" height="16px" viewBox="0 0 14 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs></defs>
    <g id="Octicons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="pencil" fill="#000000">
            <path d="M0,12 L0,15 L3,15 L11,7 L8,4 L0,12 L0,12 Z M3,14 L1,14 L1,12 L2,12 L2,13 L3,13 L3,14 L3,14 Z M13.3,4.7 L12,6 L9,3 L10.3,1.7 C10.69,1.31 11.32,1.31 11.71,1.7 L13.3,3.29 C13.69,3.68 13.69,4.31 13.3,4.7 L13.3,4.7 Z" id="Shape"></path>
        </g>
    </g>
</svg>

        </button>
      </div>

    <h1 class='title'>Data structures</h1>
    <p class='subtitle'>How Perl&nbsp;6 deals with data structures and what we can expect from them</p>
    <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
  <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#Scalar_structures">Scalar structures</a></td></tr>
                                   <tr class="toc-level-1"><td class="toc-number">2</td><td class="toc-text"><a href="#Complex_data_structures">Complex data structures</a></td></tr>
                                                                                     <tr class="toc-level-1"><td class="toc-number">3</td><td class="toc-text"><a href="#Functional_structures">Functional structures</a></td></tr>
                                                                                                              <tr class="toc-level-1"><td class="toc-number">4</td><td class="toc-text"><a href="#Defining_and_constraining_data_structures">Defining and constraining data structures</a></td></tr>
                                                                                      <tr class="toc-level-1"><td class="toc-number">5</td><td class="toc-text"><a href="#Infinite_structures_and_laziness">Infinite structures and laziness</a></td></tr>
                                                                                                                                                 <tr class="toc-level-1"><td class="toc-number">6</td><td class="toc-text"><a href="#Introspection">Introspection</a></td></tr>
                                 
</table>
</nav>

    <div class="pod-body">
    <h1 id="Scalar_structures"><a class="u" href="#___top" title="go to top of document">Scalar structures</a></h1>
<p>Some classes do not have any <em>internal</em> structure and to access parts of them, specific methods have to be used. Numbers, strings, and some other monolithic classes are included in that class. They use the <code>$</code> sigil, although complex data structures can also use it.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>just-a-number</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>7</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>just-a-string</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>8</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div></pre><p>There is a <a href="/type/Scalar">Scalar</a> class, which is used internally to assign a default value to variables declared with the <code>$</code> sigil.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>just-a-number</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>333</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>just-a-number</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>VAR</span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>name</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Scalar␤»</span><span>&nbsp;</span></span></span></div></pre><p>Any complex data structure can be <em>scalarized</em> by using the <a href="/type/Any#index-entry-%2524_%28item_contextualizer%29">item contextualizer <code>$</code></a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>,&nbsp;</span><span class="keyword other special-method perl6fe"><span>$</span></span><span>(</span><span class="constant numeric perl6fe"><span>4</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span><span>))[</span><span class="constant numeric perl6fe"><span>3</span></span><span>]</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>VAR</span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>name</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Scalar␤»</span><span>&nbsp;</span></span></span></div></pre><p>However, this means that it will be treated as such in the context they are. You can still access its internal structure.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>,&nbsp;</span><span class="keyword other special-method perl6fe"><span>$</span></span><span>(</span><span class="constant numeric perl6fe"><span>4</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>5</span></span><span>))[</span><span class="constant numeric perl6fe"><span>3</span></span><span>][</span><span class="constant numeric perl6fe"><span>0</span></span><span>]</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«4␤»</span><span>&nbsp;</span></span></span></div></pre><p>An interesting side effect, or maybe intended feature, is that scalarization conserves identity of complex structures.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>WHICH</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Array|93947995146096␤Array|93947995700032␤»</span><span>&nbsp;</span></span></span></div></pre><p>Every time <code>(1, 1)</code> is assigned, the variable created is going to be different in the sense that <code>===</code> will say it is; as it is shown, different values of the internal pointer representation are printed. However</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>);</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>list</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>WHICH</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«List|94674814008432␤List|94674814008432␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this case, <code>$list</code> is using the Scalar sigil and thus will be a <code>Scalar</code>. Any scalar with the same value will be exactly the same, as shown when printing the pointers.</p>
<h1 id="Complex_data_structures"><a class="u" href="#___top" title="go to top of document">Complex data structures</a></h1>
<p>Complex data structures fall in two different broad categories: <a href="/type/Positional">Positional</a>, or list-like and <a href="/type/Associative">Associative</a>, or key-value pair like, according to how you access its first-level elements. In general, complex data structures, including objects, will be a combination of both, with object properties assimilated to key-value pairs. While all objects subclass <a href="/type/Mu">Mu</a>, in general complex objects are instances of subclasses of <a href="/type/Any">Any</a>. While it is theoretically possible to mix in <code>Positional</code> or <code>Associative</code> without doing so, most methods applicable to complex data structures are implemented in <code>Any</code>.</p>
<p>Navigating these complex data structures is a challenge, but Perl&nbsp;6 provides a couple of functions that can be used on them: <a href="/routine/deepmap"><code>deepmap</code></a> and <a href="/routine/duckmap"><code>duckmap</code></a>. While the former will go to every single element, in order, and do whatever the block passed requires,</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;[[</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;[</span><span class="constant numeric perl6fe"><span>3</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span><span>]],[[</span><span class="constant numeric perl6fe"><span>5</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>6</span></span><span>,&nbsp;[</span><span class="constant numeric perl6fe"><span>7</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>8</span></span><span>]]]]</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>deepmap</span></span><span>(&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[[1&nbsp;1&nbsp;[1&nbsp;1]]&nbsp;[1&nbsp;1&nbsp;[1&nbsp;1]]]␤»</span><span>&nbsp;</span></span></span></div></pre><p>which returns <code>1</code> because it goes to the deeper level and applies <code>elems</code> to them, <code>deepmap</code> can perform more complicated operations:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;[[</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>,&nbsp;[</span><span class="constant numeric perl6fe"><span>3</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span><span>]],&nbsp;[[</span><span class="constant numeric perl6fe"><span>5</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>6</span></span><span>,&nbsp;[</span><span class="constant numeric perl6fe"><span>7</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>8</span></span><span>]]]]</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>duckmap</span></span><span class="keyword operator generic perl6fe"><span>:</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>where</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>==</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>array</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«[[1&nbsp;2&nbsp;2]&nbsp;[5&nbsp;6&nbsp;2]]␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this case, it dives into the structure, but returns the element itself if it does not meet the condition in the block (<code>1, 2</code>), returning the number of elements of the array if it does (the two <code>2</code>s at the end of each subarray).</p>
<p>Since <code>deepmap</code> and <code>duckmap</code> are <code>Any</code> methods, they also apply to Associative arrays:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>%</span></span><span>(&nbsp;</span><span class="string pair key perl6fe"><span>first&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;[</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>],&nbsp;</span><span class="string pair key perl6fe"><span>second&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;[</span><span class="constant numeric perl6fe"><span>3</span></span><span>,</span><span class="constant numeric perl6fe"><span>4</span></span><span>]&nbsp;)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>deepmap</span></span><span>(&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«{first&nbsp;=&gt;&nbsp;[1&nbsp;1],&nbsp;second&nbsp;=&gt;&nbsp;[1&nbsp;1]}␤»</span><span>&nbsp;</span></span></span></div></pre><p>Only in this case, they will be applied to every list or array that is a value, leaving the keys alone.</p>
<p><code>Positional</code> and <code>Associative</code> can be turned into each other.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>%</span></span><span>(&nbsp;</span><span class="string pair key perl6fe"><span>first&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;[</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>],&nbsp;</span><span class="string pair key perl6fe"><span>second&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;[</span><span class="constant numeric perl6fe"><span>3</span></span><span>,</span><span class="constant numeric perl6fe"><span>4</span></span><span>]&nbsp;)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>list</span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«second&nbsp;=&gt;&nbsp;[3&nbsp;4]␤»</span><span>&nbsp;</span></span></span></div></pre><p>However, in this case, and for Rakudo &gt;= 2018.05, it will return a different value every time it runs. A hash will be turned into a list of the key-value pairs, but it is guaranteed to be disordered. You can also do the operation in the opposite direction, as long as the list has an even number of elements (odd number will result in an error):</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c&nbsp;d</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Hash</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«{a&nbsp;=&gt;&nbsp;b,&nbsp;c&nbsp;=&gt;&nbsp;d}␤»</span><span>&nbsp;</span></span></span></div></pre><p>But</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>a&nbsp;b&nbsp;c&nbsp;d</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Hash</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>kv</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(c&nbsp;d&nbsp;a&nbsp;b)␤»</span><span>&nbsp;</span></span></span></div></pre><p>will obtain a different value every time you run it; <a href="/type/Pair#method_kv"><code>kv</code></a> turns every <code>Pair</code> into a list.</p>
<p>Complex data structures are also generally <a href="/type/Iterable">Iterable</a>. Generating an <a href="/routine/iterator">iterator</a> out of them will allow the program to visit the first level of the structure, one by one:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>א</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>ס</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«א␤ב␤ג␤ד␤ה␤ו␤ז␤ח␤ט␤י␤ך␤כ␤ל␤ם␤מ␤ן␤נ␤ס␤»</span><span>&nbsp;</span></span></span></div></pre><p><code>&#39;א&#39;..&#39;ס&#39;</code> is a <a href="/type/Range">Range</a>, a complex data structure, and with <code>for</code> in front it will iterate until the list is exhausted. You can use <code>for</code> on your complex data structures by overriding the <a href="/routine/iterator">iterator</a> method (from role <code>Iterable</code>):</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>class</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>SortedArray</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>is</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Array</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>iterator</span></span><span>()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>iterator</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>thing</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>SortedArray</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>([</span><span class="constant numeric perl6fe"><span>3</span></span><span>,</span><span class="constant numeric perl6fe"><span>2</span></span><span>,</span><span class="constant numeric perl6fe"><span>1</span></span><span>,</span><span class="constant numeric perl6fe"><span>4</span></span><span>]);</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>thing</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«1␤2␤3␤4␤»</span><span>&nbsp;</span></span></span></div></pre><p><code>for</code> calls directly the <code>iterator</code> method on <code>@thing</code> making it return the elements of the array in order. Much more on <a href="/language/iterating">iterating on the page devoted to it</a>.</p>
<h1 id="Functional_structures"><a class="u" href="#___top" title="go to top of document">Functional structures</a></h1>
<p>Perl&nbsp;6 is a functional language and, as such, functions are first-class <em>data</em> structures. Functions follow the <a href="/type/Callable">Callable</a> role, which is the 4th element in the quartet of fundamental roles. <a href="/type/Callable">Callable</a> goes with the <code>&amp;</code> sigil, although in most cases it is elided for the sake of simplicity; this sigil elimination is always allowed in the case of <code>Callables</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>&amp;</span></span><span class="variable other identifier perl6fe"><span>a-func</span></span></span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;(</span><span class="keyword operator generic perl6fe"><span>^</span></span><span>(</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="support class twigil perl6fe"><span>^</span></span><span class="variable other identifier perl6fe"><span>þ</span></span></span><span>))</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Seq</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>a-func</span></span><span>(</span><span class="constant numeric perl6fe"><span>3</span></span><span>),&nbsp;</span><span class="routine name perl6fe"><span>a-func</span></span><span>(</span><span class="constant numeric perl6fe"><span>7</span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(0&nbsp;1&nbsp;2)(0&nbsp;1&nbsp;2&nbsp;3&nbsp;4&nbsp;5&nbsp;6)␤»</span><span>&nbsp;</span></span></span></div></pre><p><a href="/type/Block">Block</a>s are the simplest callable structures, since <code>Callable</code>s cannot be instantiated. In this case we implement a block that logs events and can retrieve them:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>event</span></span></span><span>,&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>key</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>&nbsp;&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="storage modifier declarator perl6fe"><span>state</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>store</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control conditional perl6fe"><span>if</span></span><span>&nbsp;(&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>event</span></span></span><span>&nbsp;)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>store</span></span></span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>DateTime</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(&nbsp;</span><span class="routine name perl6fe"><span>now</span></span><span>&nbsp;)&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>event</span></span></span><span>;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="keyword control conditional perl6fe"><span>else</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>store</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>keys</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>grep</span></span><span>(</span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>key</span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;)</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Stuff</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>More&nbsp;stuff</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2018-05-28</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(Stuff&nbsp;More&nbsp;stuff)␤»</span><span>&nbsp;</span></span></span></div></pre><p>A <code>Block</code> has a <a href="/type/Signature">Signature</a>, in this case two arguments, the first of which is the event that is going to be logged, and the second is the key to retrieve the events. They will be used in an independent way, but its intention is to showcase the use of a <a href="/syntax/state">state variable</a> that is kept from every invocation to the next. This state variable is encapsulated within the block, and cannot be accessed from outside except by using the simple API the block provides: calling the block with a second argument. The two first invocations log two events, the third invocation at the bottom of the example use this second type of call to retrieve the stored values. <code>Block</code>s can be cloned:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>clogger</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>clone</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>clogger</span></span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Clone&nbsp;stuff</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>clogger</span></span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>More&nbsp;clone&nbsp;stuff</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>clogger</span></span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2018-05-28</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(Clone&nbsp;stuff&nbsp;More&nbsp;clone&nbsp;stuff)␤»</span><span>&nbsp;</span></span></span></div></pre><p>And cloning will reset the state variable; instead of cloning, we can create <em>façades</em> that change the API. For instance, eliminate the need to use <code>Nil</code> as first argument to retrieve the log for a certain date:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>gets-logs</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>assuming</span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span>(</span><span class="keyword other special-method perl6fe"><span>&nbsp;%</span></span><span>(</span><span class="string pair key perl6fe"><span>changing&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Logs</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>)&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>gets-logs</span></span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2018-05-28</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«({changing&nbsp;=&gt;&nbsp;Logs}&nbsp;Stuff&nbsp;More&nbsp;stuff)␤»</span><span>&nbsp;</span></span></span></div></pre><p><a href="/type/Block#%28Code%29_method_assuming"><code>assuming</code></a> wraps around a block call, giving a value (in this case, <code>Nil</code>) to the arguments we need, and passing on the arguments to the other arguments we represent using <code>*</code>. In fact, this corresponds to the natural language statement &quot;We are calling <code>$logger</code> <em>assuming</em> the first argument is <code>Nil</code>&quot;. We can slightly change the appearance of these two Blocks to clarify they are actually acting on the same block:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>logger</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>clone</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>logs</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>assuming</span></span><span>(&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>,&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span class="support function perl6fe"><span class="keyword operator colon perl6fe"><span>::</span></span><span>get</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>assuming</span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Nil</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>logs</span></span><span>(</span><span>&nbsp;</span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>an&nbsp;array</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>logs</span></span><span>(</span><span class="keyword other special-method perl6fe"><span>&nbsp;%</span></span><span>(</span><span class="string pair key perl6fe"><span>key&nbsp;</span></span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>)&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span class="support function perl6fe"><span class="keyword operator colon perl6fe"><span>::</span></span><span>get</span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2018-05-28</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div></pre><p>Although <code>::</code> is generally used for invocation of class methods, it is actually a valid part of the name of a variable. In this case we use them conventionally to simply indicate <code>$Logger::logs</code> and <code>$Logger::get</code> are actually calling <code>$Logger</code>, which we have capitalized to use a class-like appearance. The point of this tutorial is that using functions as first-class citizens, together with the use of state variables, allows the use of certain interesting design patterns such as this one.</p>
<p>As such first class data structures, callables can be used anywhere another type of data can.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>regex-check</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;(</span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>alnum</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>,</span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>alpha</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>,</span><span>&nbsp;</span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span class="string regexp perl6fe"><span class="meta property regexp perl6fe"><span class="punctuation delimiter property regexp perl6fe"><span>&lt;</span></span><span class="variable other identifier regexname perl6fe"><span>punct</span></span><span class="punctuation delimiter property regexp perl6fe"><span>&gt;</span></span></span></span><span class="punctuation definition regexp perl6fe"><span>/</span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>regex-check</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>map</span></span><span class="keyword operator generic perl6fe"><span>:</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>33af</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>~~</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(｢3｣␤&nbsp;alnum&nbsp;=&gt;&nbsp;｢3｣&nbsp;｢a｣␤&nbsp;alpha&nbsp;=&gt;&nbsp;｢a｣&nbsp;Nil)␤»</span><span>&nbsp;</span></span></span></div></pre><p>Regexes are actually a type of callable:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>/</span></span><span class="routine name perl6fe"><span>regex</span></span><span class="keyword operator generic perl6fe"><span>/</span><span>.</span></span><span class="storage modifier type constraints perl6fe"><span>does</span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Callable</span></span><span>&nbsp;);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«True␤»</span><span>&nbsp;</span></span></span></div></pre><p>And in the example above we are calling regexes stored in an array, and applying them to a string literal.</p>
<p>Callables are composed by using the <a href="/language/operators#infix_%25E2%2588%2598">function composition operator ∘</a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>typer</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>-&gt;</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>thing</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>thing</span></span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>name</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>&nbsp;→&nbsp;</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>thing</span></span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>withtype</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>logs</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>∘</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>typer</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>withtype</span></span><span>(&nbsp;</span><span class="support type perl6fe"><span>Pair</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>new</span></span><span>(&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>left</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>,&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>right</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;)&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span>::</span><span class="routine name perl6fe"><span>withtype</span></span><span>(&nbsp;¾&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>Logger</span></span></span><span class="support function perl6fe"><span class="keyword operator colon perl6fe"><span>::</span></span><span>get</span></span><span>(&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>2018-05-28</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(Pair&nbsp;→&nbsp;left&nbsp;right&nbsp;Rat&nbsp;→&nbsp;0.75)␤»</span><span>&nbsp;</span></span></span></div></pre><p>We are composing <code>$typer</code> with the <code>$Logger::logs</code> function defined above, obtaining a function that logs an object preceded by its type, which can be useful for filtering, for instance. <code>$Logger::withtype</code> is, in fact, a complex data structure composed of two functions which are applied in a serial way, but every one of the callables composed can keep state, thus creating complex transformative callables, in a design pattern that is similar to object composition in the object oriented realm. You will have to choose, in every particular case, what is the programming style which is most suitable for your problem.</p>
<h1 id="Defining_and_constraining_data_structures"><a class="u" href="#___top" title="go to top of document">Defining and constraining data structures</a></h1>
<p>Perl&nbsp;6 has different ways of defining data structures, but also many ways to constrain them so that you can create the most adequate data structure for every problem domain. <a href="/routine/but"><code>but</code></a>, for example, mixes roles or values into a value or a variable:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>%</span></span><span>(</span><span class="constant numeric perl6fe"><span>2</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>)&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>but</span></span><span>&nbsp;</span><span class="support type perl6fe"><span>Associative</span></span><span>[</span><span class="support type perl6fe"><span>Int</span></span><span>,&nbsp;</span><span class="support type perl6fe"><span>Int</span></span><span>];</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>name</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Hash+{Associative[Int,&nbsp;Int]}␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="storage modifier type constraints perl6fe"><span>of</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«Associative[Int,&nbsp;Int]␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="constant numeric perl6fe"><span>3</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span class="span keyword operator array words perl6fe"><span>&lt;</span></span><span class="string array words perl6fe"><span>thing</span></span><span class="span keyword operator array words perl6fe"><span>&gt;</span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>not-scalar</span></span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«{2&nbsp;=&gt;&nbsp;3,&nbsp;3&nbsp;=&gt;&nbsp;4,&nbsp;thing&nbsp;=&gt;&nbsp;3}␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this case, <code>but</code> is mixing in the <code>Associative[Int, Int]</code> role; please note that we are using binding so that the type of the variable is the one defined, and not the one imposed by the <code>%</code> sigil; this mixed-in role shows in the <code>name</code> surrounded by curly braces. What does that really mean? That role includes two methods, <code>of</code> and <code>keyof</code>; by mixing the role in, the new <code>of</code> will be called (the old <code>of</code> would return <code>Mu</code>, which is the default value type for Hashes). However, that is all it does. It is not really changing the type of the variable, as you can see since we are using any kind of key and values in the next few statements.</p>
<p>However, we can provide new functionality to a variable using this type of mixin:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>role</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>Lastable</span></span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="storage type declarator type perl6fe"><span>method</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>last</span></span><span>()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="variable language perl6fe"><span>self</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>reverse</span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>]</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>hash-plus</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>:=</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>%</span></span><span>(&nbsp;</span><span class="constant numeric perl6fe"><span>3</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>33</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>4</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>=&gt;</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>44</span></span><span>)&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>but</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>Lastable</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>hash-plus</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>sort</span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«3&nbsp;=&gt;&nbsp;33␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>hash-plus</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>last</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«4&nbsp;=&gt;&nbsp;44␤»</span><span>&nbsp;</span></span></span></div></pre><p>In <code>Lastable</code> we use the universal <code>self</code> variable to refer to whatever object this particular role is mixed in; in this case it will contain the hash it is mixed in with; it will contain something else (and possibly work some other way) in other case. This role will provide the <code>last</code> method to any variable it&#39;s mixed with, providing new, attachable, functionalities to <em>regular</em> variables. Roles can even be <a href="/language/objects#Mixins_of_roles">added to existing variables using the <code>does</code> keyword</a>.</p>
<p><a href="/language/typesystem#subset">Subsets</a> can also be used to constrain the possible values a variable might hold; they are Perl&nbsp;6 attempt at <a href="https://en.wikipedia.org/wiki/Gradual_typing">gradual typing</a>; it is not a full attempt, because subsets are not really types in a strict sense, but they allow runtime type checking. It adds type-checking functionality to regular types, so it helps create a richer type system, allowing things like the one shown in this code:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="meta class perl6fe"><span class="storage type class perl6fe"><span>subset</span></span><span>&nbsp;</span><span class="entity name type class perl6fe"><span>OneOver</span></span></span><span>&nbsp;</span><span class="storage modifier type constraints perl6fe"><span>where</span></span><span>&nbsp;(</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator generic perl6fe"><span>/</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>)</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>Int</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>==</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span class="keyword operator generic perl6fe"><span>/</span></span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>_</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>OneOver</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>one-fraction</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;⅓;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>one-fraction</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«0.333333␤»</span><span>&nbsp;</span></span></span></div></pre><p>On the other hand, <code>my OneOver $ = ⅔;</code> will cause a type-check error. Subsets can use <code>Whatever</code>, that is, <code>*</code>, to refer to the argument; but this will be instantiated every time you use it to a different argument, so if we use it twice in the definition we would get an error. In this case we are using the topic single variable, <code>$_</code>, to check the instantiation. Subsetting can be done directly, without the need of declaring it, in <a href="/language/typesystem#subset">signatures</a>.</p>
<h1 id="Infinite_structures_and_laziness"><a class="u" href="#___top" title="go to top of document">Infinite structures and laziness</a></h1>
<p>It might be assumed that all the data contained in a data structure is actually <em>there</em>. That is not necessarily the case: in many cases, for efficiency reasons or simply because it is not possible, the elements contained in a data structure only jump into existence when they are actually needed. This computation of items as they are needed is called <a href="/language/glossary#Reify">reification</a>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;A&nbsp;list&nbsp;containing&nbsp;infinite&nbsp;number&nbsp;of&nbsp;un-reified&nbsp;Fibonacci&nbsp;numbers:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>fibonacci</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>,&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>+</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>*</span></span><span>&nbsp;…&nbsp;∞;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;We&nbsp;reify&nbsp;10&nbsp;of&nbsp;them,&nbsp;looking&nbsp;up&nbsp;the&nbsp;first&nbsp;10&nbsp;of&nbsp;them&nbsp;with&nbsp;array&nbsp;index:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>fibonacci</span></span></span><span>[</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>];&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(1&nbsp;1&nbsp;2&nbsp;3&nbsp;5&nbsp;8&nbsp;13&nbsp;21&nbsp;34&nbsp;55)␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;We&nbsp;reify&nbsp;5&nbsp;more:&nbsp;10&nbsp;we&nbsp;already&nbsp;reified&nbsp;on&nbsp;previous&nbsp;line,&nbsp;and&nbsp;we&nbsp;need&nbsp;to</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;reify&nbsp;5&nbsp;more&nbsp;to&nbsp;get&nbsp;the&nbsp;15th&nbsp;element&nbsp;at&nbsp;index&nbsp;14.&nbsp;Even&nbsp;though&nbsp;we&nbsp;need&nbsp;only</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;the&nbsp;15th&nbsp;element,&nbsp;the&nbsp;original&nbsp;Seq&nbsp;still&nbsp;has&nbsp;to&nbsp;reify&nbsp;all&nbsp;previous&nbsp;elements:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>fibonacci</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>14</span></span><span>];&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«987␤»</span><span>&nbsp;</span></span></span></div></pre><p>Above we were reifying a <a href="/type/Seq">Seq</a> we created with the <a href="/language/operators#index-entry-%25E2%2580%25A6_operators">sequence operator</a>, but other data structures use the concept as well. For example, an un-reified <a href="/type/Range">Range</a> is just the two end points. In some languages, calculating the sum of a huge range is a lengthy and memory-consuming process, but Perl&nbsp;6 calculates it instantly:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>sum</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>&nbsp;</span><span class="keyword operator multi-symbol perl6fe"><span>..</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>9_999_999_999_999</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«49999999999995000000000000␤»</span><span>&nbsp;</span></span></span></div></pre><p>Why? Because the sum can be calculated <em>without</em> reifying the Range; that is, without figuring out all the elements it contains. This is why this feature exists. You can even make your own things reify-on-demand, using <a href="/syntax/gather take"><code>gather</code> and <code>take</code></a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>seq</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>gather</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>About&nbsp;to&nbsp;make&nbsp;1st&nbsp;element</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>take</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>1</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>About&nbsp;to&nbsp;make&nbsp;2nd&nbsp;element</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>take</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>2</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Let&#39;s&nbsp;reify&nbsp;an&nbsp;element!</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>seq</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Let&#39;s&nbsp;reify&nbsp;more!</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>seq</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>1</span></span><span>];</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Both&nbsp;are&nbsp;reified&nbsp;now!</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>seq</span></span></span><span>[</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>2</span></span><span>];</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Let&#39;s&nbsp;reify&nbsp;an&nbsp;element!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;About&nbsp;to&nbsp;make&nbsp;1st&nbsp;element</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;1</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Let&#39;s&nbsp;reify&nbsp;more!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;About&nbsp;to&nbsp;make&nbsp;2nd&nbsp;element</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;2</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Both&nbsp;are&nbsp;reified&nbsp;now!</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;(1&nbsp;2)</span><span>&nbsp;</span></span></span></div></pre><p>Following the output above, you can see the print statements <em>inside</em> the <code>gather</code> got executed only when we reified the individual elements while looking up an element. Also note that the elements got reified just once. When we printed the same elements again on the last line of the example, the messages inside <code>gather</code> was no longer printed. This is because the construct used already-reified elements from the <a href="/type/Seq">Seq</a>&#39;s cache.</p>
<p>Note that above we assigned the <code>gather</code> to a <a href="/type/Scalar">Scalar</a> container (the <code>$</code> sigil), not the <a href="/type/Positional">Positional</a> one (the <code>@</code> sigil). The reason is that the <code>@</code>-sigiled variables are <em>mostly eager</em>. What this means is they <em>reify the stuff assigned to them</em> right away <em>most of the time</em>. The only time they don&#39;t do it is when the items are known to be <a href="/routine/is-lazy"><code>is-lazy</code></a>, like our sequence generated with infinity as the end point. Were we to assign the <code>gather</code> to a <code>@</code>-variable, the <code>say</code> statements inside of it would&#39;ve been printed right away.</p>
<p>Another way to fully-reify a list, is by calling <a href="/routine/elems"><code>.elems</code></a> on it. This is the reason why checking whether a list contains any items is best done by using <code>.Bool</code> method (or just using <code>if @array { … }</code>), since you don&#39;t need to reify <em>all</em> the elements to find out if there are <code>any</code> of them.</p>
<p>There are times where you <em>do</em> want to fully-reify a list before doing something. For example, the <a href="/type/IO::Handle#method_lines"><code>IO::Handle.lines</code></a> returns a <a href="/type/Seq">Seq</a>. The following code contains a bug; keeping reification in mind, try to spot it:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>/tmp/bar</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>open</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>close</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];</span></span></div></pre><p>We open a <a href="/type/IO::Handle">filehandle</a>, then assign return of <a href="/type/IO::Handle#method_lines"><code>.lines</code></a> to a <a href="/type/Scalar">Scalar</a> variable, so the returned <a href="/type/Seq">Seq</a> does not get reified right away. We then <a href="/routine/close"><code>close</code></a> the filehandle, and try to print an element from <code>$lines</code>.</p>
<p>The bug in the code is by the time we reify the <code>$lines</code> <a href="/type/Seq">Seq</a> on the last line, we&#39;ve <em>already closed</em> the filehandle. When the <code>Seq&#39;s</code> iterator tries to generate the item we&#39;ve requested, it results in the error about attempting to read from a closed handle. So, to fix the bug we can either assign to a <code>@</code>-sigiled variable or call <a href="/routine/elems"><code>.elems</code></a> on <code>$lines</code> before closing the handle:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>/tmp/bar</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>open</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>close</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>@</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;no&nbsp;problem!</span><span>&nbsp;</span></span></span></div></pre><p>We can also use any function whose side effect is reification, like <code>.elems</code> mentioned above:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>/tmp/bar</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>open</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Read&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>lines</span><span class="keyword operator dot perl6fe"><span>.</span></span><span class="support function perl6fe"><span>elems</span></span><span>()</span></span><span>&nbsp;lines</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;reifying&nbsp;before&nbsp;closing&nbsp;handle</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>close</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;no&nbsp;problem!</span><span>&nbsp;</span></span></span></div></pre><p>Using <a href="/routine/eager">eager</a> will also reify the whole sequence:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>/tmp/bar</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support type perl6fe"><span>IO</span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>open</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>eager</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>lines</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Uses&nbsp;eager&nbsp;for&nbsp;reification.</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>close</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>fh</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>lines</span></span></span><span>[</span><span class="constant numeric perl6fe"><span>0</span></span><span>];</span></span></div></pre><h1 id="Introspection"><a class="u" href="#___top" title="go to top of document">Introspection</a></h1>
<p>Languages that allow <a href="https://en.wikipedia.org/wiki/Type_introspection">introspection</a> like Perl&nbsp;6 have functionalities attached to the type system that let the developer access container and value metadata. This metadata can be used in a program to carry out different actions depending on their value. As it is obvious from the name, metadata are extracted from a value or container via the metaclass.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>any-object</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>random&nbsp;object</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>metadata</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>any-object</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>HOW</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>metadata</span></span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="routine name perl6fe"><span>mro</span></span><span>;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«((ClassHOW)&nbsp;(Any)&nbsp;(Mu))␤»</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>metadata</span></span></span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>can</span></span><span>(&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>metadata</span></span></span><span>,&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>uc</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>&nbsp;);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(uc&nbsp;uc)␤»</span><span>&nbsp;</span></span></span></div></pre><p>With the first <code>say</code> we show the class hierarchy of the metamodel class, which in this case is <a href="/type/Metamodel::ClassHOW">Metamodel::ClassHOW</a>. It inherits directly from <code>Any</code>, meaning any method there can be used; it also mixes in several roles which can give you information about the class structure and functions. But one of the methods of that particular class is <a href="/type/Metamodel::ClassHOW#method_can"><code>can</code></a>, which we can use to look up whether the object can use the <code>uc</code> (uppercase) method, which it obviously can. However, it might not be so obvious in some other cases, when roles are mixed in directly into a variable. For instance, in the <a href="#Defining_and_constraining_data_structures">case of <code>%hash-plus</code> defined above</a>:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>%</span></span><span class="variable other identifier perl6fe"><span>hash-plus</span></span></span><span class="keyword operator generic perl6fe"><span>.</span><span>^</span></span><span class="support function perl6fe"><span>can</span></span><span>(</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>last</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>);&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«(last)␤»</span><span>&nbsp;</span></span></span></div></pre><p>In this case we are using the <em>syntactic sugar</em> for <code>HOW.method</code>, <code>^method</code>, to check if your data structure responds to that method; the output, which shows the name of the methods that match, certifies that we can use it.</p>
<p>See also <a href="https://perl6advent.wordpress.com/2015/12/19/day-19-introspection/">this article on class introspection</a> on how to access class properties and methods, and use it to generate test data for a class; this <a href="https://perl6advent.wordpress.com/2010/12/22/day-22-the-meta-object-protocol/">Advent Calendar article describes the meta-object protocol</a> extensively.</p>

    </div>
    
    </div>
<footer class="pretty-box yellow">
  <p>
      From <a href='https://github.com/perl6/doc/blob/master/doc/Language/structures.pod6'>Language/structures.pod6</a> at <a href='https://github.com/perl6/doc'>perl6/doc on GitHub</a>, commit <a href="https://github.com/perl6/doc/commit/29952fcf"><span id="footer-commit">29952fcf</span></a>.
      <br/>
      This is a work in progress to document Perl 6, and known to be
      incomplete.
      <br/>
      <a href="https://github.com/perl6/doc/blob/master/CONTRIBUTING.md#reporting-bugs">Please report any issues</a> or <a href='https://github.com/perl6/doc/edit/master/doc/Language/structures.pod6'>edit this page</a>.
      Your contribution is appreciated.
      <br/>
      Generated on 2019-05-11T17:07:19Z
  </p>
  <p>
      This documentation is provided under the terms of the
      <a href="https://raw.githubusercontent.com/perl6/doc/master/LICENSE">Artistic License 2.0</a>.
      The Camelia image is <a href="https://raw.githubusercontent.com/perl6/mu/master/misc/camelia.txt"
        >copyright © 2009 by Larry Wall.</a>
      <!-- CREDITS -->
      <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->

  </p>
</footer>

<script type="text/javascript" src="/js/app.js?v=1"></script>
<script type="text/javascript" src="/js/search.js?v=3"></script>

    </body>
</html>
