<!doctype html>
<html lang="en">
    <head>
        <title>Phasers</title>
        <meta charset="UTF-8" />
        <style>
        kbd { font-family: "Droid Sans Mono", "Luxi Mono", "Inconsolata", monospace }
        samp { font-family: "Terminus", "Courier", "Lucida Console", monospace }
        u { text-decoration: none }
        .nested {
            margin-left: 3em;
        }
        aside, u { opacity: 0.7 }
        a[id^="fn-"]:target { background: #ff0 }
        </style>
        
        
        <meta name=viewport content="width=device-width, initial-scale=1">
<link rel="icon" href="/favicon.ico" type="image/x-icon" />
<link rel="stylesheet" type="text/css" href="/css/app.css?v=7" media="screen" title="default" />
<noscript> <style> #search { visibility: hidden; } </style> </noscript>

    </head>
    <body class="pod">
    <div id="___top"></div>
    <div id="header" class="pretty-box green">
  <a href="/"
    ><img
      src="/images/Camelia.svg"
      alt="»ö«"
      id="logo"
      width="62"
      height="48"
    />&nbsp;Perl 6 Documentation</a
  >
  <div id="search" class="ui-widget">
    <div class="green">
      <input
        placeholder="Loading..."
        id="query"
        accesskey="f"
        title="Enter term to search for (hit Esc to focus)"
      />
    </div>
    <p id="not-found-message">
      Not in Index (<a href="" id="try-web-search">try site search</a>)
    </p>
  </div>
  <div class="menu">
    <div class="menu-items dark-green"><a class='menu-item darker-green' href='https://perl6.org'><strong>Perl&nbsp;6 homepage</strong></a>  <a class="menu-item selected darker-green" href="/language.html"> Language </a> <a class="menu-item " href="/type.html"> Types </a> <a class="menu-item " href="/routine.html"> Routines </a> <a class="menu-item " href="/programs.html"> Programs </a> <a class="menu-item " href="https://webchat.freenode.net/?channels=#perl6"> Chat with us </a></div>
  </div>
</div>
<!-- please make sure these two CAPITALIZED variables stay there -->

<div id="content" class="pretty-box yellow content__language_phasers">

    <h1 class='title'>Phasers</h1>
    <p class='subtitle'>Program execution phases and corresponding phaser blocks</p>
    <nav class="indexgroup">
<table id="TOC">
<caption><h2 id="TOC_Title">Table of Contents</h2></caption>
     <tr class="toc-level-1"><td class="toc-number">1</td><td class="toc-text"><a href="#Phasers">Phasers</a></td></tr>
                                                                                                             <tr class="toc-level-2"><td class="toc-number">1.1</td><td class="toc-text"><a href="#Execution_order">Execution order</a></td></tr>
                                                <tr class="toc-level-1"><td class="toc-number">2</td><td class="toc-text"><a href="#Program_execution_phasers">Program execution phasers</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">2.1</td><td class="toc-text"><a href="#BEGIN">BEGIN</a></td></tr>
             <tr class="toc-level-2"><td class="toc-number">2.2</td><td class="toc-text"><a href="#CHECK">CHECK</a></td></tr>
        <tr class="toc-level-2"><td class="toc-number">2.3</td><td class="toc-text"><a href="#INIT">INIT</a></td></tr>
                 <tr class="toc-level-2"><td class="toc-number">2.4</td><td class="toc-text"><a href="#END">END</a></td></tr>
         <tr class="toc-level-1"><td class="toc-number">3</td><td class="toc-text"><a href="#Block_phasers">Block phasers</a></td></tr>
       <tr class="toc-level-2"><td class="toc-number">3.1</td><td class="toc-text"><a href="#ENTER">ENTER</a></td></tr>
          <tr class="toc-level-2"><td class="toc-number">3.2</td><td class="toc-text"><a href="#LEAVE">LEAVE</a></td></tr>
                                                 <tr class="toc-level-2"><td class="toc-number">3.3</td><td class="toc-text"><a href="#KEEP">KEEP</a></td></tr>
  <tr class="toc-level-2"><td class="toc-number">3.4</td><td class="toc-text"><a href="#UNDO">UNDO</a></td></tr>
  <tr class="toc-level-2"><td class="toc-number">3.5</td><td class="toc-text"><a href="#PRE">PRE</a></td></tr>
                   <tr class="toc-level-2"><td class="toc-number">3.6</td><td class="toc-text"><a href="#POST">POST</a></td></tr>
                                      <tr class="toc-level-1"><td class="toc-number">4</td><td class="toc-text"><a href="#Loop_phasers">Loop phasers</a></td></tr>
       <tr class="toc-level-2"><td class="toc-number">4.1</td><td class="toc-text"><a href="#FIRST">FIRST</a></td></tr>
  <tr class="toc-level-2"><td class="toc-number">4.2</td><td class="toc-text"><a href="#NEXT">NEXT</a></td></tr>
                   <tr class="toc-level-2"><td class="toc-number">4.3</td><td class="toc-text"><a href="#LAST">LAST</a></td></tr>
        <tr class="toc-level-1"><td class="toc-number">5</td><td class="toc-text"><a href="#Exception_handling_phasers">Exception handling phasers</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">5.1</td><td class="toc-text"><a href="#CATCH">CATCH</a></td></tr>
  <tr class="toc-level-2"><td class="toc-number">5.2</td><td class="toc-text"><a href="#CONTROL">CONTROL</a></td></tr>
                         <tr class="toc-level-1"><td class="toc-number">6</td><td class="toc-text"><a href="#Object_phasers">Object phasers</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">6.1</td><td class="toc-text"><a href="#COMPOSE_(Not_yet_implemented)">COMPOSE (Not yet implemented)</a></td></tr>
  <tr class="toc-level-1"><td class="toc-number">7</td><td class="toc-text"><a href="#Asynchronous_phasers">Asynchronous phasers</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">7.1</td><td class="toc-text"><a href="#LAST">LAST</a></td></tr>
                   <tr class="toc-level-2"><td class="toc-number">7.2</td><td class="toc-text"><a href="#QUIT">QUIT</a></td></tr>
           <tr class="toc-level-2"><td class="toc-number">7.3</td><td class="toc-text"><a href="#CLOSE">CLOSE</a></td></tr>
  <tr class="toc-level-1"><td class="toc-number">8</td><td class="toc-text"><a href="#DOC_phasers">DOC phasers</a></td></tr>
 <tr class="toc-level-2"><td class="toc-number">8.1</td><td class="toc-text"><a href="#DOC">DOC</a></td></tr>
            
</table>
</nav>

    <div class="pod-body">
    <p>The lifetime (execution timeline) of a program is broken up into phases. A <em>phaser</em> is a block of code called during a specific execution phase.</p>
<h1 id="Phasers"><a class="u" href="#___top" title="go to top of document">Phasers</a></h1>
<p>A phaser block is just a trait of the closure containing it, and is automatically called at the appropriate moment. These auto-called blocks are known as <em>phasers</em>, since they generally mark the transition from one phase of computing to another. For instance, a <code>CHECK</code> block is called at the end of compiling a compilation unit. Other kinds of phasers can be installed as well; these are automatically called at various times as appropriate, and some of them respond to various control exceptions and exit values. For instance, some phasers might be called if the exit from a block is successful or not, with <em>success</em> in this case defined by returning with a defined value or list without any <code>Failure</code> or exception in the process.</p>
<p>Here is a summary:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;*&nbsp;at&nbsp;compile&nbsp;time,&nbsp;as&nbsp;soon&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CHECK</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;*&nbsp;at&nbsp;compile&nbsp;time,&nbsp;as&nbsp;late&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>INIT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;*&nbsp;at&nbsp;runtime,&nbsp;as&nbsp;soon&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>END</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;runtime,&nbsp;as&nbsp;late&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>DOC</span></span><span>&nbsp;[</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="keyword control closure trait perl6fe"><span>CHECK</span></span><span class="keyword operator generic perl6fe"><span>|</span></span><span class="keyword control closure trait perl6fe"><span>INIT</span></span><span>]&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;only&nbsp;in&nbsp;documentation&nbsp;mode</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>ENTER</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;*&nbsp;at&nbsp;every&nbsp;block&nbsp;entry&nbsp;time,&nbsp;repeats&nbsp;on&nbsp;loop&nbsp;blocks.</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;block&nbsp;exit&nbsp;time&nbsp;(even&nbsp;stack&nbsp;unwinds&nbsp;from&nbsp;exceptions)</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>KEEP</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;successful&nbsp;block&nbsp;exit,&nbsp;part&nbsp;of&nbsp;LEAVE&nbsp;queue</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>UNDO</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;unsuccessful&nbsp;block&nbsp;exit,&nbsp;part&nbsp;of&nbsp;LEAVE&nbsp;queue</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>FIRST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;initialization&nbsp;time,&nbsp;before&nbsp;any&nbsp;ENTER</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>NEXT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;continuation&nbsp;time,&nbsp;before&nbsp;any&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LAST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;termination&nbsp;time,&nbsp;after&nbsp;any&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>PRE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;assert&nbsp;precondition&nbsp;at&nbsp;every&nbsp;block&nbsp;entry,&nbsp;before&nbsp;ENTER</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>POST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;assert&nbsp;postcondition&nbsp;at&nbsp;every&nbsp;block&nbsp;exit,&nbsp;after&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CATCH</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;exceptions,&nbsp;before&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>CONTROL</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;control&nbsp;exceptions,&nbsp;before&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LAST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;supply&nbsp;tapped&nbsp;by&nbsp;whenever-block&nbsp;is&nbsp;done,&nbsp;runs&nbsp;very&nbsp;last</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>QUIT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;async&nbsp;exceptions&nbsp;within&nbsp;a&nbsp;whenever-block,&nbsp;runs&nbsp;very&nbsp;last</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;</span></span></div><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>COMPOSE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;when&nbsp;a&nbsp;role&nbsp;is&nbsp;composed&nbsp;into&nbsp;a&nbsp;class&nbsp;(Not&nbsp;yet&nbsp;implemented)</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>CLOSE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;appears&nbsp;in&nbsp;a&nbsp;supply&nbsp;block,&nbsp;called&nbsp;when&nbsp;the&nbsp;supply&nbsp;is&nbsp;closed</span><span>&nbsp;</span></span></span></div></pre><p>Phasers marked with a <code>*</code> have a runtime value, and if evaluated earlier than their surrounding expression, they simply save their result for use in the expression later when the rest of the expression is evaluated:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>compiletime</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>now</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>our</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>random</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>ENTER</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div></pre><p>As with other statement prefixes, these value-producing constructs may be placed in front of either a block or a statement:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>compiletime</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>now</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>our</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>random</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>ENTER</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;</span></span></div></pre><p>Most of these phasers will take either a block or a function reference. The statement form can be particularly useful to expose a lexically scoped declaration to the surrounding lexical scope without &quot;trapping&quot; it inside a block.</p>
<p>These declare the same variables with the same scope as the preceding example, but run the statements as a whole at the indicated time:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>compiletime</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>now</span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>ENTER</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>our</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>random</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;</span></span></div></pre><p>(Note, however, that the value of a variable calculated at compile time may not persist under runtime cloning of any surrounding closure.)</p>
<p>Most of the non-value-producing phasers may also be so used:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>END</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>accumulator</span></span></span><span>;</span></span></div></pre><p>Note, however, that</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="keyword control closure trait perl6fe"><span>END</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="storage modifier declarator perl6fe"><span>my</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>accumulator</span></span></span><span>&nbsp;</span><span class="storage modifier assignment perl6fe"><span>=</span></span><span>&nbsp;</span><span class="constant numeric perl6fe"><span>0</span></span><span>;</span></span></div></pre><p>sets the variable to 0 at <code>END</code> time, since that is when the &quot;my&quot; declaration is actually executed. Only argumentless phasers may use the statement form. This means that <code>CATCH</code> and <code>CONTROL</code> always require a block, since they take an argument that sets <code>$_</code> to the current topic, so that the innards are able to behave as a switch statement. (If bare statements were allowed, the temporary binding of <code>$_</code> would leak out past the end of the <code>CATCH</code> or <code>CONTROL</code>, with unpredictable and quite possibly dire consequences. Exception handlers are supposed to reduce uncertainty, not increase it.)</p>
<p><a name="index-entry-Phasers__will_trait"></a> Some of these phasers also have corresponding traits that can be set on variables; they use <code>will</code> followed by the name of the phaser in lowercase. These have the advantage of passing the variable in question into the closure as its topic:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage modifier declarator perl6fe"><span>our</span></span><span>&nbsp;</span><span class="meta variable container perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span class="variable other identifier perl6fe"><span>h</span></span></span><span>&nbsp;</span><span class="entity name type trait perl6fe"><span>will</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>enter</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>rememberit</span></span><span>()&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="entity name type trait perl6fe"><span>will</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>undo</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>forgetit</span></span><span>()&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>;</span></span></div></pre><p>Only phasers that can occur multiple times within a block are eligible for this per-variable form; this excludes <code>CATCH</code> and others like <code>CLOSE</code> or <code>QUIT</code>.</p>
<p>The topic of the block outside a phaser is still available as <code>OUTER::&lt;$_&gt; </code>. Whether the return value is modifiable may be a policy of the phaser in question. In particular, the return value should not be modified within a <code>POST</code> phaser, but a <code>LEAVE</code> phaser could be more liberal.</p>
<p>Any phaser defined in the lexical scope of a method is a closure that closes over <code>self</code> as well as normal lexicals. (Or equivalently, an implementation may simply turn all such phasers into submethods whose primed invocant is the current object.)</p>
<p>When multiple phasers are scheduled to run at the same moment, the general tiebreaking principle is that initializing phasers execute in order declared, while finalizing phasers execute in the opposite order, because setup and teardown usually want to happen in the opposite order from each other.</p>
<h2 id="Execution_order"><a class="u" href="#___top" title="go to top of document">Execution order</a></h2>
<p>Compilation begins</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;compile&nbsp;time,&nbsp;As&nbsp;soon&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CHECK</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;compile&nbsp;time,&nbsp;As&nbsp;late&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="routine name perl6fe"><span>COMPOSE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;when&nbsp;a&nbsp;role&nbsp;is&nbsp;composed&nbsp;into&nbsp;a&nbsp;class&nbsp;(Not&nbsp;yet&nbsp;implemented)</span><span>&nbsp;</span></span></span></div></pre><p>Execution begins</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>INIT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;runtime,&nbsp;as&nbsp;soon&nbsp;as&nbsp;possible,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div></pre><p>Before block execution begins</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>PRE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;assert&nbsp;precondition&nbsp;at&nbsp;every&nbsp;block&nbsp;entry,&nbsp;before&nbsp;ENTER</span><span>&nbsp;</span></span></span></div></pre><p>Loop execution begins</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>FIRST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;initialization&nbsp;time,&nbsp;before&nbsp;any&nbsp;ENTER</span><span>&nbsp;</span></span></span></div></pre><p>Block execution begins</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>ENTER</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;block&nbsp;entry&nbsp;time,&nbsp;repeats&nbsp;on&nbsp;loop&nbsp;blocks.</span><span>&nbsp;</span></span></span></div></pre><p>Exception maybe happens</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CATCH</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;exceptions,&nbsp;before&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CONTROL</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;control&nbsp;exceptions,&nbsp;before&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div></pre><p>End of loop, either continuing or finished</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>NEXT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;continuation&nbsp;time,&nbsp;before&nbsp;any&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LAST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;loop&nbsp;termination&nbsp;time,&nbsp;after&nbsp;any&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div></pre><p>End of block</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;when&nbsp;blocks&nbsp;exits,&nbsp;even&nbsp;stack&nbsp;unwinds&nbsp;from&nbsp;exceptions</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>KEEP</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;successful&nbsp;block&nbsp;exit,&nbsp;part&nbsp;of&nbsp;LEAVE&nbsp;queue</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>UNDO</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;every&nbsp;unsuccessful&nbsp;block&nbsp;exit,&nbsp;part&nbsp;of&nbsp;LEAVE&nbsp;queue</span><span>&nbsp;</span></span></span></div></pre><p>Postcondition for block</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>POST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;assert&nbsp;postcondition&nbsp;at&nbsp;every&nbsp;block&nbsp;exit,&nbsp;after&nbsp;LEAVE</span><span>&nbsp;</span></span></span></div></pre><p>Async whenever-block is complete</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LAST</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;if&nbsp;ended&nbsp;normally&nbsp;with&nbsp;done,&nbsp;runs&nbsp;once&nbsp;after&nbsp;block</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>QUIT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;catch&nbsp;async&nbsp;exceptions</span><span>&nbsp;</span></span></span></div></pre><p>Program terminating</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>END</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span class="keyword operator multi-symbol perl6fe"><span>...</span></span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;&nbsp;at&nbsp;runtime,&nbsp;ALAP,&nbsp;only&nbsp;ever&nbsp;runs&nbsp;once</span><span>&nbsp;</span></span></span></div></pre><h1 id="Program_execution_phasers"><a class="u" href="#___top" title="go to top of document">Program execution phasers</a></h1>
<h2 id="BEGIN"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__BEGIN-BEGIN"><span class="index-entry">BEGIN</span></a></a></h2>
<p>Runs at compile time, as soon as the code in the phaser has compiled, only runs once.</p>
<p>The return value is available for use in later phases:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>About&nbsp;to&nbsp;print&nbsp;3&nbsp;things</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control repeat perl6fe"><span>for</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>3</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>pick</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>-</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>~</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>BEGIN</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Generating&nbsp;BEGIN&nbsp;value</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword operator generic perl6fe"><span>^</span></span><span class="constant numeric perl6fe"><span>10</span></span><span>&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="support function perl6fe"><span>pick</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Generating&nbsp;BEGIN&nbsp;value</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;About&nbsp;to&nbsp;print&nbsp;3&nbsp;things</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;3-3</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;4-3</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;6-3</span></span></span></div></pre><p>The <code>^10 .pick</code> in the phaser is generated only once and is then re-used by the loop during runtime. Note how the <a href="/routine/say">say</a> in the <code>BEGIN</code> block is executed before the <a href="/routine/say">say</a> that is above the loop.</p>
<h2 id="CHECK"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__CHECK-CHECK"><span class="index-entry">CHECK</span></a></a></h2>
<p>Runs at compile time, as late as possible, only runs once.</p>
<p>Can have a return value that is provided even in later phases.</p>
<p>Code that is generated at runtime can still fire off <code>CHECK</code> and <code>INIT</code> phasers, though of course those phasers can&#39;t do things that would require travel back in time. You need a wormhole for that.</p>
<h2 id="INIT"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__INIT-INIT"><span class="index-entry">INIT</span></a></a></h2>
<p>Runs after compilation during main execution, as soon as possible, only runs once. It can have a return value that is provided even in later phases.</p>
<p>When phasers are in different modules, the <code>INIT</code> and <code>END</code> phasers are treated as if declared at <code>use</code> time in the using module. (It is erroneous to depend on this order if the module is used more than once, however, since the phasers are only installed the first time they&#39;re noticed.)</p>
<p>Code that is generated at runtime can still fire off <code>CHECK</code> and <code>INIT</code> phasers, though of course those phasers can&#39;t do things that would require travel back in time. You need a wormhole for that.</p>
<p>An <code>INIT</code> only runs once for all copies of a cloned closure.</p>
<h2 id="END"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__END-END"><span class="index-entry">END</span></a></a></h2>
<p>Runs after compilation during main execution, as late as possible, only runs once.</p>
<p>When phasers are in different modules, the <code>INIT</code> and <code>END</code> phasers are treated as if declared at <code>use</code> time in the using module. (It is erroneous to depend on this order if the module is used more than once, however, since the phasers are only installed the first time they&#39;re noticed.)</p>
<h1 id="Block_phasers"><a class="u" href="#___top" title="go to top of document">Block phasers</a></h1>
<p>Execution in the context of a block has its own phases.</p>
<p>Block-leaving phasers wait until the call stack is actually unwound to run. Unwinding happens only after some exception handler decides to handle the exception that way. That is, just because an exception is thrown past a stack frame does not mean we have officially left the block yet, since the exception might be resumable. In any case, exception handlers are specified to run within the dynamic scope of the failing code, whether or not the exception is resumable. The stack is unwound and the phasers are called only if an exception is not resumed.</p>
<p>These can occur multiple times within the block. So they aren&#39;t really traits, exactly--they add themselves onto a list stored in the actual trait. If you examine the <code>ENTER</code> trait of a block, you&#39;ll find that it&#39;s really a list of phasers rather than a single phaser.</p>
<p>All of these phaser blocks can see any previously declared lexical variables, even if those variables have not been elaborated yet when the closure is invoked (in which case the variables evaluate to an undefined value.)</p>
<h2 id="ENTER"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__ENTER-ENTER"><span class="index-entry">ENTER</span></a></a></h2>
<p>Runs at every block entry time, repeats on loop blocks.</p>
<p>Can have a return value that is provided even in later phases.</p>
<p>An exception thrown from an <code>ENTER</code> phaser will abort the <code>ENTER</code> queue, but one thrown from a <code>LEAVE</code> phaser will not.</p>
<h2 id="LEAVE"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__LEAVE-LEAVE"><span class="index-entry">LEAVE</span></a></a></h2>
<p>Runs at every block exit time (even stack unwinds from exceptions), except when the program exits abruptly (e.g. with <a href="/routine/exit"><code>exit</code></a>).</p>
<p><code>LEAVE</code> phasers for a given block are necessarily evaluated after any <code>CATCH</code> and <code>CONTROL</code> phasers. This includes the <code>LEAVE</code> variants, <code>KEEP</code> and <code>UNDO</code>. <code>POST</code> phasers are evaluated after everything else, to guarantee that even <code>LEAVE</code> phasers can&#39;t violate postconditions.</p>
<p>An exception thrown from an <code>ENTER</code> phaser will abort the <code>ENTER</code> queue, but one thrown from a <code>LEAVE</code> phaser will not.</p>
<p>If a <code>POST</code> fails or any kind of <code>LEAVE</code> block throws an exception while the stack is unwinding, the unwinding continues and collects exceptions to be handled. When the unwinding is completed all new exceptions are thrown from that point.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>answer</span></span><span>()&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted left_double-low-q_right_double perl6fe"><span class="punctuation definition string begin perl6fe"><span>„</span></span><span>I&nbsp;say&nbsp;after&nbsp;the&nbsp;return&nbsp;value.</span><span class="punctuation definition string end perl6fe"><span>“</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="constant numeric perl6fe"><span>42</span></span><span>&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;this&nbsp;is&nbsp;the&nbsp;return&nbsp;value</span><span>&nbsp;</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div></pre><p><strong>Note:</strong> be mindful of <code>LEAVE</code> phasers directly in blocks of routines, as they will get executed even when an attempt to call the routine with wrong arguments is made:</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="storage type declarator type perl6fe"><span>sub</span></span><span>&nbsp;</span><span class="entity name function perl6fe"><span>foo</span></span><span>&nbsp;(</span><span class="support type perl6fe"><span>Int</span></span><span>)&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Hello!</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>LEAVE</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>oh&nbsp;noes!</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="keyword control control-handlers perl6fe"><span>try</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>foo</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>rand</span></span><span>;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:&nbsp;«oh&nbsp;noes!␤»</span></span></span></div></pre><p>Although the subroutine&#39;s body did not get run, because the sub expects an <a href="/type/Int">Int</a> and <a href="/routine/rand"><code>rand</code></a> returned a <a href="/type/Num">Num</a>, its block was entered and left (when param binding failed), and so the <code>LEAVE</code> phaser <em>was</em> run.</p>
<h2 id="KEEP"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__KEEP-KEEP"><span class="index-entry">KEEP</span></a></a></h2>
<p>Runs at every successful block exit, as part of the LEAVE queue (shares the same order of execution).</p>
<h2 id="UNDO"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__UNDO-UNDO"><span class="index-entry">UNDO</span></a></a></h2>
<p>Runs at every unsuccessful block exit, as part of the LEAVE queue (shares the same order of execution).</p>
<h2 id="PRE"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__PRE-PRE"><span class="index-entry">PRE</span></a></a></h2>
<p>Asserts a precondition at every block entry. Runs before the ENTER phase.</p>
<p><code>PRE</code> phasers fire off before any <code>ENTER</code> or <code>FIRST</code>.</p>
<p>The exceptions thrown by failing <code>PRE</code> and <code>POST</code> phasers cannot be caught by a <code>CATCH</code> in the same block, which implies that <code>POST</code> phaser are not run if a <code>PRE</code> phaser fails.</p>
<h2 id="POST"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__POST-POST"><span class="index-entry">POST</span></a></a></h2>
<p>Asserts a postcondition at every block entry. Runs after the LEAVE phase.</p>
<p>For phasers such as <code>KEEP</code> and <code>POST</code> that are run when exiting a scope normally, the return value (if any) from that scope is available as the current topic within the phaser.</p>
<p>The <code>POST</code> block can be defined in one of two ways. Either the corresponding <code>POST</code> is defined as a separate phaser, in which case <code>PRE</code> and <code>POST</code> share no lexical scope. Alternately, any <code>PRE</code> phaser may define its corresponding <code>POST</code> as an embedded phaser block that closes over the lexical scope of the <code>PRE</code>.</p>
<p>If a <code>POST</code> fails or any kind of <code>LEAVE</code> block throws an exception while the stack is unwinding, the unwinding continues and collects exceptions to be handled. When the unwinding is completed all new exceptions are thrown from that point.</p>
<p>The exceptions thrown by failing <code>PRE</code> and <code>POST</code> phasers cannot be caught by a <code>CATCH</code> in the same block, which implies that <code>POST</code> phaser are not run if a <code>PRE</code> phaser fails.</p>
<h1 id="Loop_phasers"><a class="u" href="#___top" title="go to top of document">Loop phasers</a></h1>
<p><code>FIRST</code>, <code>NEXT</code>, and <code>LAST</code> are meaningful only within the lexical scope of a loop, and may occur only at the top level of such a loop block.</p>
<h2 id="FIRST"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__FIRST-FIRST"><span class="index-entry">FIRST</span></a></a></h2>
<p>Runs at loop initialization, before ENTER.</p>
<h2 id="NEXT"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__NEXT-NEXT"><span class="index-entry">NEXT</span></a></a></h2>
<p>Runs when loop is continued (either through <code>next</code> or because you got to the bottom of the loop and are looping back around), before LEAVE.</p>
<p>A <code>NEXT</code> executes only if the end of the loop block is reached normally, or an explicit <code>next</code> is executed. In distinction to <code>LEAVE</code> phasers, a <code>NEXT</code> phaser is not executed if the loop block is exited via any exception other than the control exception thrown by <code>next</code>. In particular, a <code>last</code> bypasses evaluation of <code>NEXT</code> phasers.</p>
<h2 id="LAST"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__LAST-LAST"><span class="index-entry">LAST</span></a></a></h2>
<p>Runs when a loop is finished because the condition is met, or when it exits using <code>last</code> or <code>return</code>; it is executed after <code>LEAVE</code>.</p>
<h1 id="Exception_handling_phasers"><a class="u" href="#___top" title="go to top of document">Exception handling phasers</a></h1>
<h2 id="CATCH"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__CATCH-CATCH"><span class="index-entry">CATCH</span></a></a></h2>
<p>Runs when an exception is raised by the current block, before the LEAVE phase.</p>
<h2 id="CONTROL"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__CONTROL-CONTROL"><span class="index-entry">CONTROL</span></a></a></h2>
<p>Runs when a control exception is raised by the current block, before the LEAVE phase. It is raised by <code>return</code>, <code>fail</code>, <code>redo</code>, <code>next</code>, <code>last</code>, <code>done</code>, <code>emit</code>, <code>take</code>, <code>warn</code>, <code>proceed</code> and <code>succeed</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>elems</span></span><span>&nbsp;</span><span class="keyword control repeat perl6fe"><span>gather</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control closure trait perl6fe"><span>CONTROL</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>when</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>CX</span></span><span>::</span><span class="routine name perl6fe"><span>Warn</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>WARNING!!!&nbsp;</span><span class="variable other identifier interpolated perl6fe"><span class="variable other identifier sigil perl6fe"><span>$</span></span><span>_</span></span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>resume</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>when</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>CX</span></span><span>::</span><span class="routine name perl6fe"><span>Take</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Don&#39;t&nbsp;take&nbsp;my&nbsp;stuff</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>resume</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>when</span></span><span>&nbsp;</span><span class="routine name perl6fe"><span>CX</span></span><span>::</span><span class="routine name perl6fe"><span>Done</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted double perl6fe"><span class="punctuation definition string begin perl6fe"><span>&quot;</span></span><span>Done</span><span class="punctuation definition string end perl6fe"><span>&quot;</span></span></span><span>;&nbsp;</span><span class="keyword operator generic perl6fe"><span>.</span></span><span class="routine name perl6fe"><span>resume</span></span><span>&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control control-handlers perl6fe"><span>warn</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>people&nbsp;take&nbsp;stuff&nbsp;here</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="keyword control flowcontrol perl6fe"><span>take</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>keys</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="support function perl6fe"><span>done</span></span><span>;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>}</span></span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;OUTPUT:</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;WARNING!!!&nbsp;people&nbsp;take&nbsp;stuff&nbsp;here</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Don&#39;t&nbsp;take&nbsp;my&nbsp;stuff</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;Done</span><span>&nbsp;</span></span></span></div><div class="line"><span class="source perl6fe"><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;0</span></span></span></div></pre><h1 id="Object_phasers"><a class="u" href="#___top" title="go to top of document">Object phasers</a></h1>
<h2 id="COMPOSE_(Not_yet_implemented)"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Phasers__COMPOSE-COMPOSE"><span class="index-entry">COMPOSE</span></a> (Not yet implemented)</a></h2>
<p>Runs when a role is composed into a class.</p>
<h1 id="Asynchronous_phasers"><a class="u" href="#___top" title="go to top of document">Asynchronous phasers</a></h1>
<h2 id="LAST"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Asynchronous_Phasers__LAST-LAST"><span class="index-entry">LAST</span></a></a></h2>
<p>Runs when a <a href="/type/Supply">Supply</a> finishes with a call to <code>done</code> or when a <code>supply</code> block exits normally. It runs completely after the <code>whenever</code> block it is placed within finishes.</p>
<p>This phaser reuses the name <code>LAST</code>, but works differently from the <code>LAST</code> loop phaser. This phaser is similar to setting the <code>done</code> routine while tapping a supply with <code>tap</code>.</p>
<h2 id="QUIT"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Asynchronous_Phasers__QUIT-QUIT"><span class="index-entry">QUIT</span></a></a></h2>
<p>Runs when a <a href="/type/Supply">Supply</a> terminates early with an exception. It runs after the <code>whenever</code> block it is placed within finishes.</p>
<p>This phaser is similar to setting the <code>quit</code> routine while tapping a Supply with <code>tap</code>.</p>
<h2 id="CLOSE"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Asynchronous_Phasers__CLOSE-CLOSE"><span class="index-entry">CLOSE</span></a></a></h2>
<p>Appears in a supply block. Called when the supply is closed.</p>
<h1 id="DOC_phasers"><a class="u" href="#___top" title="go to top of document">DOC phasers</a></h1>
<h2 id="DOC"><a class="u" href="#___top" title="go to top of document"><a name="index-entry-Asynchronous_Phasers__DOC-DOC"><span class="index-entry">DOC</span></a></a></h2>
<p>The phasers <code>BEGIN</code>, <code>CHECK</code> and <code>INIT</code> are run only in documentation mode when prefixed with the <code>DOC</code> keyword. The compiler is in documentation mode when run with <code>--doc</code>.</p>
<pre class="editor editor-colors"><div class="line"><span class="source perl6fe"><span class="routine name perl6fe"><span>DOC</span></span><span>&nbsp;</span><span class="keyword control closure trait perl6fe"><span>INIT</span></span><span>&nbsp;</span><span class="meta block perl6fe"><span class="punctuation definition block perl6fe"><span>{</span></span><span>&nbsp;</span><span class="support function perl6fe"><span>say</span></span><span>&nbsp;</span><span class="string quoted single single perl6fe"><span class="punctuation definition string begin perl6fe"><span>&#39;</span></span><span>init</span><span class="punctuation definition string end perl6fe"><span>&#39;</span></span></span><span>&nbsp;&nbsp;</span><span class="punctuation definition block perl6fe"><span>}</span></span></span><span>&nbsp;&nbsp;</span><span class="comment line number-sign perl6fe"><span class="punctuation definition comment perl6fe"><span>#</span></span><span>&nbsp;prints&nbsp;&#39;init&#39;&nbsp;at&nbsp;initialization&nbsp;time&nbsp;when&nbsp;in&nbsp;documentation&nbsp;mode.</span></span></span></div></pre>
    </div>
    
    </div>
<footer class="pretty-box yellow">

  <p>This is the deprecated documentation of the Perl 6 language, currently
      known as Raku. Please use
      <a href="https://docs.raku.org"><code>docs.raku.org</code></a> from now on.</p>

  <p>This page has been superseded by <a href="https://docs.raku.org//language/phasers">/language/phasers</a>.</p>

  <p> This documentation is provided under the terms of the
      <a href="https://raw.githubusercontent.com/perl6/doc/master/LICENSE">Artistic License 2.0</a>.
      The Camelia image is <a href="https://raw.githubusercontent.com/perl6/mu/master/misc/camelia.txt"
        >copyright © 2009 by Larry Wall.</a>
      <!-- CREDITS -->
      <!--External Link Image by Zapyon, CCA-SA 4.0. Derived from Wikimedia Foundation https://commons.wikimedia.org/wiki/File:External-link-04-bold-12x12.svg -->

  </p>
</footer>

<script type="text/javascript" src="/js/app.js?v=1"></script>
<script type="text/javascript" src="/js/search.js?v=3"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if (!location.hash || location.hash === "#___top") {
      $('query').focus();
    }
  });
</script>

    </body>
</html>
